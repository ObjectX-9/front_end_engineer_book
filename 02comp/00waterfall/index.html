<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://s21.ax1x.com/2024/06/14/pkdLxmt.png"
    />
    <link rel="stylesheet" href="/front_end_engineer_book/umi.4c36f7fa.css" />
    <script>
      window.routerBase = "/front_end_engineer_book/";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>瀑布流的几种实现方式</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/02comp/00waterfall" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false" data-use-bg="false" style="padding-bottom:50px;overflow:unset;background-size:cover"><div class="__dumi-default-navbar" data-mode="site" data-is-home="false" style="background-color:#212121"><button class="__dumi-default-navbar-toggle"></button><div class="logo_wrapper"><a class="__dumi-default-navbar-logo" href="/front_end_engineer_book//"><img src="https://s21.ax1x.com/2024/06/14/pkdLxmt.png" alt="ObjectX前端工程化实践"/><span class="label">ObjectX前端工程化实践</span></a><div class="search_wrapper"><div class="__dumi-default-search" data-is-home="false"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="1.0" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="主页-登录页" transform="translate(-337.000000, -20.000000)"><g id="顶部导航" transform="translate(28.000000, 0.000000)"><g id="编组-3" transform="translate(309.000000, 20.000000)"><rect id="矩形" opacity="0.0848214286" x="0" y="0" width="24" height="24"></rect><path d="M7.63246763,7.63246763 C9.80909114,5.45584412 13.3380951,5.45584412 15.5147186,7.63246763 C17.5003311,9.61808009 17.6745798,12.7291297 16.0374649,14.9122691 L17.7667903,16.6407545 C18.0777366,16.9517007 18.0777366,17.4558441 17.7667903,17.7667903 C17.4558441,18.0777366 16.9517007,18.0777366 16.6407545,17.7667903 L14.9122691,16.0374649 C12.7291297,17.6745798 9.61808009,17.5003311 7.63246763,15.5147186 C5.45584412,13.3380951 5.45584412,9.80909114 7.63246763,7.63246763 Z M14.3886828,8.75850349 C12.8339517,7.20377241 10.3132346,7.20377241 8.75850349,8.75850349 C7.20377241,10.3132346 7.20377241,12.8339517 8.75850349,14.3886828 C10.3132346,15.9434138 12.8339517,15.9434138 14.3886828,14.3886828 C15.9434138,12.8339517 15.9434138,10.3132346 14.3886828,8.75850349 Z" id="形状结合" fill="#666666" fill-rule="nonzero"></path></g></g></g></g></svg><input type="search" class="__dumi-default-search-input" placeholder="search document..." value=""/><ul></ul></div></div></div><span><nav class="navbar_links"><span class="navbar_links-item"><a href="/front_end_engineer_book//01docs">🚀 工程化实践指南</a></span><span class="navbar_links-item"><a aria-current="page" class="active" href="/front_end_engineer_book//02comp">📚 常见组件实现</a></span><span class="navbar_links-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ObjectX-9/front_end_engineer_book">⭐️GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></span></div><ul role="slug-list" class="__dumi-default-layout-toc"><li role="slug-list-title">瀑布流的几种实现方式</li><li title="瀑布流的几种实现方式" data-depth="1"><a href="#瀑布流的几种实现方式" class="active"><span>瀑布流的几种实现方式</span></a></li><li title="🥑 实现效果&amp;代码" data-depth="1"><a href="#🥑-实现效果代码" class=""><span>🥑 实现效果&amp;代码</span></a></li><li title="🍐 一、storybook使用" data-depth="1"><a href="#-一、storybook使用" class=""><span>🍐 一、storybook使用</span></a></li><li title="🍑 二、瀑布流" data-depth="1"><a href="#-二、瀑布流" class=""><span>🍑 二、瀑布流</span></a></li><li title="1.瀑布流是个什么东西？" data-depth="2"><a href="#1瀑布流是个什么东西？" class=""><span>1.瀑布流是个什么东西？</span></a></li><li title="2.特点" data-depth="2"><a href="#2特点" class=""><span>2.特点</span></a></li><li title="2.优缺点" data-depth="2"><a href="#2优缺点" class=""><span>2.优缺点</span></a></li><li title="优点：" data-depth="3"><a href="#优点：" class=""><span>优点：</span></a></li><li title="缺点：" data-depth="3"><a href="#缺点：" class=""><span>缺点：</span></a></li><li title="3.适用于哪些场景" data-depth="2"><a href="#3适用于哪些场景" class=""><span>3.适用于哪些场景</span></a></li><li title="🍉 三、unsplash请求图片" data-depth="1"><a href="#-三、unsplash请求图片" class=""><span>🍉 三、unsplash请求图片</span></a></li><li title="🥝 四、其他几种瀑布流的实现方式" data-depth="1"><a href="#🥝-四、其他几种瀑布流的实现方式" class=""><span>🥝 四、其他几种瀑布流的实现方式</span></a></li><li title="1.column属性实现" data-depth="2"><a href="#1column属性实现" class=""><span>1.column属性实现</span></a></li><li title="效果" data-depth="3"><a href="#效果" class=""><span>效果</span></a></li><li title="原理" data-depth="3"><a href="#原理" class=""><span>原理</span></a></li><li title="代码" data-depth="3"><a href="#代码" class=""><span>代码</span></a></li><li title="优缺点" data-depth="3"><a href="#优缺点" class=""><span>优缺点</span></a></li><li title="2.flex瀑布流实现方式" data-depth="2"><a href="#2flex瀑布流实现方式" class=""><span>2.flex瀑布流实现方式</span></a></li><li title="效果" data-depth="3"><a href="#效果-1" class=""><span>效果</span></a></li><li title="原理" data-depth="3"><a href="#原理-1" class=""><span>原理</span></a></li><li title="代码" data-depth="3"><a href="#代码-1" class=""><span>代码</span></a></li><li title="优缺点" data-depth="3"><a href="#优缺点-1" class=""><span>优缺点</span></a></li><li title="3.grid瀑布流实现方式" data-depth="2"><a href="#3grid瀑布流实现方式" class=""><span>3.grid瀑布流实现方式</span></a></li><li title="效果" data-depth="3"><a href="#效果-2" class=""><span>效果</span></a></li><li title="原理" data-depth="3"><a href="#原理-2" class=""><span>原理</span></a></li><li title="代码" data-depth="3"><a href="#代码-2" class=""><span>代码</span></a></li><li title="优缺点" data-depth="3"><a href="#优缺点-2" class=""><span>优缺点</span></a></li><li title="4.原生js封装实现" data-depth="2"><a href="#4原生js封装实现" class=""><span>4.原生js封装实现</span></a></li><li title="效果" data-depth="3"><a href="#效果-3" class=""><span>效果</span></a></li><li title="原理" data-depth="3"><a href="#原理-3" class=""><span>原理</span></a></li><li title="代码" data-depth="3"><a href="#代码-3" class=""><span>代码</span></a></li><li title="优缺点" data-depth="3"><a href="#优缺点-3" class=""><span>优缺点</span></a></li><li title="🍒 五、第三方库实现" data-depth="1"><a href="#-五、第三方库实现" class=""><span>🍒 五、第三方库实现</span></a></li><li title="react-photo-gallery" data-depth="2"><a href="#react-photo-gallery" class=""><span>react-photo-gallery</span></a></li><li title="react-masonry-css" data-depth="2"><a href="#react-masonry-css" class=""><span>react-masonry-css</span></a></li><li title="react-stack-grid" data-depth="2"><a href="#react-stack-grid" class=""><span>react-stack-grid</span></a></li><li title="react-stonecutter" data-depth="2"><a href="#react-stonecutter" class=""><span>react-stonecutter</span></a></li><li title="🍎 推荐阅读" data-depth="1"><a href="#-推荐阅读" class=""><span>🍎 推荐阅读</span></a></li><li title="工程化" data-depth="2"><a href="#工程化" class=""><span>工程化</span></a></li><li title="常见组件实现" data-depth="2"><a href="#常见组件实现" class=""><span>常见组件实现</span></a></li><li title="面试手写系列" data-depth="2"><a href="#面试手写系列" class=""><span>面试手写系列</span></a></li><li title="react实现原理系列" data-depth="2"><a href="#react实现原理系列" class=""><span>react实现原理系列</span></a></li><li title="其他" data-depth="2"><a href="#其他" class=""><span>其他</span></a></li><li title="🍋 写在最后" data-depth="1"><a href="#-写在最后" class=""><span>🍋 写在最后</span></a></li></ul><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://s21.ax1x.com/2024/06/14/pkdLxmt.png&#x27;)" href="/front_end_engineer_book//"></a><h1>ObjectX前端工程化实践</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/front_end_engineer_book//01docs">🚀 工程化实践指南</a></li><li><a aria-current="page" class="active" href="/front_end_engineer_book//02comp">📚 常见组件实现</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/ObjectX-9/front_end_engineer_book">⭐️GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><ul class="ant-menu ant-menu-root ant-menu-inline ant-menu-light" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">1.瀑布流</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-selected ant-menu-item-only-child"><span class="ant-menu-title-content"><a aria-current="page" class="active" href="/front_end_engineer_book//02comp/00waterfall"><span>瀑布流的几种实现方式</span></a></span></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">2.虚拟列表</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/front_end_engineer_book//02comp/01virtual-list"><span>虚拟列表的几种实现方式</span></a></span></li></ul></li></ul><div style="display:none" aria-hidden="true"></div></ul></div></div><div class="__dumi-default-layout-content"><div class="__dumi-default-mobile-content"><article><div class="__dumi-default-content-header markdown no-desc"><h1>瀑布流的几种实现方式</h1></div><div class="markdown"><h1 id="瀑布流的几种实现方式"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#瀑布流的几种实现方式"><span class="icon icon-link"></span></a>瀑布流的几种实现方式</h1><h1 id="🥑-实现效果代码"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#🥑-实现效果代码"><span class="icon icon-link"></span></a>🥑 实现效果&amp;代码</h1><p><a target="_blank" rel="noopener noreferrer" href="https://objectx-9.github.io/react_demo/?path=/docs/%E9%80%9A%E7%94%A8-button--docs">在线demo体验<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><img src="https://cdn.jsdelivr.net/gh/ObjectX-9/DrawingBed/imgMac/%E7%80%91%E5%B8%83%E6%B5%81.gif" alt="2024-05-18 14.25.56.gif"/></p><h1 id="-一、storybook使用"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-一、storybook使用"><span class="icon icon-link"></span></a>🍐 一、storybook使用</h1><p>安装和配置过程我们<a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7355026320088989733">之前<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>已经搞定了，现在我们介绍如何书写。</p><p><code>Storybook</code> 把同一个组件传入不同 <code>props</code> 的情况，叫做一个 <code>Story</code>，它会变成左侧的目录，通过目录可以访问到不同<code>props</code>下的组件的样式</p><p>一个组件包含多个 <code>Story</code>，一个文档里又包含多个组件，和一本书的目录差不多。 所以把这个工具叫做 <code>Storybook</code> ---神光</p><p><img src="/front_end_engineer_book/static/image-20240615142410332.3c4d3ad2.png" alt="image-20240615142410332"/></p><p><img src="/front_end_engineer_book/static/image-20240615142516312.8a4a3c3b.png" alt="image-20240615142516312"/></p><p>组件参数文档生成，注意注释一定要用多行注释的类型，<code>props</code>接口的定义为<code>组件名+Props</code></p><p><img src="/front_end_engineer_book/static/image-20240615142523538.f9ba99fe.png" alt="image-20240615142523538"/></p><p><img src="/front_end_engineer_book/static/image-20240615142529354.4b289d75.png" alt="image-20240615142529354"/></p><h1 id="-二、瀑布流"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-二、瀑布流"><span class="icon icon-link"></span></a>🍑 二、瀑布流</h1><h2 id="1瀑布流是个什么东西？"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#1瀑布流是个什么东西？"><span class="icon icon-link"></span></a>1.瀑布流是个什么东西？</h2><p>瀑布流布局（<code>Masonry Layout</code>），又称为砌石布局，是一种常用于网页设计中的布局方式。它通过模仿砌墙的方式，将元素（如图片、卡片或其他内容单元）按照不规则的列排布在页面上，每个元素的<strong>高度</strong>可以不同，但<strong>宽度</strong>通常保持一致，常见于图片分享网站、社交媒体平台和电子商务网站等，<a target="_blank" rel="noopener noreferrer" href="https://www.pinterest.com/">Pinterest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是一个典型使用瀑布流布局的网站例子。这种布局方式强调内容的视觉吸引力，并通过不规则排列增加页面的趣味性和探索性。</p><p><img src="/front_end_engineer_book/static/image-20240615142538680.feaf476d.png" alt="image-20240615142538680"/></p><h2 id="2特点"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#2特点"><span class="icon icon-link"></span></a>2.特点</h2><p>瀑布流布局的特点是：</p><ul><li><strong>紧凑排列</strong>：元素之间尽可能减少空隙，就像瀑布流水覆盖岩石一样连续且自然地流淌下来。</li><li><strong>不规则的网格</strong>：与传统的网格布局相比，瀑布流布局中的单元块高度不一，创造视觉上的多样性和动态感。</li><li><strong>响应式设计</strong>：在不同屏幕尺寸或者设备上，瀑布流布局可以通过调整列数来达到最佳浏览效果。</li></ul><p>前端开发中实现瀑布流的方法通常有以下几种：</p><ul><li><strong>CSS3的列属性</strong>(<code>column-count</code>, <code>column-gap</code>, <code>column-fill</code>等)可以实现简单的瀑布流布局。</li><li><strong>JavaScript库</strong>，比如Masonry、Isotope或者Salvattore等，可以提供更为复杂和灵活的瀑布流布局解决方案。</li><li><strong>Flexbox</strong>和<strong>Grid Layout</strong>也可以用来实现类似瀑布流的布局，虽然可能需要一些额外的计算和排列逻辑。</li></ul><h2 id="2优缺点"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#2优缺点"><span class="icon icon-link"></span></a>2.优缺点</h2><h3 id="优点："><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#优点："><span class="icon icon-link"></span></a>优点：</h3><ol><li><strong>视觉吸引力</strong>：瀑布流布局提供了一种视觉上吸引人的内容展示方式，特别是对于图片和视频等媒体内容，可以有效地吸引用户的注意力。</li><li><strong>优化空间利用</strong>：因为元素之间几乎没有空白，瀑布流布局最大限度地利用了屏幕的空间，展示更多的内容给用户。</li><li><strong>响应式设计</strong>：它可以根据不同屏幕尺寸自动调整列数和元素大小，提供良好的跨设备体验。</li><li><strong>探索性</strong>：不规则的布局增强了页面的探索性，能够鼓励用户滚动浏览更多的内容。</li><li><strong>内容优先</strong>：瀑布流布局强调内容的展示，使得用户能够快速浏览并发现他们感兴趣的项目。</li></ol><h3 id="缺点："><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#缺点："><span class="icon icon-link"></span></a>缺点：</h3><ol><li><strong>导航困难</strong>：由于内容是不规则排列的，用户可能很难找到他们之前看过的特定项目。</li><li><strong>加载性能</strong>：页面在加载时可能会遇到性能问题，因为瀑布流布局涉及到大量的内容重排，在滚动浏览时可能出现卡顿。</li><li><strong>复杂的实现</strong>：正确实现瀑布流布局可能比简单的网格布局更复杂，尤其是当处理大量动态内容时。</li><li><strong>SEO 不友好</strong>：如果内容是异步加载的，爬虫可能无法有效地索引页面上的所有内容。</li><li><strong>滚动无尽</strong>：如果没有合适的加载更多内容的机制，用户可能会感到不断的滚动而难以到达页面底部，影响用户体验。</li></ol><h2 id="3适用于哪些场景"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#3适用于哪些场景"><span class="icon icon-link"></span></a>3.适用于哪些场景</h2><p>适用于大量图片展示的场景，图片展示网站、社交媒体平台、个人或商业博客等等</p><h1 id="-三、unsplash请求图片"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-三、unsplash请求图片"><span class="icon icon-link"></span></a>🍉 三、<code>unsplash</code>请求图片</h1><p>请求图片，<code>unsplash</code>请求任意图片，但是接口有请求限制，我这里直接用请求过的数据，<code>unsplash</code>图片加载很慢，能更大程度上暴露瀑布流可能遇到的问题。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic" data-188-js-token="/**-0-0">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * 请求任意张图片</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @returns</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain" data-188-js-token="-3-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-4-0"></span><span class="token keyword module" style="color:#00009f" data-188-js-token="export-4-0">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-188-js-token="const-4-7">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-188-js-token="fetchRandomImage-4-13">fetchRandomImage</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-188-js-token="=-4-30">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-188-js-token="async-4-32">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="(-4-38">(</span><span class="token parameter" data-188-js-token="imgNums-4-39">imgNums</span><span class="token parameter operator" style="color:#393A34" data-188-js-token=":-4-46">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34" data-188-js-token=")-4-54">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-188-js-token="=&gt;-4-56">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="{-4-59">{</span><span class="token plain" data-188-js-token="-4-60"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-5-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// return IMG_DATA;</span><span class="token plain" data-188-js-token="-5-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-6-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// eslint-disable-next-line no-unreachable</span><span class="token plain" data-188-js-token="-6-43"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-7-0">	</span><span class="token keyword control-flow" style="color:#00009f" data-188-js-token="try-7-1">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="{-7-5">{</span><span class="token plain" data-188-js-token="-7-6"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-8-0">		</span><span class="token keyword" style="color:#00009f" data-188-js-token="const-8-2">const</span><span class="token plain"> res</span><span class="token operator" style="color:#393A34" data-188-js-token=":-8-11">:</span><span class="token plain"> </span><span class="token maybe-class-name" data-188-js-token="I_ImgRes-8-13">I_ImgRes</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-188-js-token="=-8-22">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-188-js-token="await-8-24">await</span><span class="token plain"> axios</span><span class="token punctuation" style="color:#393A34" data-188-js-token=".-8-35">.</span><span class="token method function property-access" style="color:#d73a49" data-188-js-token="get-8-36">get</span><span class="token punctuation" style="color:#393A34" data-188-js-token="(-8-39">(</span><span class="token plain" data-188-js-token="-8-40"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-9-0">			</span><span class="token string" style="color:#e3116c" data-188-js-token="&#x27;https://api.unsplash.com/photos/random&#x27;-9-3">&#x27;https://api.unsplash.com/photos/random&#x27;</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-9-43">,</span><span class="token plain" data-188-js-token="-9-44"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-10-0">			</span><span class="token punctuation" style="color:#393A34" data-188-js-token="{-10-3">{</span><span class="token plain" data-188-js-token="-10-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="params-11-0">				params</span><span class="token operator" style="color:#393A34" data-188-js-token=":-11-10">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="{-11-12">{</span><span class="token plain" data-188-js-token="-11-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="client_id-12-0">					client_id</span><span class="token operator" style="color:#393A34" data-188-js-token=":-12-14">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa" data-188-js-token="UNSPLASH_ACCESS_KEY-12-16">UNSPLASH_ACCESS_KEY</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-12-35">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 替换为你的Access Key</span><span class="token plain" data-188-js-token="-12-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="count-13-0">					count</span><span class="token operator" style="color:#393A34" data-188-js-token=":-13-10">:</span><span class="token plain"> imgNums</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-13-19">,</span><span class="token plain" data-188-js-token="-13-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-14-0">				</span><span class="token punctuation" style="color:#393A34" data-188-js-token="}-14-4">}</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-14-5">,</span><span class="token plain" data-188-js-token="-14-6"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-15-0">			</span><span class="token punctuation" style="color:#393A34" data-188-js-token="}-15-3">}</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-15-4">,</span><span class="token plain" data-188-js-token="-15-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-16-0">		</span><span class="token punctuation" style="color:#393A34" data-188-js-token=")-16-2">)</span><span class="token punctuation" style="color:#393A34" data-188-js-token=";-16-3">;</span><span class="token plain" data-188-js-token="-16-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-17-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-188-js-token="return-17-2">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34" data-188-js-token=".-17-12">.</span><span class="token property-access" data-188-js-token="data-17-13">data</span><span class="token punctuation" style="color:#393A34" data-188-js-token=".-17-17">.</span><span class="token property-access" data-188-js-token="length-17-18">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-188-js-token="!==-17-25">!==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-188-js-token="0-17-29">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-188-js-token="?-17-31">?</span><span class="token plain"> res</span><span class="token operator" style="color:#393A34" data-188-js-token="?.-17-36">?.</span><span class="token plain">data </span><span class="token operator" style="color:#393A34" data-188-js-token=":-17-43">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="[-17-45">[</span><span class="token punctuation" style="color:#393A34" data-188-js-token="]-17-46">]</span><span class="token punctuation" style="color:#393A34" data-188-js-token=";-17-47">;</span><span class="token plain" data-188-js-token="-17-48"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-18-0">	</span><span class="token punctuation" style="color:#393A34" data-188-js-token="}-18-1">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-188-js-token="catch-18-3">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="(-18-9">(</span><span class="token plain" data-188-js-token="error-18-10">error</span><span class="token punctuation" style="color:#393A34" data-188-js-token=")-18-15">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-188-js-token="{-18-17">{</span><span class="token plain" data-188-js-token="-18-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-19-0">		</span><span class="token console class-name" data-188-js-token="console-19-2">console</span><span class="token punctuation" style="color:#393A34" data-188-js-token=".-19-9">.</span><span class="token method function property-access" style="color:#d73a49" data-188-js-token="error-19-10">error</span><span class="token punctuation" style="color:#393A34" data-188-js-token="(-19-15">(</span><span class="token string" style="color:#e3116c">&#x27;Error fetching image from Unsplash:&#x27;</span><span class="token punctuation" style="color:#393A34" data-188-js-token=",-19-53">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34" data-188-js-token=")-19-60">)</span><span class="token punctuation" style="color:#393A34" data-188-js-token=";-19-61">;</span><span class="token plain" data-188-js-token="-19-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-20-0">	</span><span class="token punctuation" style="color:#393A34" data-188-js-token="}-20-1">}</span><span class="token plain" data-188-js-token="-20-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-188-js-token="-21-0"></span><span class="token punctuation" style="color:#393A34" data-188-js-token="}-21-0">}</span><span class="token punctuation" style="color:#393A34" data-188-js-token=";-21-1">;</span></div></pre></div><h1 id="🥝-四、其他几种瀑布流的实现方式"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#🥝-四、其他几种瀑布流的实现方式"><span class="icon icon-link"></span></a>🥝 四、其他几种瀑布流的实现方式</h1><h2 id="1column属性实现"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#1column属性实现"><span class="icon icon-link"></span></a>1.column属性实现</h2><h3 id="效果"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#效果"><span class="icon icon-link"></span></a>效果</h3><p><a target="_blank" rel="noopener noreferrer" href="https://zhuling904.github.io/react_demo/?path=/story/%E9%80%9A%E7%94%A8-waterfall%E7%80%91%E5%B8%83%E6%B5%81--column-waterfall">在线demo体验<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><img src="https://cdn.jsdelivr.net/gh/ObjectX-9/DrawingBed/imgMac/clumn.gif" alt="2024-05-14 22.27.17.gif"/></p><h3 id="原理"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#原理"><span class="icon icon-link"></span></a>原理</h3><p><code>column</code> 属性是<code>CSS3</code>中引入的一个模块，它允许你将内容分为多列，就像报纸或杂志那样。这个属性可以让你轻松地创建多列布局，而不需要复杂的标记或脚本。<code>column</code> 属性包括几个子属性，用于控制列的数量、宽度、间距以及内容如何在这些列之间流动。</p><p>以下是一些常用的 <code>column</code> 子属性：</p><ol><li><code>column-count</code>: 指定布局中的列数。例如，<code>column-count: 3;</code> 会将内容分为三列。</li><li><code>column-width</code>: 指定每列的理想宽度。浏览器会尝试创建至少这么宽的列，但如果空间不足，可能会创建更少的列。例如，<code>column-width: 200px;</code> 会尝试创建至少200像素宽的列。如果<strong>不指定宽度则是按百分比</strong></li><li><code>column-gap</code>: 指定列与列之间的间距。例如，<code>column-gap: 20px;</code> 会在每列之间留下20像素的空白。</li><li><code>column-rule</code>: 这是一个简写属性，用于设置列之间的规则（即边框）的宽度、样式和颜色。例如，<code>column-rule: 1px solid black;</code> 会在每列之间添加一个1像素宽的黑色实线边框。</li><li><code>column-span</code>: 指定一个元素是否横跨所有列。例如，<code>column-span: all;</code> 会让一个元素横跨所有列，就像一个标题或广告横幅。</li><li><code>break-before</code>, <code>break-after</code>, <code>break-inside</code>: 这些属性控制内容如何在列、页面或区域之间断开。例如，<code>break-inside: avoid;</code> 会防止一个元素在列内部断开。</li></ol><p>使用 <code>column</code> 属性可以创建出类似于瀑布流的效果，但它并不完全等同于瀑布流布局。瀑布流布局通常指的是一种不规则的、内容高度不一的布局，而 <code>column</code> 属性创建的是规则的、等宽的列。不过，通过结合使用 <code>column</code> 属性和其他CSS技巧，你也可以实现类似瀑布流的效果。</p><h3 id="代码"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#代码"><span class="icon icon-link"></span></a>代码</h3><h4 id="waterfalltsx"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#waterfalltsx"><span class="icon icon-link"></span></a><code>Waterfall.tsx</code></h4><p>组件仅仅用一个容器将图片项目包裹即可，其他的都是css实现，最容易</p><div class="__dumi-default-code-block"><pre class="prism-code language-js" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f" data-189-js-token="import-0-0">import</span><span class="token plain"> </span><span class="token imports maybe-class-name" data-189-js-token="React-0-7">React</span><span class="token imports punctuation" style="color:#393A34" data-189-js-token=",-0-12">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34" data-189-js-token="{-0-14">{</span><span class="token imports" data-189-js-token="useEffect-0-15">useEffect</span><span class="token imports punctuation" style="color:#393A34" data-189-js-token="}-0-24">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-189-js-token="from-0-26">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-189-js-token="&#x27;react&#x27;-0-31">&#x27;react&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-0-38">;</span><span class="token plain" data-189-js-token="-0-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-1-0"></span><span class="token keyword module" style="color:#00009f" data-189-js-token="import-1-0">import</span><span class="token plain"> </span><span class="token imports" data-189-js-token="style-1-7">style</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-189-js-token="from-1-13">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-189-js-token="&#x27;./style/index.module.less&#x27;-1-18">&#x27;./style/index.module.less&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-1-45">;</span><span class="token plain" data-189-js-token="-1-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-2-0"></span><span class="token keyword module" style="color:#00009f" data-189-js-token="import-2-0">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34" data-189-js-token="{-2-7">{</span><span class="token imports" data-189-js-token="fetchRandomImage-2-8">fetchRandomImage</span><span class="token imports punctuation" style="color:#393A34" data-189-js-token="}-2-24">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-189-js-token="from-2-26">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-189-js-token="&#x27;../../api&#x27;-2-31">&#x27;../../api&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-2-42">;</span><span class="token plain" data-189-js-token="-2-43"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-3-0"></span><span class="token keyword module" style="color:#00009f" data-189-js-token="import-3-0">import</span><span class="token plain"> type </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-3-12">{</span><span class="token maybe-class-name" data-189-js-token="UnsplashImage-3-13">UnsplashImage</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-3-26">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-189-js-token="from-3-28">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-189-js-token="&#x27;../../api&#x27;-3-33">&#x27;../../api&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-3-44">;</span><span class="token plain" data-189-js-token="-3-45"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-4-0"></span><span class="token keyword module" style="color:#00009f" data-189-js-token="export-4-0">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-189-js-token="interface-4-7">interface</span><span class="token plain"> </span><span class="token class-name" data-189-js-token="WaterfallProps-4-17">WaterfallProps</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-4-32">{</span><span class="token plain" data-189-js-token="-4-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-5-0">	</span><span class="token comment" style="color:#999988;font-style:italic" data-189-js-token="/**-5-1">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 * 图片数据列表</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 */</span><span class="token plain" data-189-js-token="-7-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="items-8-0">	items</span><span class="token operator" style="color:#393A34" data-189-js-token="?-8-6">?</span><span class="token operator" style="color:#393A34" data-189-js-token=":-8-7">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34" data-189-js-token="[-8-15">[</span><span class="token punctuation" style="color:#393A34" data-189-js-token="]-8-16">]</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-8-17">;</span><span class="token plain" data-189-js-token="-8-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-9-0">	</span><span class="token comment" style="color:#999988;font-style:italic" data-189-js-token="/**-9-1">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 * 图片列宽度，不传入则按列数，每一列宽度是容器的【1 / maxColumns】</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 */</span><span class="token plain" data-189-js-token="-11-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="columnWidth-12-0">	columnWidth</span><span class="token operator" style="color:#393A34" data-189-js-token="?-12-12">?</span><span class="token operator" style="color:#393A34" data-189-js-token=":-12-13">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-12-21">;</span><span class="token plain" data-189-js-token="-12-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-13-0">	</span><span class="token comment" style="color:#999988;font-style:italic" data-189-js-token="/**-13-1">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 * 图片间距</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 */</span><span class="token plain" data-189-js-token="-15-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="gapSize-16-0">	gapSize</span><span class="token operator" style="color:#393A34" data-189-js-token="?-16-8">?</span><span class="token operator" style="color:#393A34" data-189-js-token=":-16-9">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-16-17">;</span><span class="token plain" data-189-js-token="-16-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-17-0">	</span><span class="token comment" style="color:#999988;font-style:italic" data-189-js-token="/**-17-1">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 * 最大列数</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">	 */</span><span class="token plain" data-189-js-token="-19-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="maxColumns-20-0">	maxColumns</span><span class="token operator" style="color:#393A34" data-189-js-token="?-20-11">?</span><span class="token operator" style="color:#393A34" data-189-js-token=":-20-12">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-20-20">;</span><span class="token plain" data-189-js-token="-20-21"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-21-0"></span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-21-0">}</span><span class="token plain" data-189-js-token="-21-1"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-189-js-token="-22-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-23-0"></span><span class="token comment" style="color:#999988;font-style:italic" data-189-js-token="/**-23-0">/**</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * 瀑布流组件</span></div><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain" data-189-js-token="-25-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-26-0"></span><span class="token keyword module" style="color:#00009f" data-189-js-token="export-26-0">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-189-js-token="const-26-7">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49" data-189-js-token="Waterfall-26-13">Waterfall</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-189-js-token="=-26-23">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-26-25">(</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token="{-26-26">{</span><span class="token parameter" data-189-js-token="-26-27"></span></div><div class="token-line" style="color:#393A34"><span class="token parameter" data-189-js-token="items-27-0">	items</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token=",-27-6">,</span><span class="token parameter" data-189-js-token="-27-7"></span></div><div class="token-line" style="color:#393A34"><span class="token parameter">	columnWidth </span><span class="token parameter operator" style="color:#393A34" data-189-js-token="=-28-13">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-189-js-token="200-28-15">200</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token=",-28-18">,</span><span class="token parameter" data-189-js-token="-28-19"></span></div><div class="token-line" style="color:#393A34"><span class="token parameter">	gapSize </span><span class="token parameter operator" style="color:#393A34" data-189-js-token="=-29-9">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-189-js-token="10-29-11">10</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token=",-29-13">,</span><span class="token parameter" data-189-js-token="-29-14"></span></div><div class="token-line" style="color:#393A34"><span class="token parameter">	maxColumns </span><span class="token parameter operator" style="color:#393A34" data-189-js-token="=-30-12">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-189-js-token="5-30-14">5</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token=",-30-15">,</span><span class="token parameter" data-189-js-token="-30-16"></span></div><div class="token-line" style="color:#393A34"><span class="token parameter" data-189-js-token="-31-0">	</span><span class="token parameter operator" style="color:#393A34" data-189-js-token="...-31-1">...</span><span class="token parameter" data-189-js-token="props-31-4">props</span></div><div class="token-line" style="color:#393A34"><span class="token parameter" data-189-js-token="-32-0"></span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token="}-32-0">}</span><span class="token parameter operator" style="color:#393A34" data-189-js-token=":-32-1">:</span><span class="token parameter"> WaterfallProps</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-32-17">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-189-js-token="=&gt;-32-19">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-32-22">{</span><span class="token plain" data-189-js-token="-32-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-33-0">	</span><span class="token keyword" style="color:#00009f" data-189-js-token="const-33-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="[-33-7">[</span><span class="token plain" data-189-js-token="images-33-8">images</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-33-14">,</span><span class="token plain"> setImages</span><span class="token punctuation" style="color:#393A34" data-189-js-token="]-33-25">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-189-js-token="=-33-27">=</span><span class="token plain"> </span><span class="token maybe-class-name" data-189-js-token="React-33-29">React</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-33-34">.</span><span class="token property-access" data-189-js-token="useState-33-35">useState</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-33-43">&lt;</span><span class="token plain" data-189-js-token="any-33-44">any</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-33-47">&gt;</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-33-48">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token="[-33-49">[</span><span class="token punctuation" style="color:#393A34" data-189-js-token="]-33-50">]</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-33-51">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-33-52">;</span><span class="token plain" data-189-js-token="-33-53"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-189-js-token="-34-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-35-0">	</span><span class="token function" style="color:#d73a49" data-189-js-token="useEffect-35-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-35-10">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-35-11">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-35-12">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-189-js-token="=&gt;-35-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-35-17">{</span><span class="token plain" data-189-js-token="-35-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-36-0">		</span><span class="token keyword" style="color:#00009f" data-189-js-token="const-36-2">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-189-js-token="getImages-36-8">getImages</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-189-js-token="=-36-18">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-189-js-token="async-36-20">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-36-26">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-36-27">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-189-js-token="=&gt;-36-29">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-36-32">{</span><span class="token plain" data-189-js-token="-36-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-37-0">			</span><span class="token keyword control-flow" style="color:#00009f" data-189-js-token="try-37-3">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-37-7">{</span><span class="token plain" data-189-js-token="-37-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-38-0">				</span><span class="token keyword" style="color:#00009f" data-189-js-token="const-38-4">const</span><span class="token plain"> imageUrls </span><span class="token operator" style="color:#393A34" data-189-js-token="=-38-20">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-189-js-token="await-38-22">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-189-js-token="fetchRandomImage-38-28">fetchRandomImage</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-38-44">(</span><span class="token number" style="color:#36acaa" data-189-js-token="10-38-45">10</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-38-47">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-38-48">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 获取30张图片</span><span class="token plain" data-189-js-token="-38-60"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-39-0">				</span><span class="token function" style="color:#d73a49" data-189-js-token="setImages-39-4">setImages</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-39-13">(</span><span class="token plain" data-189-js-token="imageUrls-39-14">imageUrls</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-39-23">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-39-24">;</span><span class="token plain" data-189-js-token="-39-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-40-0">			</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-40-3">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-189-js-token="catch-40-5">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-40-11">(</span><span class="token plain" data-189-js-token="error-40-12">error</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-40-17">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-40-19">{</span><span class="token plain" data-189-js-token="-40-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-41-0">				</span><span class="token console class-name" data-189-js-token="console-41-4">console</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-41-11">.</span><span class="token method function property-access" style="color:#d73a49" data-189-js-token="error-41-12">error</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-41-17">(</span><span class="token string" style="color:#e3116c">&#x27;Error fetching images from Unsplash:&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-41-56">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-41-63">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-41-64">;</span><span class="token plain" data-189-js-token="-41-65"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-42-0">			</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-42-3">}</span><span class="token plain" data-189-js-token="-42-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-43-0">		</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-43-2">}</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-43-3">;</span><span class="token plain" data-189-js-token="-43-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-44-0">		</span><span class="token function" style="color:#d73a49" data-189-js-token="getImages-44-2">getImages</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-44-11">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-44-12">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-44-13">;</span><span class="token plain" data-189-js-token="-44-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-45-0">	</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-45-1">}</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-45-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="[-45-4">[</span><span class="token punctuation" style="color:#393A34" data-189-js-token="]-45-5">]</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-45-6">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-45-7">;</span><span class="token plain" data-189-js-token="-45-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-189-js-token="-46-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-47-0">	</span><span class="token function" style="color:#d73a49" data-189-js-token="useEffect-47-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-47-10">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-47-11">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-47-12">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-189-js-token="=&gt;-47-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-47-17">{</span><span class="token plain" data-189-js-token="-47-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-48-0">		</span><span class="token console class-name" data-189-js-token="console-48-2">console</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-48-9">.</span><span class="token method function property-access" style="color:#d73a49" data-189-js-token="log-48-10">log</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-48-13">(</span><span class="token string" style="color:#e3116c">&#x27;✅  ~ images:&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-48-28">,</span><span class="token plain"> images</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-48-36">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-48-37">;</span><span class="token plain" data-189-js-token="-48-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-49-0">	</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-49-1">}</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-49-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="[-49-4">[</span><span class="token plain" data-189-js-token="images-49-5">images</span><span class="token punctuation" style="color:#393A34" data-189-js-token="]-49-11">]</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-49-12">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-49-13">;</span><span class="token plain" data-189-js-token="-49-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-50-0">	</span><span class="token keyword control-flow" style="color:#00009f" data-189-js-token="return-50-1">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-50-8">(</span><span class="token plain" data-189-js-token="-50-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-51-0">		</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-51-2">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#393A34" data-189-js-token="=-51-16">=</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-51-17">{</span><span class="token plain" data-189-js-token="style-51-18">style</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-51-23">.</span><span class="token property-access" data-189-js-token="container-51-24">container</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-51-33">}</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-51-34">&gt;</span><span class="token plain" data-189-js-token="-51-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-52-0">			</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-52-3">{</span><span class="token plain" data-189-js-token="images-52-4">images</span><span class="token operator" style="color:#393A34" data-189-js-token="?.-52-10">?.</span><span class="token method function property-access" style="color:#d73a49" data-189-js-token="map-52-12">map</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-52-15">(</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-52-16">(</span><span class="token parameter" data-189-js-token="image-52-17">image</span><span class="token parameter operator" style="color:#393A34" data-189-js-token=":-52-22">:</span><span class="token parameter"> UnsplashImage</span><span class="token parameter punctuation" style="color:#393A34" data-189-js-token=",-52-37">,</span><span class="token parameter"> index</span><span class="token parameter operator" style="color:#393A34" data-189-js-token=":-52-44">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-52-52">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-189-js-token="=&gt;-52-54">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-52-57">{</span><span class="token plain" data-189-js-token="-52-58"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-53-0">				</span><span class="token console class-name" data-189-js-token="console-53-4">console</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-53-11">.</span><span class="token method function property-access" style="color:#d73a49" data-189-js-token="log-53-12">log</span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-53-15">(</span><span class="token string" style="color:#e3116c">&#x27;✅ ~  image:&#x27;</span><span class="token punctuation" style="color:#393A34" data-189-js-token=",-53-29">,</span><span class="token plain"> image</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-53-36">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-53-37">;</span><span class="token plain" data-189-js-token="-53-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-189-js-token="-54-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-55-0">				</span><span class="token keyword control-flow" style="color:#00009f" data-189-js-token="return-55-4">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-189-js-token="(-55-11">(</span><span class="token plain" data-189-js-token="-55-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-56-0">					</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-56-5">&lt;</span><span class="token plain">div key</span><span class="token operator" style="color:#393A34" data-189-js-token="=-56-13">=</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-56-14">{</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-189-js-token="`-56-15">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="${-56-16">${</span><span class="token template-string interpolation" data-189-js-token="image-56-18">image</span><span class="token template-string interpolation operator" style="color:#393A34" data-189-js-token="?.-56-23">?.</span><span class="token template-string interpolation" data-189-js-token="id-56-25">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="}-56-27">}</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="${-56-28">${</span><span class="token template-string interpolation" data-189-js-token="index-56-30">index</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="}-56-35">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-189-js-token="`-56-36">`</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-56-37">}</span><span class="token plain"> className</span><span class="token operator" style="color:#393A34" data-189-js-token="=-56-48">=</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-56-49">{</span><span class="token plain" data-189-js-token="style-56-50">style</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-56-55">.</span><span class="token property-access" data-189-js-token="item-56-56">item</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-56-60">}</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-56-61">&gt;</span><span class="token plain" data-189-js-token="-56-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-57-0">						</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-57-6">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:#393A34" data-189-js-token="=-57-14">=</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-57-15">{</span><span class="token plain" data-189-js-token="image-57-16">image</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-57-21">.</span><span class="token property-access" data-189-js-token="urls-57-22">urls</span><span class="token punctuation" style="color:#393A34" data-189-js-token=".-57-26">.</span><span class="token property-access" data-189-js-token="full-57-27">full</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-57-31">}</span><span class="token plain"> alt</span><span class="token operator" style="color:#393A34" data-189-js-token="=-57-36">=</span><span class="token punctuation" style="color:#393A34" data-189-js-token="{-57-37">{</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-189-js-token="`-57-38">`</span><span class="token template-string string" style="color:#e3116c">Image </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="${-57-45">${</span><span class="token template-string interpolation" data-189-js-token="index-57-47">index</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-189-js-token="}-57-52">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-189-js-token="`-57-53">`</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-57-54">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-189-js-token="/-57-56">/</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-57-57">&gt;</span><span class="token plain" data-189-js-token="-57-58"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-58-0">					</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-58-5">&lt;</span><span class="token operator" style="color:#393A34" data-189-js-token="/-58-6">/</span><span class="token plain" data-189-js-token="div-58-7">div</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-58-10">&gt;</span><span class="token plain" data-189-js-token="-58-11"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-59-0">				</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-59-4">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-59-5">;</span><span class="token plain" data-189-js-token="-59-6"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-60-0">			</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-60-3">}</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-60-4">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-60-5">}</span><span class="token plain" data-189-js-token="-60-6"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-61-0">		</span><span class="token operator" style="color:#393A34" data-189-js-token="&lt;-61-2">&lt;</span><span class="token operator" style="color:#393A34" data-189-js-token="/-61-3">/</span><span class="token plain" data-189-js-token="div-61-4">div</span><span class="token operator" style="color:#393A34" data-189-js-token="&gt;-61-7">&gt;</span><span class="token plain" data-189-js-token="-61-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-62-0">	</span><span class="token punctuation" style="color:#393A34" data-189-js-token=")-62-1">)</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-62-2">;</span><span class="token plain" data-189-js-token="-62-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-189-js-token="-63-0"></span><span class="token punctuation" style="color:#393A34" data-189-js-token="}-63-0">}</span><span class="token punctuation" style="color:#393A34" data-189-js-token=";-63-1">;</span></div></pre></div><h4 id="indexmoduleless"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indexmoduleless"><span class="icon icon-link"></span></a>index.module.less</h4><p>通过<code>column-count</code>定义容器分为多少列，<code>column-gap</code>定义容器之间的间距，通过<code>break-inside: avoid</code>来避免内容在列内部断开，设置图片等比缩放，保证体验感，设置媒体查询，根据窗口大小调整列数量。</p><div class="__dumi-default-code-block"><pre class="prism-code language-less" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f" data-190-less-token=".container-0-0">.container</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-0-11">{</span><span class="token plain" data-190-less-token="-0-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-1-0">	</span><span class="token property" style="color:#36acaa" data-190-less-token="width-1-1">width</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-1-6">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="100-1-8">100</span><span class="token unit" data-190-less-token="%-1-11">%</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-1-12">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 容器宽度 */</span><span class="token plain" data-190-less-token="-1-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-2-0">	</span><span class="token property" style="color:#36acaa" data-190-less-token="column-count-2-1">column-count</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-2-13">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="5-2-15">5</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-2-16">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 定义列数 */</span><span class="token plain" data-190-less-token="-2-28"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-3-0">	</span><span class="token property" style="color:#36acaa" data-190-less-token="column-gap-3-1">column-gap</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-3-11">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="16-3-13">16</span><span class="token unit" data-190-less-token="px-3-15">px</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-3-17">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 列与列之间的间距 */</span><span class="token plain" data-190-less-token="-3-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-4-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-5-0">	</span><span class="token selector" style="color:#00009f" data-190-less-token=".item-5-1">.item</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-5-7">{</span><span class="token plain" data-190-less-token="-5-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-6-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="break-inside-6-2">break-inside</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-6-14">:</span><span class="token plain"> avoid</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-6-21">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 防止内容在列内部断开 */</span><span class="token plain" data-190-less-token="-6-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-7-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="margin-bottom-7-2">margin-bottom</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-7-15">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="16-7-17">16</span><span class="token unit" data-190-less-token="px-7-19">px</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-7-21">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 每个项目之间的间距 */</span><span class="token plain" data-190-less-token="-7-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-8-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-9-0">		</span><span class="token selector" style="color:#00009f" data-190-less-token="img-9-2">img</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-9-6">{</span><span class="token plain" data-190-less-token="-9-7"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-10-0">			</span><span class="token property" style="color:#36acaa" data-190-less-token="width-10-3">width</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-10-8">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="100-10-10">100</span><span class="token unit" data-190-less-token="%-10-13">%</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-10-14">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 图片宽度填满列宽 */</span><span class="token plain" data-190-less-token="-10-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-11-0">			</span><span class="token property" style="color:#36acaa" data-190-less-token="height-11-3">height</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-11-9">:</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-11-15">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 保持图片宽高比 */</span><span class="token plain" data-190-less-token="-11-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-12-0">		</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-12-2">}</span><span class="token plain" data-190-less-token="-12-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-13-0">	</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-13-1">}</span><span class="token plain" data-190-less-token="-13-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-14-0"></span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-14-0">}</span><span class="token plain" data-190-less-token="-14-1"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-15-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-16-0"></span><span class="token comment" style="color:#999988;font-style:italic">/* 为了响应式设计，你可以使用媒体查询来改变列数 */</span><span class="token plain" data-190-less-token="-16-28"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-17-0"></span><span class="token atrule" style="color:#00a4db">@media </span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token="(-17-7">(</span><span class="token atrule" style="color:#00a4db">width &lt;= 1000px</span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token=")-17-23">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-17-25">{</span><span class="token plain" data-190-less-token="-17-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-18-0">	</span><span class="token comment" style="color:#999988;font-style:italic">/* stylelint-disable-next-line rule-empty-line-before */</span><span class="token plain" data-190-less-token="-18-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-19-0">	</span><span class="token selector" style="color:#00009f" data-190-less-token=".container-19-1">.container</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-19-12">{</span><span class="token plain" data-190-less-token="-19-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-20-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="column-count-20-2">column-count</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-20-14">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="4-20-16">4</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-20-17">;</span><span class="token plain" data-190-less-token="-20-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-21-0">	</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-21-1">}</span><span class="token plain" data-190-less-token="-21-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-22-0"></span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-22-0">}</span><span class="token plain" data-190-less-token="-22-1"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-23-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-24-0"></span><span class="token atrule" style="color:#00a4db">@media </span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token="(-24-7">(</span><span class="token atrule" style="color:#00a4db">width &lt;= 800px</span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token=")-24-22">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-24-24">{</span><span class="token plain" data-190-less-token="-24-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-25-0">	</span><span class="token comment" style="color:#999988;font-style:italic">/* stylelint-disable-next-line rule-empty-line-before */</span><span class="token plain" data-190-less-token="-25-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-26-0">	</span><span class="token selector" style="color:#00009f" data-190-less-token=".container-26-1">.container</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-26-12">{</span><span class="token plain" data-190-less-token="-26-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-27-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="column-count-27-2">column-count</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-27-14">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="3-27-16">3</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-27-17">;</span><span class="token plain" data-190-less-token="-27-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-28-0">	</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-28-1">}</span><span class="token plain" data-190-less-token="-28-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-29-0"></span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-29-0">}</span><span class="token plain" data-190-less-token="-29-1"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-30-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-31-0"></span><span class="token atrule" style="color:#00a4db">@media </span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token="(-31-7">(</span><span class="token atrule" style="color:#00a4db">width &lt;= 600px</span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token=")-31-22">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-31-24">{</span><span class="token plain" data-190-less-token="-31-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-32-0">	</span><span class="token comment" style="color:#999988;font-style:italic">/* stylelint-disable-next-line rule-empty-line-before */</span><span class="token plain" data-190-less-token="-32-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-33-0">	</span><span class="token selector" style="color:#00009f" data-190-less-token=".container-33-1">.container</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-33-12">{</span><span class="token plain" data-190-less-token="-33-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-34-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="column-count-34-2">column-count</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-34-14">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="2-34-16">2</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-34-17">;</span><span class="token plain" data-190-less-token="-34-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-35-0">	</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-35-1">}</span><span class="token plain" data-190-less-token="-35-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-36-0"></span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-36-0">}</span><span class="token plain" data-190-less-token="-36-1"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-190-less-token="-37-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-38-0"></span><span class="token atrule" style="color:#00a4db">@media </span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token="(-38-7">(</span><span class="token atrule" style="color:#00a4db">width &lt;= 400px</span><span class="token atrule punctuation" style="color:#393A34" data-190-less-token=")-38-22">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-38-24">{</span><span class="token plain" data-190-less-token="-38-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-39-0">	</span><span class="token comment" style="color:#999988;font-style:italic">/* stylelint-disable-next-line rule-empty-line-before */</span><span class="token plain" data-190-less-token="-39-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-40-0">	</span><span class="token selector" style="color:#00009f" data-190-less-token=".container-40-1">.container</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-190-less-token="{-40-12">{</span><span class="token plain" data-190-less-token="-40-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-41-0">		</span><span class="token property" style="color:#36acaa" data-190-less-token="column-count-41-2">column-count</span><span class="token punctuation" style="color:#393A34" data-190-less-token=":-41-14">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-190-less-token="1-41-16">1</span><span class="token punctuation" style="color:#393A34" data-190-less-token=";-41-17">;</span><span class="token plain" data-190-less-token="-41-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-42-0">	</span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-42-1">}</span><span class="token plain" data-190-less-token="-42-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-190-less-token="-43-0"></span><span class="token punctuation" style="color:#393A34" data-190-less-token="}-43-0">}</span></div></pre></div><h3 id="优缺点"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#优缺点"><span class="icon icon-link"></span></a>优缺点</h3><p>优点：</p><ol><li><strong>简单易用</strong>：<code>column</code>属性提供了一种简单的方法来创建多列布局，不需要复杂的JavaScript或额外的HTML结构。</li><li><strong>响应式布局</strong>：通过结合媒体查询，你可以轻松地创建响应式多列布局，使得布局能够适应不同的屏幕尺寸和设备。</li><li><strong>内容流动性</strong>：内容会自动填充到各个列中，无需手动计算位置，这使得布局更加灵活和动态。</li><li><strong>浏览器支持</strong>：现代浏览器对<code>column</code>属性的支持良好，这意味着大多数用户都能看到预期的布局效果。</li></ol><p>缺点：</p><ol><li><strong>固定列数</strong>：使用<code>column-count</code>时，列数是固定的，这可能不适用于所有内容，特别是当内容高度不一致时。</li><li><strong>不规则布局限制</strong>：<code>column</code>属性创建的是规则的列布局，而不是真正的瀑布流布局，后者通常具有不规则的列宽和高度。</li><li><strong>内容断开</strong>：在某些情况下，内容的自然阅读流程可能会被列的断开所打断，特别是当内容在不应该断开的地方被分割时，这个配置<code>break-inside: avoid</code>可以防止内容在列内部断开</li><li><strong>交互性限制</strong>：如果需要在列之间进行复杂的交互（如拖放、排序等），<code>column</code>属性可能无法提供足够的支持，并且排列规律永远都是先上下再左右。</li><li><strong>兼容性问题</strong>：虽然现代浏览器支持良好，但一些旧版本的浏览器可能不完全支持<code>column</code>属性，这可能导致在这些浏览器上的布局出现问题。</li><li><strong>性能考虑</strong>：对于大量内容的布局，使用<code>column</code>属性可能会影响性能，尤其是在处理大量动态内容时。</li></ol><h2 id="2flex瀑布流实现方式"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#2flex瀑布流实现方式"><span class="icon icon-link"></span></a>2.flex瀑布流实现方式</h2><h3 id="效果-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#效果-1"><span class="icon icon-link"></span></a>效果</h3><p><a target="_blank" rel="noopener noreferrer" href="https://zhuling904.github.io/react_demo/?path=/story/%E9%80%9A%E7%94%A8-waterfall%E7%80%91%E5%B8%83%E6%B5%81--flex-waterfall">在线demo体验<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="原理-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#原理-1"><span class="icon icon-link"></span></a>原理</h3><p>用一个大的flex容器，设置主轴方向为<code>row</code>，根据<code>props</code>中的最大列数创建小的子集容器，设置主轴方向为<code>column</code>，从上到下，从左到右渲染图片，需要自行切割图片数据放入不同的列中，存在一种情况就是，如果切割后的数据总长度是相等的，那么瀑布流最后的长度就是一致的。</p><h3 id="代码-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#代码-1"><span class="icon icon-link"></span></a>代码</h3><h4 id="indextsx"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indextsx"><span class="icon icon-link"></span></a>index.tsx</h4><p>主要是监听<code>resize</code>重置列数，根据props动态生成列容器</p><div class="__dumi-default-code-block"><pre class="prism-code language-tsx" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f" data-191-tsx-token="const-0-0">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-191-tsx-token="flexTypeRender-0-6">flexTypeRender</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=-0-21">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-0-23">(</span><span class="token parameter" data-191-tsx-token="options-0-24">options</span><span class="token parameter operator" style="color:#393A34" data-191-tsx-token=":-0-31">:</span><span class="token parameter"> WaterfallProps</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-0-47">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-0-49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-0-52">{</span><span class="token plain" data-191-tsx-token="-0-53"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-1-0">	</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="const-1-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-1-7">{</span><span class="token plain">items </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=-1-14">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="[-1-16">[</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="]-1-17">]</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-1-18">,</span><span class="token plain"> maxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-1-30">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=-1-32">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-1-41">;</span><span class="token plain" data-191-tsx-token="-1-42"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-2-0">	</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="const-2-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="[-2-7">[</span><span class="token plain" data-191-tsx-token="newMaxColumns-2-8">newMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-2-21">,</span><span class="token plain"> setNewMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="]-2-39">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=-2-41">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-191-tsx-token="useState-2-43">useState</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-2-51">(</span><span class="token plain">maxColumns </span><span class="token operator" style="color:#393A34" data-191-tsx-token="??-2-63">??</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-191-tsx-token="5-2-66">5</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-2-67">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-2-68">;</span><span class="token plain" data-191-tsx-token="-2-69"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-3-0">	</span><span class="token function" style="color:#d73a49" data-191-tsx-token="useEffect-3-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-3-10">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-3-11">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-3-12">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-3-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-3-17">{</span><span class="token plain" data-191-tsx-token="-3-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-4-0">		</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="const-4-2">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-191-tsx-token="handleResize-4-8">handleResize</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=-4-21">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-4-23">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-4-24">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-4-26">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-4-29">{</span><span class="token plain" data-191-tsx-token="-4-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-5-0">			</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="if-5-3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-5-6">(</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-5-7">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-5-13">.</span><span class="token plain">innerWidth </span><span class="token operator" style="color:#393A34" data-191-tsx-token="&lt;-5-25">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-191-tsx-token="600-5-27">600</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-5-30">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-5-32">{</span><span class="token plain" data-191-tsx-token="-5-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-6-0">				</span><span class="token function" style="color:#d73a49" data-191-tsx-token="setNewMaxColumns-6-4">setNewMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-6-20">(</span><span class="token number" style="color:#36acaa" data-191-tsx-token="2-6-21">2</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-6-22">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-6-23">;</span><span class="token plain" data-191-tsx-token="-6-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-7-0">			</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-7-3">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="else-7-5">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="if-7-10">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-7-13">(</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-7-14">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-7-20">.</span><span class="token plain">innerWidth </span><span class="token operator" style="color:#393A34" data-191-tsx-token="&lt;-7-32">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-191-tsx-token="800-7-34">800</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-7-37">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-7-39">{</span><span class="token plain" data-191-tsx-token="-7-40"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-8-0">				</span><span class="token function" style="color:#d73a49" data-191-tsx-token="setNewMaxColumns-8-4">setNewMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-8-20">(</span><span class="token number" style="color:#36acaa" data-191-tsx-token="3-8-21">3</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-8-22">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-8-23">;</span><span class="token plain" data-191-tsx-token="-8-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-9-0">			</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-9-3">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="else-9-5">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="if-9-10">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-9-13">(</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-9-14">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-9-20">.</span><span class="token plain">innerWidth </span><span class="token operator" style="color:#393A34" data-191-tsx-token="&lt;-9-32">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-191-tsx-token="1000-9-34">1000</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-9-38">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-9-40">{</span><span class="token plain" data-191-tsx-token="-9-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-10-0">				</span><span class="token function" style="color:#d73a49" data-191-tsx-token="setNewMaxColumns-10-4">setNewMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-10-20">(</span><span class="token number" style="color:#36acaa" data-191-tsx-token="4-10-21">4</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-10-22">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-10-23">;</span><span class="token plain" data-191-tsx-token="-10-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-11-0">			</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-11-3">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="else-11-5">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-191-tsx-token="if-11-10">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-11-13">(</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-11-14">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-11-20">.</span><span class="token plain">innerWidth </span><span class="token operator" style="color:#393A34" data-191-tsx-token="&lt;-11-32">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-191-tsx-token="1200-11-34">1200</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-11-38">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-11-40">{</span><span class="token plain" data-191-tsx-token="-11-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-12-0">				</span><span class="token function" style="color:#d73a49" data-191-tsx-token="setNewMaxColumns-12-4">setNewMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-12-20">(</span><span class="token number" style="color:#36acaa" data-191-tsx-token="5-12-21">5</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-12-22">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-12-23">;</span><span class="token plain" data-191-tsx-token="-12-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-13-0">			</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-13-3">}</span><span class="token plain" data-191-tsx-token="-13-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-14-0">		</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-14-2">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-14-3">;</span><span class="token plain" data-191-tsx-token="-14-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-15-0">		</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-15-2">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-15-8">.</span><span class="token function" style="color:#d73a49" data-191-tsx-token="addEventListener-15-9">addEventListener</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-15-25">(</span><span class="token string" style="color:#e3116c" data-191-tsx-token="&#x27;resize&#x27;-15-26">&#x27;resize&#x27;</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-15-34">,</span><span class="token plain"> handleResize</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-15-48">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-15-49">;</span><span class="token plain" data-191-tsx-token="-15-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-16-0">		</span><span class="token function" style="color:#d73a49" data-191-tsx-token="handleResize-16-2">handleResize</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-16-14">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-16-15">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-16-16">;</span><span class="token plain" data-191-tsx-token="-16-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-17-0">		</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="return-17-2">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-17-9">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-17-10">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-17-12">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-17-15">{</span><span class="token plain" data-191-tsx-token="-17-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-18-0">			</span><span class="token dom variable" style="color:#36acaa" data-191-tsx-token="window-18-3">window</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-18-9">.</span><span class="token function" style="color:#d73a49" data-191-tsx-token="removeEventListener-18-10">removeEventListener</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-18-29">(</span><span class="token string" style="color:#e3116c" data-191-tsx-token="&#x27;resize&#x27;-18-30">&#x27;resize&#x27;</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-18-38">,</span><span class="token plain"> handleResize</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-18-52">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-18-53">;</span><span class="token plain" data-191-tsx-token="-18-54"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-19-0">		</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-19-2">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-19-3">;</span><span class="token plain" data-191-tsx-token="-19-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-20-0">	</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-20-1">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-20-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="[-20-4">[</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="]-20-5">]</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-20-6">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-20-7">;</span><span class="token plain" data-191-tsx-token="-20-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-191-tsx-token="-21-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-22-0">	</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="return-22-1">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-22-8">(</span><span class="token plain" data-191-tsx-token="-22-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-23-0">		</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;-23-2">&lt;</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-23-3">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="className-23-7">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-23-16">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-23-17">{</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="style-23-18">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token=".-23-23">.</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="flexContainer-23-24">flexContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-23-37">}</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-23-38">&gt;</span><span class="token plain" data-191-tsx-token="-23-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-24-0">			</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-24-3">{</span><span class="token function maybe-class-name" style="color:#d73a49" data-191-tsx-token="Array-24-4">Array</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-24-9">(</span><span class="token plain" data-191-tsx-token="newMaxColumns-24-10">newMaxColumns</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-24-23">)</span><span class="token plain" data-191-tsx-token="-24-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-25-0">				</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=".-25-4">.</span><span class="token function" style="color:#d73a49" data-191-tsx-token="fill-25-5">fill</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-25-9">(</span><span class="token number" style="color:#36acaa" data-191-tsx-token="0-25-10">0</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-25-11">)</span><span class="token plain" data-191-tsx-token="-25-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-26-0">				</span><span class="token operator" style="color:#393A34" data-191-tsx-token="?.-26-4">?.</span><span class="token function" style="color:#d73a49" data-191-tsx-token="map-26-6">map</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-26-9">(</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-26-10">(</span><span class="token parameter" data-191-tsx-token="item-26-11">item</span><span class="token parameter punctuation" style="color:#393A34" data-191-tsx-token=",-26-15">,</span><span class="token parameter"> index</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-26-22">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-26-24">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-26-27">{</span><span class="token plain" data-191-tsx-token="-26-28"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-27-0">					</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="return-27-5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-27-12">(</span><span class="token plain" data-191-tsx-token="-27-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-28-0">						</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;-28-6">&lt;</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-28-7">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="className-28-11">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-28-20">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-28-21">{</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="style-28-22">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token=".-28-27">.</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="childContainer-28-28">childContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-28-42">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="key-28-44">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-28-47">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-28-48">{</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="index-28-49">index</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-28-54">}</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-28-55">&gt;</span><span class="token plain" data-191-tsx-token="-28-56"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-29-0">							</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-29-7">{</span><span class="token function" style="color:#d73a49" data-191-tsx-token="shuffleArray-29-8">shuffleArray</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-29-20">(</span><span class="token plain" data-191-tsx-token="items-29-21">items</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-29-26">)</span><span class="token operator" style="color:#393A34" data-191-tsx-token="?.-29-27">?.</span><span class="token function" style="color:#d73a49" data-191-tsx-token="map-29-29">map</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-29-32">(</span><span class="token plain" data-191-tsx-token="-29-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-30-0">								</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-30-8">(</span><span class="token parameter" data-191-tsx-token="image-30-9">image</span><span class="token parameter operator" style="color:#393A34" data-191-tsx-token=":-30-14">:</span><span class="token parameter"> UnsplashImage</span><span class="token parameter punctuation" style="color:#393A34" data-191-tsx-token=",-30-29">,</span><span class="token parameter"> index</span><span class="token parameter operator" style="color:#393A34" data-191-tsx-token=":-30-36">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-30-44">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-191-tsx-token="=&gt;-30-46">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="{-30-49">{</span><span class="token plain" data-191-tsx-token="-30-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-31-0">									</span><span class="token keyword" style="color:#00009f" data-191-tsx-token="return-31-9">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="(-31-16">(</span><span class="token plain" data-191-tsx-token="-31-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-32-0">										</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;-32-10">&lt;</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-32-11">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="key-32-15">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-32-18">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-32-19">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-191-tsx-token="`-32-20">`</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="${-32-21">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-191-tsx-token="image-32-23">image</span><span class="token tag script language-javascript template-string interpolation operator" style="color:#393A34" data-191-tsx-token="?.-32-28">?.</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-191-tsx-token="id-32-30">id</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="}-32-32">}</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="${-32-33">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-191-tsx-token="index-32-35">index</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="}-32-40">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-191-tsx-token="`-32-41">`</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-32-42">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="className-32-44">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-32-53">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-32-54">{</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="style-32-55">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token=".-32-60">.</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="item-32-61">item</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-32-65">}</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-32-66">&gt;</span><span class="token plain" data-191-tsx-token="-32-67"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-33-0">											</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;-33-11">&lt;</span><span class="token tag" style="color:#00009f" data-191-tsx-token="img-33-12">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="src-33-16">src</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-33-19">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-33-20">{</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="image-33-21">image</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token=".-33-26">.</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="urls-33-27">urls</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token=".-33-31">.</span><span class="token tag script language-javascript" style="color:#00009f" data-191-tsx-token="full-33-32">full</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-33-36">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-191-tsx-token="alt-33-38">alt</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-191-tsx-token="=-33-41">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="{-33-42">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-191-tsx-token="`-33-43">`</span><span class="token tag script language-javascript template-string string" style="color:#e3116c">Image </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="${-33-50">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-191-tsx-token="index-33-52">index</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-191-tsx-token="}-33-57">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-191-tsx-token="`-33-58">`</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-191-tsx-token="}-33-59">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="/&gt;-33-61">/&gt;</span><span class="token plain" data-191-tsx-token="-33-63"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-34-0">										</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;/-34-10">&lt;/</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-34-12">div</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-34-15">&gt;</span><span class="token plain" data-191-tsx-token="-34-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-35-0">									</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-35-9">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-35-10">;</span><span class="token plain" data-191-tsx-token="-35-11"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-36-0">								</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-36-8">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=",-36-9">,</span><span class="token plain" data-191-tsx-token="-36-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-37-0">							</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-37-7">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-37-8">}</span><span class="token plain" data-191-tsx-token="-37-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-38-0">						</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;/-38-6">&lt;/</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-38-8">div</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-38-11">&gt;</span><span class="token plain" data-191-tsx-token="-38-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-39-0">					</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-39-5">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-39-6">;</span><span class="token plain" data-191-tsx-token="-39-7"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-40-0">				</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-40-4">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-40-5">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-40-6">}</span><span class="token plain" data-191-tsx-token="-40-7"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-41-0">		</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&lt;/-41-2">&lt;/</span><span class="token tag" style="color:#00009f" data-191-tsx-token="div-41-4">div</span><span class="token tag punctuation" style="color:#393A34" data-191-tsx-token="&gt;-41-7">&gt;</span><span class="token plain" data-191-tsx-token="-41-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-42-0">	</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=")-42-1">)</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-42-2">;</span><span class="token plain" data-191-tsx-token="-42-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-191-tsx-token="-43-0"></span><span class="token punctuation" style="color:#393A34" data-191-tsx-token="}-43-0">}</span><span class="token punctuation" style="color:#393A34" data-191-tsx-token=";-43-1">;</span></div></pre></div><h4 id="indexless"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indexless"><span class="icon icon-link"></span></a>index.less</h4><p>设置瀑布流容器主轴方向为<code>row</code>，图片等比缩放。</p><div class="__dumi-default-code-block"><pre class="prism-code language-less" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f" data-192-less-token=".flexContainer-0-0">.flexContainer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-192-less-token="{-0-15">{</span><span class="token plain" data-192-less-token="-0-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-1-0">	</span><span class="token property" style="color:#36acaa" data-192-less-token="display-1-1">display</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-1-8">:</span><span class="token plain"> flex</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-1-14">;</span><span class="token plain" data-192-less-token="-1-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-2-0">	</span><span class="token property" style="color:#36acaa" data-192-less-token="flex-direction-2-1">flex-direction</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-2-15">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-2-20">;</span><span class="token plain" data-192-less-token="-2-21"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-3-0">	</span><span class="token property" style="color:#36acaa" data-192-less-token="width-3-1">width</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-3-6">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="100-3-8">100</span><span class="token unit" data-192-less-token="%-3-11">%</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-3-12">;</span><span class="token plain" data-192-less-token="-3-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-192-less-token="-4-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-5-0">	</span><span class="token selector" style="color:#00009f" data-192-less-token=".childContainer-5-1">.childContainer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-192-less-token="{-5-17">{</span><span class="token plain" data-192-less-token="-5-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-6-0">		</span><span class="token property" style="color:#36acaa" data-192-less-token="flex-6-2">flex</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-6-6">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="1-6-8">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="1-6-10">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="1-6-12">1</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-6-13">;</span><span class="token plain" data-192-less-token="-6-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-7-0">		</span><span class="token property" style="color:#36acaa" data-192-less-token="margin-left-7-2">margin-left</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-7-13">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="10-7-15">10</span><span class="token unit" data-192-less-token="px-7-17">px</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-7-19">;</span><span class="token plain" data-192-less-token="-7-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-9-0">		</span><span class="token selector" style="color:#00009f" data-192-less-token=".item-9-2">.item</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-192-less-token="{-9-8">{</span><span class="token plain" data-192-less-token="-9-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-10-0">			</span><span class="token property" style="color:#36acaa" data-192-less-token="flex-10-3">flex</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-10-7">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0 0 auto&#x27;</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-10-19">;</span><span class="token plain" data-192-less-token="-10-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-11-0">			</span><span class="token property" style="color:#36acaa" data-192-less-token="width-11-3">width</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-11-8">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-192-less-token="&#x27;100%&#x27;-11-10">&#x27;100%&#x27;</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-11-16">;</span><span class="token plain" data-192-less-token="-11-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-192-less-token="-12-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-13-0">			</span><span class="token selector" style="color:#00009f" data-192-less-token="img-13-3">img</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-192-less-token="{-13-7">{</span><span class="token plain" data-192-less-token="-13-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-14-0">				</span><span class="token property" style="color:#36acaa" data-192-less-token="width-14-4">width</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-14-9">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-192-less-token="100-14-11">100</span><span class="token unit" data-192-less-token="%-14-14">%</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-14-15">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 图片宽度填满列宽 */</span><span class="token plain" data-192-less-token="-14-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-15-0">				</span><span class="token property" style="color:#36acaa" data-192-less-token="height-15-4">height</span><span class="token punctuation" style="color:#393A34" data-192-less-token=":-15-10">:</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34" data-192-less-token=";-15-16">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 保持图片宽高比 */</span><span class="token plain" data-192-less-token="-15-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-16-0">			</span><span class="token punctuation" style="color:#393A34" data-192-less-token="}-16-3">}</span><span class="token plain" data-192-less-token="-16-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-17-0">		</span><span class="token punctuation" style="color:#393A34" data-192-less-token="}-17-2">}</span><span class="token plain" data-192-less-token="-17-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-18-0">	</span><span class="token punctuation" style="color:#393A34" data-192-less-token="}-18-1">}</span><span class="token plain" data-192-less-token="-18-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-192-less-token="-19-0"></span><span class="token punctuation" style="color:#393A34" data-192-less-token="}-19-0">}</span></div></pre></div><h3 id="优缺点-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#优缺点-1"><span class="icon icon-link"></span></a>优缺点</h3><p><strong>优点</strong></p><ol><li><strong>布局灵活</strong>：Flexbox 布局可以很容易地适应各种屏幕尺寸和分辨率。通过调整容器的 <code>flex</code> 属性，可以实现自适应布局。</li><li><strong>实现简单</strong>：利用 Flexbox 的特性，可以较为容易地实现从左到右、从上到下的布局，不需要复杂的计算和手动调整。</li><li><strong>自动换行</strong>：当图片过多时，主容器可以自动换行，继续放置新的图片，不会超出容器范围。</li><li><strong>简化样式控制</strong>：只需控制主容器和子容器的 <code>flex</code> 属性，就可以实现布局，不需要太多额外的 CSS 样式。</li></ol><p><strong>缺点</strong></p><ol><li><strong>列高度不一致</strong>：由于图片高度不同，各列的高度可能会不一致，导致布局不整齐，视觉效果不佳。</li><li><strong>性能问题</strong>：当图片较多时，每次重新渲染都会影响性能。Flexbox 布局在处理大量元素时，性能可能不如其他布局方案（如 Masonry）。</li><li><strong>图片加载顺序</strong>：在网络状况较差或图片较大时，图片加载顺序可能会影响布局，导致图片在渲染时跳动。</li><li><strong>复杂的列数控制</strong>：需要根据 <code>props</code> 动态创建子容器并控制每列的图片数量，这增加了代码复杂性。</li></ol><h2 id="3grid瀑布流实现方式"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#3grid瀑布流实现方式"><span class="icon icon-link"></span></a>3.grid瀑布流实现方式</h2><h3 id="效果-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#效果-2"><span class="icon icon-link"></span></a>效果</h3><p><a target="_blank" rel="noopener noreferrer" href="https://zhuling904.github.io/react_demo/?path=/story/%E9%80%9A%E7%94%A8-waterfall%E7%80%91%E5%B8%83%E6%B5%81--grid-waterfall">在线demo体验<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><img src="https://cdn.jsdelivr.net/gh/ObjectX-9/DrawingBed/imgMac/grid.gif" alt="2024-05-18 11.26.13.gif"/></p><h3 id="原理-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#原理-2"><span class="icon icon-link"></span></a>原理</h3><p>先给网格设置一个默认的行高<code>grid-auto-rows: 10px</code>，然后在图片加载完成后去计算计算图片真实占据的高度</p><div class="__dumi-default-code-block"><pre class="prism-code language-js" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 缓存计算，避免重复计算</span><span class="token plain" data-193-js-token="-0-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-1-0">	</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-1-1">const</span><span class="token plain"> calcRows </span><span class="token operator" style="color:#393A34" data-193-js-token="=-1-16">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-193-js-token="useCallback-1-18">useCallback</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-1-29">(</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-1-30">(</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-1-31">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-193-js-token="=&gt;-1-33">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-193-js-token="{-1-36">{</span><span class="token plain" data-193-js-token="-1-37"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-2-0">		</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-2-2">const</span><span class="token plain"> gridContainerNode </span><span class="token operator" style="color:#393A34" data-193-js-token="=-2-26">=</span><span class="token plain"> gridContainer</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-2-41">.</span><span class="token property-access" data-193-js-token="current-2-42">current</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-2-49">;</span><span class="token plain" data-193-js-token="-2-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-3-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-193-js-token="if-3-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-3-5">(</span><span class="token plain">gridContainerNode </span><span class="token operator" style="color:#393A34" data-193-js-token="===-3-24">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f" data-193-js-token="null-3-28">null</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-3-32">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-193-js-token="return-3-34">return</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-3-40">;</span><span class="token plain" data-193-js-token="-3-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-193-js-token="-4-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-5-0">		</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-5-2">const</span><span class="token plain"> itemNodes </span><span class="token operator" style="color:#393A34" data-193-js-token="=-5-18">=</span><span class="token plain"> gridContainerNode</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-5-37">.</span><span class="token method function property-access" style="color:#d73a49" data-193-js-token="querySelectorAll-5-38">querySelectorAll</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-5-54">(</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-193-js-token="`-5-55">`</span><span class="token template-string string" style="color:#e3116c" data-193-js-token=".-5-56">.</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-193-js-token="${-5-57">${</span><span class="token template-string interpolation" data-193-js-token="style-5-59">style</span><span class="token template-string interpolation punctuation" style="color:#393A34" data-193-js-token=".-5-64">.</span><span class="token template-string interpolation" data-193-js-token="item-5-65">item</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-193-js-token="}-5-69">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-193-js-token="`-5-70">`</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-5-71">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-5-72">;</span><span class="token plain" data-193-js-token="-5-73"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-6-0">		</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-6-2">const</span><span class="token plain"> cols </span><span class="token operator" style="color:#393A34" data-193-js-token="=-6-13">=</span><span class="token plain" data-193-js-token="-6-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-7-0">			</span><span class="token function" style="color:#d73a49" data-193-js-token="getComputedStyle-7-3">getComputedStyle</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-7-19">(</span><span class="token plain" data-193-js-token="gridContainerNode-7-20">gridContainerNode</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-7-37">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-7-38">.</span><span class="token property-access" data-193-js-token="gridTemplateColumns-7-39">gridTemplateColumns</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-7-58">.</span><span class="token method function property-access" style="color:#d73a49" data-193-js-token="split-7-59">split</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-7-64">(</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-7-68">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-7-69">.</span><span class="token property-access" data-193-js-token="length-7-70">length</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-7-76">;</span><span class="token plain" data-193-js-token="-7-77"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-8-0">		</span><span class="token comment" style="color:#999988;font-style:italic">// 计算每个项目占据的位置</span><span class="token plain" data-193-js-token="-8-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="itemNodes-9-0">		itemNodes</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-9-11">.</span><span class="token method function property-access" style="color:#d73a49" data-193-js-token="forEach-9-12">forEach</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-9-19">(</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-9-20">(</span><span class="token parameter" data-193-js-token="item-9-21">item</span><span class="token parameter punctuation" style="color:#393A34" data-193-js-token=",-9-25">,</span><span class="token parameter"> index</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-9-32">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-193-js-token="=&gt;-9-34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-193-js-token="{-9-37">{</span><span class="token plain" data-193-js-token="-9-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-10-0">			</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-10-3">const</span><span class="token plain"> gapRows </span><span class="token operator" style="color:#393A34" data-193-js-token="=-10-17">=</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34" data-193-js-token="&gt;=-10-25">&gt;=</span><span class="token plain"> cols </span><span class="token operator" style="color:#393A34" data-193-js-token="?-10-33">?</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-193-js-token="8-10-35">8</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-193-js-token=":-10-37">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-193-js-token="0-10-39">0</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-10-40">;</span><span class="token plain" data-193-js-token="-10-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-11-0">			</span><span class="token keyword" style="color:#00009f" data-193-js-token="const-11-3">const</span><span class="token plain"> rows </span><span class="token operator" style="color:#393A34" data-193-js-token="=-11-14">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-193-js-token="Math-11-16">Math</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-11-20">.</span><span class="token method function property-access" style="color:#d73a49" data-193-js-token="ceil-11-21">ceil</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-11-25">(</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-11-26">(</span><span class="token plain" data-193-js-token="item-11-27">item</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-11-31">.</span><span class="token property-access" data-193-js-token="clientHeight-11-32">clientHeight</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-193-js-token="+-11-45">+</span><span class="token plain"> gapRows</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-11-54">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-193-js-token="/-11-56">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-193-js-token="10-11-58">10</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-11-60">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-11-61">;</span><span class="token plain" data-193-js-token="-11-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-12-0">			</span><span class="token punctuation" style="color:#393A34" data-193-js-token="(-12-3">(</span><span class="token plain">item </span><span class="token keyword module" style="color:#00009f" data-193-js-token="as-12-9">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-193-js-token="HTMLDivElement-12-12">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-12-26">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-12-27">.</span><span class="token property-access" data-193-js-token="style-12-28">style</span><span class="token punctuation" style="color:#393A34" data-193-js-token=".-12-33">.</span><span class="token property-access" data-193-js-token="gridRowEnd-12-34">gridRowEnd</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-193-js-token="=-12-45">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c" data-193-js-token="`-12-47">`</span><span class="token template-string string" style="color:#e3116c">span </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-193-js-token="${-12-53">${</span><span class="token template-string interpolation" data-193-js-token="rows-12-55">rows</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-193-js-token="}-12-59">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-193-js-token="`-12-60">`</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-12-61">;</span><span class="token plain" data-193-js-token="-12-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-13-0">		</span><span class="token punctuation" style="color:#393A34" data-193-js-token="}-13-2">}</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-13-3">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-13-4">;</span><span class="token plain" data-193-js-token="-13-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-193-js-token="-14-0">	</span><span class="token punctuation" style="color:#393A34" data-193-js-token="}-14-1">}</span><span class="token punctuation" style="color:#393A34" data-193-js-token=",-14-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-193-js-token="[-14-4">[</span><span class="token punctuation" style="color:#393A34" data-193-js-token="]-14-5">]</span><span class="token punctuation" style="color:#393A34" data-193-js-token=")-14-6">)</span><span class="token punctuation" style="color:#393A34" data-193-js-token=";-14-7">;</span></div></pre></div><h3 id="代码-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#代码-2"><span class="icon icon-link"></span></a>代码</h3><h4 id="indextsx-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indextsx-1"><span class="icon icon-link"></span></a>index.tsx</h4><div class="__dumi-default-code-block"><pre class="prism-code language-tsx" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-0-0">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-194-tsx-token="gridTypeRender-0-6">gridTypeRender</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-0-21">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-0-23">(</span><span class="token parameter" data-194-tsx-token="options-0-24">options</span><span class="token parameter operator" style="color:#393A34" data-194-tsx-token=":-0-31">:</span><span class="token parameter"> WaterfallProps</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-0-47">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-0-49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-0-52">{</span><span class="token plain" data-194-tsx-token="-0-53"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-1-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-1-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-1-7">{</span><span class="token plain">items </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-1-14">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="[-1-16">[</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="]-1-17">]</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-1-18">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-1-20">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-1-29">;</span><span class="token plain" data-194-tsx-token="-1-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-2-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-2-1">const</span><span class="token plain"> gridContainer </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-2-21">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49" data-194-tsx-token="useRef-2-23">useRef</span><span class="token generic-function generic class-name operator" style="color:#393A34" data-194-tsx-token="&lt;-2-29">&lt;</span><span class="token generic-function generic class-name maybe-class-name" data-194-tsx-token="HTMLDivElement-2-30">HTMLDivElement</span><span class="token generic-function generic class-name operator" style="color:#393A34" data-194-tsx-token="&gt;-2-44">&gt;</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-2-45">(</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="null-2-46">null</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-2-50">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-2-51">;</span><span class="token plain" data-194-tsx-token="-2-52"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-3-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-3-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="[-3-7">[</span><span class="token plain" data-194-tsx-token="imagesLoaded-3-8">imagesLoaded</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-3-20">,</span><span class="token plain"> setImagesLoaded</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="]-3-37">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-3-39">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-194-tsx-token="useState-3-41">useState</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-3-49">(</span><span class="token boolean" style="color:#36acaa" data-194-tsx-token="false-3-50">false</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-3-55">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-3-56">;</span><span class="token plain" data-194-tsx-token="-3-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-4-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-5-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 缓存计算，避免重复计算</span><span class="token plain" data-194-tsx-token="-5-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-6-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-6-1">const</span><span class="token plain"> calcRows </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-6-16">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-194-tsx-token="useCallback-6-18">useCallback</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-6-29">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-6-30">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-6-31">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-6-33">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-6-36">{</span><span class="token plain" data-194-tsx-token="-6-37"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-7-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-7-2">const</span><span class="token plain"> gridContainerNode </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-7-26">=</span><span class="token plain"> gridContainer</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-7-41">.</span><span class="token plain" data-194-tsx-token="current-7-42">current</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-7-49">;</span><span class="token plain" data-194-tsx-token="-7-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-8-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="if-8-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-8-5">(</span><span class="token plain">gridContainerNode </span><span class="token operator" style="color:#393A34" data-194-tsx-token="===-8-24">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-194-tsx-token="null-8-28">null</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-8-32">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-194-tsx-token="return-8-34">return</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-8-40">;</span><span class="token plain" data-194-tsx-token="-8-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-9-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-10-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-10-2">const</span><span class="token plain"> itemNodes </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-10-18">=</span><span class="token plain"> gridContainerNode</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-10-37">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="querySelectorAll-10-38">querySelectorAll</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-10-54">(</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-10-55">`</span><span class="token template-string string" style="color:#e3116c" data-194-tsx-token=".-10-56">.</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="${-10-57">${</span><span class="token template-string interpolation" data-194-tsx-token="style-10-59">style</span><span class="token template-string interpolation punctuation" style="color:#393A34" data-194-tsx-token=".-10-64">.</span><span class="token template-string interpolation" data-194-tsx-token="item-10-65">item</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="}-10-69">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-10-70">`</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-10-71">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-10-72">;</span><span class="token plain" data-194-tsx-token="-10-73"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-11-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-11-2">const</span><span class="token plain"> cols </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-11-13">=</span><span class="token plain" data-194-tsx-token="-11-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-12-0">			</span><span class="token function" style="color:#d73a49" data-194-tsx-token="getComputedStyle-12-3">getComputedStyle</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-12-19">(</span><span class="token plain" data-194-tsx-token="gridContainerNode-12-20">gridContainerNode</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-12-37">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-12-38">.</span><span class="token plain" data-194-tsx-token="gridTemplateColumns-12-39">gridTemplateColumns</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-12-58">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="split-12-59">split</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-12-64">(</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-12-68">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-12-69">.</span><span class="token plain" data-194-tsx-token="length-12-70">length</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-12-76">;</span><span class="token plain" data-194-tsx-token="-12-77"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-13-0">		</span><span class="token comment" style="color:#999988;font-style:italic">// 计算每个项目占据的位置</span><span class="token plain" data-194-tsx-token="-13-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="itemNodes-14-0">		itemNodes</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-14-11">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="forEach-14-12">forEach</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-14-19">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-14-20">(</span><span class="token parameter" data-194-tsx-token="item-14-21">item</span><span class="token parameter punctuation" style="color:#393A34" data-194-tsx-token=",-14-25">,</span><span class="token parameter"> index</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-14-32">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-14-34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-14-37">{</span><span class="token plain" data-194-tsx-token="-14-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-15-0">			</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-15-3">const</span><span class="token plain"> gapRows </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-15-17">=</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34" data-194-tsx-token="&gt;=-15-25">&gt;=</span><span class="token plain"> cols </span><span class="token operator" style="color:#393A34" data-194-tsx-token="?-15-33">?</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-194-tsx-token="8-15-35">8</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token=":-15-37">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-194-tsx-token="0-15-39">0</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-15-40">;</span><span class="token plain" data-194-tsx-token="-15-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-16-0">			</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-16-3">const</span><span class="token plain"> rows </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-16-14">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-194-tsx-token="Math-16-16">Math</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-16-20">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="ceil-16-21">ceil</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-16-25">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-16-26">(</span><span class="token plain" data-194-tsx-token="item-16-27">item</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-16-31">.</span><span class="token plain">clientHeight </span><span class="token operator" style="color:#393A34" data-194-tsx-token="+-16-45">+</span><span class="token plain"> gapRows</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-16-54">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="/-16-56">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-194-tsx-token="10-16-58">10</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-16-60">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-16-61">;</span><span class="token plain" data-194-tsx-token="-16-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-17-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-17-3">(</span><span class="token plain">item </span><span class="token keyword" style="color:#00009f" data-194-tsx-token="as-17-9">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-194-tsx-token="HTMLDivElement-17-12">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-17-26">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-17-27">.</span><span class="token plain" data-194-tsx-token="style-17-28">style</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-17-33">.</span><span class="token plain">gridRowEnd </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-17-45">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-17-47">`</span><span class="token template-string string" style="color:#e3116c">span </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="${-17-53">${</span><span class="token template-string interpolation" data-194-tsx-token="rows-17-55">rows</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="}-17-59">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-17-60">`</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-17-61">;</span><span class="token plain" data-194-tsx-token="-17-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-18-0">		</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-18-2">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-18-3">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-18-4">;</span><span class="token plain" data-194-tsx-token="-18-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-19-0">	</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-19-1">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-19-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="[-19-4">[</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="]-19-5">]</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-19-6">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-19-7">;</span><span class="token plain" data-194-tsx-token="-19-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-20-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-21-0">	</span><span class="token function" style="color:#d73a49" data-194-tsx-token="useEffect-21-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-21-10">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-21-11">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-21-12">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-21-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-21-17">{</span><span class="token plain" data-194-tsx-token="-21-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-22-0">		</span><span class="token comment" style="color:#999988;font-style:italic">// 确保图片加载完成后再去计算布局</span><span class="token plain" data-194-tsx-token="-22-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-23-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="if-23-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-23-5">(</span><span class="token plain" data-194-tsx-token="imagesLoaded-23-6">imagesLoaded</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-23-18">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-23-20">{</span><span class="token plain" data-194-tsx-token="-23-21"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-24-0">			</span><span class="token function" style="color:#d73a49" data-194-tsx-token="calcRows-24-3">calcRows</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-24-11">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-24-12">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-24-13">;</span><span class="token plain" data-194-tsx-token="-24-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-25-0">			</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-25-3">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-194-tsx-token="handleResize-25-9">handleResize</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-25-22">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-25-24">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-25-25">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-25-27">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-25-30">{</span><span class="token plain" data-194-tsx-token="-25-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-26-0">				</span><span class="token comment" style="color:#999988;font-style:italic">// 浏览器空闲计算布局</span><span class="token plain" data-194-tsx-token="-26-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-27-0">				</span><span class="token function" style="color:#d73a49" data-194-tsx-token="requestAnimationFrame-27-4">requestAnimationFrame</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-27-25">(</span><span class="token plain" data-194-tsx-token="calcRows-27-26">calcRows</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-27-34">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-27-35">;</span><span class="token plain" data-194-tsx-token="-27-36"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-28-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-28-3">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-28-4">;</span><span class="token plain" data-194-tsx-token="-28-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-29-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-30-0">			</span><span class="token dom variable" style="color:#36acaa" data-194-tsx-token="window-30-3">window</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-30-9">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="addEventListener-30-10">addEventListener</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-30-26">(</span><span class="token string" style="color:#e3116c" data-194-tsx-token="&#x27;resize&#x27;-30-27">&#x27;resize&#x27;</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-30-35">,</span><span class="token plain"> handleResize</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-30-49">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-30-50">;</span><span class="token plain" data-194-tsx-token="-30-51"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-31-0">			</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="return-31-3">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-31-10">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-31-11">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-31-13">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-31-16">{</span><span class="token plain" data-194-tsx-token="-31-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-32-0">				</span><span class="token dom variable" style="color:#36acaa" data-194-tsx-token="window-32-4">window</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-32-10">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="removeEventListener-32-11">removeEventListener</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-32-30">(</span><span class="token string" style="color:#e3116c" data-194-tsx-token="&#x27;resize&#x27;-32-31">&#x27;resize&#x27;</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-32-39">,</span><span class="token plain"> handleResize</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-32-53">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-32-54">;</span><span class="token plain" data-194-tsx-token="-32-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-33-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-33-3">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-33-4">;</span><span class="token plain" data-194-tsx-token="-33-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-34-0">		</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-34-2">}</span><span class="token plain" data-194-tsx-token="-34-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-35-0">	</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-35-1">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-35-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="[-35-4">[</span><span class="token plain" data-194-tsx-token="imagesLoaded-35-5">imagesLoaded</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-35-17">,</span><span class="token plain"> calcRows</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="]-35-27">]</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-35-28">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-35-29">;</span><span class="token plain" data-194-tsx-token="-35-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-36-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-37-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 图片加载完成后再去计算布局，useCallback避免重复计算</span><span class="token plain" data-194-tsx-token="-37-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-38-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-38-1">const</span><span class="token plain"> handleImageLoad </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-38-23">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-194-tsx-token="useCallback-38-25">useCallback</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-38-36">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-38-37">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-38-38">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-38-40">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-38-43">{</span><span class="token plain" data-194-tsx-token="-38-44"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-39-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-39-2">const</span><span class="token plain"> totalImages </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-39-20">=</span><span class="token plain"> items</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-39-27">.</span><span class="token plain" data-194-tsx-token="length-39-28">length</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-39-34">;</span><span class="token plain" data-194-tsx-token="-39-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-40-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="let-40-2">let</span><span class="token plain"> loadedImages </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-40-19">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-194-tsx-token="0-40-21">0</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-40-22">;</span><span class="token plain" data-194-tsx-token="-40-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-41-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-42-0">		</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="return-42-2">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-42-9">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-42-10">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-42-12">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-42-15">{</span><span class="token plain" data-194-tsx-token="-42-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="loadedImages-43-0">			loadedImages</span><span class="token operator" style="color:#393A34" data-194-tsx-token="++-43-15">++</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-43-17">;</span><span class="token plain" data-194-tsx-token="-43-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-44-0">			</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="if-44-3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-44-6">(</span><span class="token plain">loadedImages </span><span class="token operator" style="color:#393A34" data-194-tsx-token="===-44-20">===</span><span class="token plain"> totalImages</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-44-35">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-44-37">{</span><span class="token plain" data-194-tsx-token="-44-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-45-0">				</span><span class="token function" style="color:#d73a49" data-194-tsx-token="setImagesLoaded-45-4">setImagesLoaded</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-45-19">(</span><span class="token boolean" style="color:#36acaa" data-194-tsx-token="true-45-20">true</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-45-24">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-45-25">;</span><span class="token plain" data-194-tsx-token="-45-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-46-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-46-3">}</span><span class="token plain" data-194-tsx-token="-46-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-47-0">		</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-47-2">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-47-3">;</span><span class="token plain" data-194-tsx-token="-47-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-48-0">	</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-48-1">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=",-48-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="[-48-4">[</span><span class="token plain" data-194-tsx-token="items-48-5">items</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-48-10">.</span><span class="token plain" data-194-tsx-token="length-48-11">length</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="]-48-17">]</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-48-18">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-48-19">;</span><span class="token plain" data-194-tsx-token="-48-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-49-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-50-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="const-50-1">const</span><span class="token plain"> onLoad </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=-50-14">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-194-tsx-token="handleImageLoad-50-16">handleImageLoad</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-50-31">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-50-32">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-50-33">;</span><span class="token plain" data-194-tsx-token="-50-34"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-194-tsx-token="-51-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-52-0">	</span><span class="token keyword" style="color:#00009f" data-194-tsx-token="return-52-1">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-52-8">(</span><span class="token plain" data-194-tsx-token="-52-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-53-0">		</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&lt;-53-2">&lt;</span><span class="token tag" style="color:#00009f" data-194-tsx-token="div-53-3">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="className-53-7">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-53-16">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-53-17">{</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="style-53-18">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token=".-53-23">.</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="gridContainer-53-24">gridContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-53-37">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="ref-53-39">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-53-42">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-53-43">{</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="gridContainer-53-44">gridContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-53-57">}</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&gt;-53-58">&gt;</span><span class="token plain" data-194-tsx-token="-53-59"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-54-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="{-54-3">{</span><span class="token function" style="color:#d73a49" data-194-tsx-token="shuffleArray-54-4">shuffleArray</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-54-16">(</span><span class="token plain" data-194-tsx-token="items-54-17">items</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-54-22">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=".-54-23">.</span><span class="token function" style="color:#d73a49" data-194-tsx-token="map-54-24">map</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-54-27">(</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-54-28">(</span><span class="token parameter" data-194-tsx-token="image-54-29">image</span><span class="token parameter operator" style="color:#393A34" data-194-tsx-token=":-54-34">:</span><span class="token parameter"> UnsplashImage</span><span class="token parameter punctuation" style="color:#393A34" data-194-tsx-token=",-54-49">,</span><span class="token parameter"> index</span><span class="token parameter operator" style="color:#393A34" data-194-tsx-token=":-54-56">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-54-64">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-194-tsx-token="=&gt;-54-66">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="(-54-69">(</span><span class="token plain" data-194-tsx-token="-54-70"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-55-0">				</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&lt;-55-4">&lt;</span><span class="token tag" style="color:#00009f" data-194-tsx-token="div-55-5">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="key-55-9">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-55-12">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-55-13">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-55-14">`</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="${-55-15">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-194-tsx-token="image-55-17">image</span><span class="token tag script language-javascript template-string interpolation operator" style="color:#393A34" data-194-tsx-token="?.-55-22">?.</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-194-tsx-token="id-55-24">id</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="}-55-26">}</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="${-55-27">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-194-tsx-token="index-55-29">index</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="}-55-34">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-55-35">`</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-55-36">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="className-55-38">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-55-47">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-55-48">{</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="style-55-49">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token=".-55-54">.</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="item-55-55">item</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-55-59">}</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&gt;-55-60">&gt;</span><span class="token plain" data-194-tsx-token="-55-61"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-56-0">					</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&lt;-56-5">&lt;</span><span class="token tag" style="color:#00009f" data-194-tsx-token="img-56-6">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="src-56-10">src</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-56-13">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-56-14">{</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="image-56-15">image</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token=".-56-20">.</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="urls-56-21">urls</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token=".-56-25">.</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="full-56-26">full</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-56-30">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="alt-56-32">alt</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-56-35">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-56-36">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-56-37">`</span><span class="token tag script language-javascript template-string string" style="color:#e3116c">Image </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="${-56-44">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f" data-194-tsx-token="index-56-46">index</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-194-tsx-token="}-56-51">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c" data-194-tsx-token="`-56-52">`</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-56-53">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-194-tsx-token="onLoad-56-55">onLoad</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-194-tsx-token="=-56-61">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="{-56-62">{</span><span class="token tag script language-javascript" style="color:#00009f" data-194-tsx-token="onLoad-56-63">onLoad</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-194-tsx-token="}-56-69">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="/&gt;-56-71">/&gt;</span><span class="token plain" data-194-tsx-token="-56-73"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-57-0">				</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&lt;/-57-4">&lt;/</span><span class="token tag" style="color:#00009f" data-194-tsx-token="div-57-6">div</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&gt;-57-9">&gt;</span><span class="token plain" data-194-tsx-token="-57-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-58-0">			</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-58-3">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-58-4">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-58-5">}</span><span class="token plain" data-194-tsx-token="-58-6"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-59-0">		</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&lt;/-59-2">&lt;/</span><span class="token tag" style="color:#00009f" data-194-tsx-token="div-59-4">div</span><span class="token tag punctuation" style="color:#393A34" data-194-tsx-token="&gt;-59-7">&gt;</span><span class="token plain" data-194-tsx-token="-59-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-60-0">	</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=")-60-1">)</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-60-2">;</span><span class="token plain" data-194-tsx-token="-60-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-194-tsx-token="-61-0"></span><span class="token punctuation" style="color:#393A34" data-194-tsx-token="}-61-0">}</span><span class="token punctuation" style="color:#393A34" data-194-tsx-token=";-61-1">;</span></div></pre></div><h4 id="indexless-1"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indexless-1"><span class="icon icon-link"></span></a>index.less</h4><div class="__dumi-default-code-block"><pre class="prism-code language-less" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f" data-195-less-token=".gridContainer-0-0">.gridContainer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-195-less-token="{-0-15">{</span><span class="token plain" data-195-less-token="-0-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-1-0">	</span><span class="token property" style="color:#36acaa" data-195-less-token="display-1-1">display</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-1-8">:</span><span class="token plain"> grid</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-1-14">;</span><span class="token plain" data-195-less-token="-1-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-2-0">	</span><span class="token property" style="color:#36acaa" data-195-less-token="grid-auto-rows-2-1">grid-auto-rows</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-2-15">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-195-less-token="10-2-17">10</span><span class="token unit" data-195-less-token="px-2-19">px</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-2-21">;</span><span class="token plain" data-195-less-token="-2-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-3-0">	</span><span class="token property" style="color:#36acaa" data-195-less-token="grid-gap-3-1">grid-gap</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-3-9">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-195-less-token="0-3-11">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-195-less-token="10-3-13">10</span><span class="token unit" data-195-less-token="px-3-15">px</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-3-17">;</span><span class="token plain" data-195-less-token="-3-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-4-0">	</span><span class="token property" style="color:#36acaa" data-195-less-token="grid-template-columns-4-1">grid-template-columns</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-4-22">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-195-less-token="repeat-4-24">repeat</span><span class="token punctuation" style="color:#393A34" data-195-less-token="(-4-30">(</span><span class="token number" style="color:#36acaa" data-195-less-token="4-4-31">4</span><span class="token punctuation" style="color:#393A34" data-195-less-token=",-4-32">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-195-less-token="1-4-34">1</span><span class="token unit" data-195-less-token="fr-4-35">fr</span><span class="token punctuation" style="color:#393A34" data-195-less-token=")-4-37">)</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-4-38">;</span><span class="token plain" data-195-less-token="-4-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-5-0">	</span><span class="token property" style="color:#36acaa" data-195-less-token="align-items-5-1">align-items</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-5-12">:</span><span class="token plain"> end</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-5-17">;</span><span class="token plain" data-195-less-token="-5-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-195-less-token="-6-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-7-0">	</span><span class="token selector" style="color:#00009f" data-195-less-token=".item-7-1">.item</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-195-less-token="{-7-7">{</span><span class="token plain" data-195-less-token="-7-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-8-0">		</span><span class="token property" style="color:#36acaa" data-195-less-token="display-8-2">display</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-8-9">:</span><span class="token plain"> flex</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-8-15">;</span><span class="token plain" data-195-less-token="-8-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-9-0">		</span><span class="token property" style="color:#36acaa" data-195-less-token="align-items-9-2">align-items</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-9-13">:</span><span class="token plain"> center</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-9-21">;</span><span class="token plain" data-195-less-token="-9-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-10-0">		</span><span class="token property" style="color:#36acaa" data-195-less-token="justify-content-10-2">justify-content</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-10-17">:</span><span class="token plain"> center</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-10-25">;</span><span class="token plain" data-195-less-token="-10-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-11-0">		</span><span class="token property" style="color:#36acaa" data-195-less-token="background-11-2">background</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-11-12">:</span><span class="token plain"> </span><span class="token hexcode color" data-195-less-token="#f8f8fa-11-14">#f8f8fa</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-11-21">;</span><span class="token plain" data-195-less-token="-11-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-195-less-token="-12-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-13-0">		</span><span class="token selector" style="color:#00009f" data-195-less-token="img-13-2">img</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-195-less-token="{-13-6">{</span><span class="token plain" data-195-less-token="-13-7"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-14-0">			</span><span class="token property" style="color:#36acaa" data-195-less-token="width-14-3">width</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-14-8">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-195-less-token="100-14-10">100</span><span class="token unit" data-195-less-token="%-14-13">%</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-14-14">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 图片宽度填满列宽 */</span><span class="token plain" data-195-less-token="-14-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-15-0">			</span><span class="token property" style="color:#36acaa" data-195-less-token="height-15-3">height</span><span class="token punctuation" style="color:#393A34" data-195-less-token=":-15-9">:</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34" data-195-less-token=";-15-15">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 保持图片宽高比 */</span><span class="token plain" data-195-less-token="-15-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-16-0">		</span><span class="token punctuation" style="color:#393A34" data-195-less-token="}-16-2">}</span><span class="token plain" data-195-less-token="-16-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-17-0">	</span><span class="token punctuation" style="color:#393A34" data-195-less-token="}-17-1">}</span><span class="token plain" data-195-less-token="-17-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-195-less-token="-18-0"></span><span class="token punctuation" style="color:#393A34" data-195-less-token="}-18-0">}</span></div></pre></div><h3 id="优缺点-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#优缺点-2"><span class="icon icon-link"></span></a>优缺点</h3><p><strong>优点</strong></p><ol><li><strong>简单实现</strong>：这种方法比较直观，可以通过计算每张图片的高度来动态调整布局。</li><li><strong>较好控制布局</strong>：通过这种方法可以精确控制每张图片在网格中的位置和大小，确保瀑布流的布局效果。</li><li><strong>响应式支持</strong>：这种方法在响应式设计中表现良好，可以根据不同的屏幕尺寸动态调整图片的排列方式。</li></ol><p><strong>缺点</strong></p><ol><li><strong>性能问题</strong>：在大量图片加载时，计算每张图片的高度会增加浏览器的计算量，可能会导致页面的性能下降，特别是在低性能设备上。</li><li><strong>布局抖动</strong>：在图片加载过程中，网格的高度会不断调整，可能会导致布局抖动（reflow），影响用户体验。</li><li><strong>延迟显示</strong>：由于需要等待图片加载完成才能计算高度，可能会导致图片显示延迟，用户在图片未加载完成时会看到空白区域或占位符。</li><li><strong>代码复杂度增加</strong>：实现这种布局需要编写额外的 JavaScript 代码来处理图片加载和高度计算，增加了代码的复杂度和维护成本。</li></ol><h2 id="4原生js封装实现"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#4原生js封装实现"><span class="icon icon-link"></span></a>4.原生js封装实现</h2><h3 id="效果-3"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#效果-3"><span class="icon icon-link"></span></a>效果</h3><p><a target="_blank" rel="noopener noreferrer" href="https://zhuling904.github.io/react_demo/?path=/story/%E9%80%9A%E7%94%A8-waterfall%E7%80%91%E5%B8%83%E6%B5%81--js-waterfall">在线体验demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><img src="https://cdn.jsdelivr.net/gh/ObjectX-9/DrawingBed/imgMac/%E5%8E%9F%E7%94%9Fjs.gif" alt="2024-05-18 14.25.56.gif"/></p><h3 id="原理-3"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#原理-3"><span class="icon icon-link"></span></a>原理</h3><p>先给每一个项目设置一个默认高度，使用一个数据记录每一列的高度，每次将新插入的图片放入高度最低的一列，重新计算该列高度。循环插入即可。</p><h3 id="代码-3"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#代码-3"><span class="icon icon-link"></span></a>代码</h3><h4 id="核心类实现"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#核心类实现"><span class="icon icon-link"></span></a>核心类实现</h4><p>其中实现了增量渲染、触底增加、动态渲染，</p><ul><li>动态渲染：主要是在图片加载完成后再加入容器</li><li>触底增加&amp;触底缓冲：主要根据滚动位置判断是否到底部了，如果到底部了，再次请求数据插入容器中，判断中增加一个缓冲高度，在用户即将触底之前提前请求，保证组件的流畅</li><li>增量渲染：主要是使用一个变量保存当前渲染到的节点的<code>index</code>，每次判断是否是新增，从当前渲染开始重新计算，仅计算新增的。</li></ul><p>触底更新代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 触底增加数据</span><span class="token plain" data-196-js-token="-0-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-1-0">	</span><span class="token keyword" style="color:#00009f" data-196-js-token="const-1-1">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-196-js-token="handScorllAddData-1-7">handScorllAddData</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-196-js-token="=-1-25">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-196-js-token="async-1-27">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-1-33">(</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-1-34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-196-js-token="=&gt;-1-36">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-196-js-token="{-1-39">{</span><span class="token plain" data-196-js-token="-1-40"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-2-0">		</span><span class="token keyword" style="color:#00009f" data-196-js-token="const-2-2">const</span><span class="token plain"> scrollTop </span><span class="token operator" style="color:#393A34" data-196-js-token="=-2-18">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-196-js-token="document-2-20">document</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-2-28">.</span><span class="token property-access" data-196-js-token="documentElement-2-29">documentElement</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-2-44">.</span><span class="token property-access" data-196-js-token="scrollTop-2-45">scrollTop</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-2-54">;</span><span class="token plain" data-196-js-token="-2-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-3-0">		</span><span class="token keyword" style="color:#00009f" data-196-js-token="const-3-2">const</span><span class="token plain"> clientHeight </span><span class="token operator" style="color:#393A34" data-196-js-token="=-3-21">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-196-js-token="document-3-23">document</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-3-31">.</span><span class="token property-access" data-196-js-token="documentElement-3-32">documentElement</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-3-47">.</span><span class="token property-access" data-196-js-token="clientHeight-3-48">clientHeight</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-3-60">;</span><span class="token plain" data-196-js-token="-3-61"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-4-0">		</span><span class="token keyword" style="color:#00009f" data-196-js-token="const-4-2">const</span><span class="token plain"> scrollHeight </span><span class="token operator" style="color:#393A34" data-196-js-token="=-4-21">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-196-js-token="document-4-23">document</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-4-31">.</span><span class="token property-access" data-196-js-token="body-4-32">body</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-4-36">.</span><span class="token property-access" data-196-js-token="scrollHeight-4-37">scrollHeight</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-4-49">;</span><span class="token plain" data-196-js-token="-4-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-5-0">		</span><span class="token keyword" style="color:#00009f" data-196-js-token="const-5-2">const</span><span class="token plain"> buffer </span><span class="token operator" style="color:#393A34" data-196-js-token="=-5-15">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-196-js-token="50-5-17">50</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-5-19">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 缓冲区距离</span><span class="token plain" data-196-js-token="-5-29"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-6-0">		</span><span class="token console class-name" data-196-js-token="console-6-2">console</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-6-9">.</span><span class="token method function property-access" style="color:#d73a49" data-196-js-token="log-6-10">log</span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-6-13">(</span><span class="token plain" data-196-js-token="-6-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-7-0">			</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-196-js-token="`-7-3">`</span><span class="token template-string string" style="color:#e3116c">Scroll Top: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="${-7-16">${</span><span class="token template-string interpolation" data-196-js-token="scrollTop-7-18">scrollTop</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="}-7-27">}</span><span class="token template-string string" style="color:#e3116c">, Client Height: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="${-7-45">${</span><span class="token template-string interpolation" data-196-js-token="clientHeight-7-47">clientHeight</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="}-7-59">}</span><span class="token template-string string" style="color:#e3116c">, Scroll Height: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="${-7-77">${</span><span class="token template-string interpolation" data-196-js-token="scrollHeight-7-79">scrollHeight</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-196-js-token="}-7-91">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-196-js-token="`-7-92">`</span><span class="token punctuation" style="color:#393A34" data-196-js-token=",-7-93">,</span><span class="token plain" data-196-js-token="-7-94"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-8-0">		</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-8-2">)</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-8-3">;</span><span class="token plain" data-196-js-token="-8-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-196-js-token="-9-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-10-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-196-js-token="if-10-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-10-5">(</span><span class="token plain">scrollTop </span><span class="token operator" style="color:#393A34" data-196-js-token="+-10-16">+</span><span class="token plain"> clientHeight </span><span class="token operator" style="color:#393A34" data-196-js-token="&gt;=-10-31">&gt;=</span><span class="token plain"> scrollHeight </span><span class="token operator" style="color:#393A34" data-196-js-token="--10-47">-</span><span class="token plain"> buffer </span><span class="token operator" style="color:#393A34" data-196-js-token="&amp;&amp;-10-56">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-196-js-token="!-10-59">!</span><span class="token plain" data-196-js-token="loading-10-60">loading</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-10-67">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-196-js-token="{-10-69">{</span><span class="token plain" data-196-js-token="-10-70"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">			loading </span><span class="token operator" style="color:#393A34" data-196-js-token="=-11-11">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa" data-196-js-token="true-11-13">true</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-11-17">;</span><span class="token plain" data-196-js-token="-11-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-12-0">			</span><span class="token console class-name" data-196-js-token="console-12-3">console</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-12-10">.</span><span class="token method function property-access" style="color:#d73a49" data-196-js-token="log-12-11">log</span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-12-14">(</span><span class="token string" style="color:#e3116c" data-196-js-token="&#x27;触底，开始加载数据...&#x27;-12-15">&#x27;触底，开始加载数据...&#x27;</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-12-29">)</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-12-30">;</span><span class="token plain" data-196-js-token="-12-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-13-0">			</span><span class="token keyword control-flow" style="color:#00009f" data-196-js-token="await-13-3">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-196-js-token="getData-13-9">getData</span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-13-16">(</span><span class="token number" style="color:#36acaa" data-196-js-token="5-13-17">5</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-13-18">)</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-13-19">;</span><span class="token plain" data-196-js-token="-13-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">			loading </span><span class="token operator" style="color:#393A34" data-196-js-token="=-14-11">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa" data-196-js-token="false-14-13">false</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-14-18">;</span><span class="token plain" data-196-js-token="-14-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-15-0">			</span><span class="token console class-name" data-196-js-token="console-15-3">console</span><span class="token punctuation" style="color:#393A34" data-196-js-token=".-15-10">.</span><span class="token method function property-access" style="color:#d73a49" data-196-js-token="log-15-11">log</span><span class="token punctuation" style="color:#393A34" data-196-js-token="(-15-14">(</span><span class="token string" style="color:#e3116c" data-196-js-token="&#x27;数据加载完成&#x27;-15-15">&#x27;数据加载完成&#x27;</span><span class="token punctuation" style="color:#393A34" data-196-js-token=")-15-23">)</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-15-24">;</span><span class="token plain" data-196-js-token="-15-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-16-0">		</span><span class="token punctuation" style="color:#393A34" data-196-js-token="}-16-2">}</span><span class="token plain" data-196-js-token="-16-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-196-js-token="-17-0">	</span><span class="token punctuation" style="color:#393A34" data-196-js-token="}-17-1">}</span><span class="token punctuation" style="color:#393A34" data-196-js-token=";-17-2">;</span></div></pre></div><p>核心类完整代码</p><div class="__dumi-default-code-block"><pre class="prism-code language-js" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f" data-197-js-token="export-0-0">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="class-0-7">class</span><span class="token plain"> </span><span class="token class-name" data-197-js-token="WaterFall-0-13">WaterFall</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-0-23">{</span><span class="token plain" data-197-js-token="-0-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="gap-1-0">	gap</span><span class="token operator" style="color:#393A34" data-197-js-token=":-1-4">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-1-12">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 间距</span><span class="token plain" data-197-js-token="-1-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="container-2-0">	container</span><span class="token operator" style="color:#393A34" data-197-js-token=":-2-10">:</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLDivElement-2-12">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-2-26">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 容器</span><span class="token plain" data-197-js-token="-2-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="heightArr-3-0">	heightArr</span><span class="token operator" style="color:#393A34" data-197-js-token=":-3-10">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-3-18">[</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-3-19">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-3-20">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 保存每列的高度信息</span><span class="token plain" data-197-js-token="-3-34"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="items-4-0">	items</span><span class="token operator" style="color:#393A34" data-197-js-token=":-4-6">:</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLCollection-4-8">HTMLCollection</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-4-22">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 子节点</span><span class="token plain" data-197-js-token="-4-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="renderIndex-5-0">	renderIndex</span><span class="token operator" style="color:#393A34" data-197-js-token=":-5-12">:</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-5-20">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 保存已经渲染了的节点</span><span class="token plain" data-197-js-token="-5-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-6-0">	</span><span class="token function" style="color:#d73a49" data-197-js-token="constructor-6-1">constructor</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-6-12">(</span><span class="token parameter" data-197-js-token="container-6-13">container</span><span class="token parameter operator" style="color:#393A34" data-197-js-token=":-6-22">:</span><span class="token parameter"> HTMLDivElement</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token=",-6-38">,</span><span class="token parameter"> options</span><span class="token parameter operator" style="color:#393A34" data-197-js-token=":-6-47">:</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="{-6-49">{</span><span class="token parameter" data-197-js-token="gap-6-50">gap</span><span class="token parameter operator" style="color:#393A34" data-197-js-token=":-6-53">:</span><span class="token parameter"> number</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="}-6-61">}</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-6-62">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-6-64">{</span><span class="token plain" data-197-js-token="-6-65"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-7-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-7-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-7-6">.</span><span class="token property-access" data-197-js-token="gap-7-7">gap</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-7-11">=</span><span class="token plain"> options</span><span class="token operator" style="color:#393A34" data-197-js-token="?.-7-20">?.</span><span class="token plain">gap </span><span class="token operator" style="color:#393A34" data-197-js-token="??-7-26">??</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="0-7-29">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-7-30">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 间距</span><span class="token plain" data-197-js-token="-7-37"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-8-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-8-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-8-6">.</span><span class="token property-access" data-197-js-token="container-8-7">container</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-8-17">=</span><span class="token plain"> container</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-8-28">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 容器</span><span class="token plain" data-197-js-token="-8-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-9-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-9-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-9-6">.</span><span class="token property-access" data-197-js-token="heightArr-9-7">heightArr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-9-17">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-9-19">[</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-9-20">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-9-21">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 保存每列的高度信息</span><span class="token plain" data-197-js-token="-9-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-10-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-10-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-10-6">.</span><span class="token property-access" data-197-js-token="items-10-7">items</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-10-13">=</span><span class="token plain"> container</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-10-24">.</span><span class="token property-access" data-197-js-token="children-10-25">children</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-10-33">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 子节点</span><span class="token plain" data-197-js-token="-10-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-11-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-11-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-11-6">.</span><span class="token property-access" data-197-js-token="renderIndex-11-7">renderIndex</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-11-19">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="0-11-21">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-11-22">;</span><span class="token plain" data-197-js-token="-11-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-12-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-12-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-12-6">.</span><span class="token property-access" data-197-js-token="container-12-7">container</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-12-16">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="addEventListener-12-17">addEventListener</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-12-33">(</span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;resize&#x27;-12-34">&#x27;resize&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=",-12-42">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-12-44">(</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-12-45">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-197-js-token="=&gt;-12-47">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-12-50">{</span><span class="token plain" data-197-js-token="-12-51"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-13-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-13-3">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-13-7">.</span><span class="token property-access" data-197-js-token="heightArr-13-8">heightArr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-13-18">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-13-20">[</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-13-21">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-13-22">;</span><span class="token plain" data-197-js-token="-13-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-14-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-14-3">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-14-7">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="layout-14-8">layout</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-14-14">(</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-14-15">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-14-16">;</span><span class="token plain" data-197-js-token="-14-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-15-0">		</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-15-2">}</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-15-3">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-15-4">;</span><span class="token plain" data-197-js-token="-15-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-16-0">		</span><span class="token comment" style="color:#999988;font-style:italic">// 监听节点生成和卸载</span><span class="token plain" data-197-js-token="-16-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-17-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-17-2">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-17-6">.</span><span class="token property-access" data-197-js-token="container-17-7">container</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-17-16">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="addEventListener-17-17">addEventListener</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-17-33">(</span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;DOMSubtreeModified&#x27;-17-34">&#x27;DOMSubtreeModified&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=",-17-54">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-17-56">(</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-17-57">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34" data-197-js-token="=&gt;-17-59">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-17-62">{</span><span class="token plain" data-197-js-token="-17-63"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-18-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-18-3">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-18-7">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="layout-18-8">layout</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-18-14">(</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-18-15">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-18-16">;</span><span class="token plain" data-197-js-token="-18-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-19-0">		</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-19-2">}</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-19-3">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-19-4">;</span><span class="token plain" data-197-js-token="-19-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-20-0">	</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-20-1">}</span><span class="token plain" data-197-js-token="-20-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-21-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-22-0">	</span><span class="token function" style="color:#d73a49" data-197-js-token="getMaxHeight-22-1">getMaxHeight</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-22-13">(</span><span class="token parameter" data-197-js-token="heightArr-22-14">heightArr</span><span class="token parameter operator" style="color:#393A34" data-197-js-token=":-22-23">:</span><span class="token parameter"> number</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="[-22-31">[</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="]-22-32">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-22-33">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-22-35">{</span><span class="token plain" data-197-js-token="-22-36"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-23-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-23-2">let</span><span class="token plain"> maxHeight </span><span class="token operator" style="color:#393A34" data-197-js-token="=-23-16">=</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-23-27">[</span><span class="token number" style="color:#36acaa" data-197-js-token="0-23-28">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-23-29">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-23-30">;</span><span class="token plain" data-197-js-token="-23-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-24-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="for-24-2">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-24-6">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-24-7">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-197-js-token="=-24-13">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="1-24-15">1</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-24-16">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-197-js-token="&lt;-24-20">&lt;</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-24-31">.</span><span class="token property-access" data-197-js-token="length-24-32">length</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-24-38">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34" data-197-js-token="++-24-41">++</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-24-43">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-24-45">{</span><span class="token plain" data-197-js-token="-24-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-25-0">			</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="if-25-3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-25-6">(</span><span class="token plain" data-197-js-token="heightArr-25-7">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-25-16">[</span><span class="token plain" data-197-js-token="i-25-17">i</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-25-18">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="&gt;-25-20">&gt;</span><span class="token plain"> maxHeight</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-25-31">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-25-33">{</span><span class="token plain" data-197-js-token="-25-34"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				maxHeight </span><span class="token operator" style="color:#393A34" data-197-js-token="=-26-14">=</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-26-25">[</span><span class="token plain" data-197-js-token="i-26-26">i</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-26-27">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-26-28">;</span><span class="token plain" data-197-js-token="-26-29"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-27-0">			</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-27-3">}</span><span class="token plain" data-197-js-token="-27-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-28-0">		</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-28-2">}</span><span class="token plain" data-197-js-token="-28-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-29-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="return-29-2">return</span><span class="token plain"> maxHeight</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-29-18">;</span><span class="token plain" data-197-js-token="-29-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-30-0">	</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-30-1">}</span><span class="token plain" data-197-js-token="-30-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-31-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-32-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 计算高度最小的列</span><span class="token plain" data-197-js-token="-32-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-33-0">	</span><span class="token function" style="color:#d73a49" data-197-js-token="getMinIndex-33-1">getMinIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-33-12">(</span><span class="token parameter" data-197-js-token="heightArr-33-13">heightArr</span><span class="token parameter operator" style="color:#393A34" data-197-js-token=":-33-22">:</span><span class="token parameter"> number</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="[-33-30">[</span><span class="token parameter punctuation" style="color:#393A34" data-197-js-token="]-33-31">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-33-32">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-33-34">{</span><span class="token plain" data-197-js-token="-33-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-34-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-34-2">let</span><span class="token plain"> minIndex </span><span class="token operator" style="color:#393A34" data-197-js-token="=-34-15">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="0-34-17">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-34-18">;</span><span class="token plain" data-197-js-token="-34-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-35-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-35-2">let</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34" data-197-js-token="=-35-10">=</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-35-21">[</span><span class="token plain" data-197-js-token="minIndex-35-22">minIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-35-30">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-35-31">;</span><span class="token plain" data-197-js-token="-35-32"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-36-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="for-36-2">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-36-6">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-36-7">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-197-js-token="=-36-13">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="1-36-15">1</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-36-16">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-197-js-token="&lt;-36-20">&lt;</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-36-31">.</span><span class="token property-access" data-197-js-token="length-36-32">length</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-36-38">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34" data-197-js-token="++-36-41">++</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-36-43">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-36-45">{</span><span class="token plain" data-197-js-token="-36-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-37-0">			</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="if-37-3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-37-6">(</span><span class="token plain" data-197-js-token="heightArr-37-7">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-37-16">[</span><span class="token plain" data-197-js-token="i-37-17">i</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-37-18">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="&lt;-37-20">&lt;</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-37-25">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-37-27">{</span><span class="token plain" data-197-js-token="-37-28"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				min </span><span class="token operator" style="color:#393A34" data-197-js-token="=-38-8">=</span><span class="token plain"> heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-38-19">[</span><span class="token plain" data-197-js-token="i-38-20">i</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-38-21">]</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-38-22">;</span><span class="token plain" data-197-js-token="-38-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				minIndex </span><span class="token operator" style="color:#393A34" data-197-js-token="=-39-13">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-39-16">;</span><span class="token plain" data-197-js-token="-39-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-40-0">			</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-40-3">}</span><span class="token plain" data-197-js-token="-40-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-41-0">		</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-41-2">}</span><span class="token plain" data-197-js-token="-41-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-42-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="return-42-2">return</span><span class="token plain"> minIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-42-17">;</span><span class="token plain" data-197-js-token="-42-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-43-0">	</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-43-1">}</span><span class="token plain" data-197-js-token="-43-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-44-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-45-0">	</span><span class="token function" style="color:#d73a49" data-197-js-token="layout-45-1">layout</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-45-7">(</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-45-8">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-45-10">{</span><span class="token plain" data-197-js-token="-45-11"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-46-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="if-46-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-46-5">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-46-6">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-46-10">.</span><span class="token property-access" data-197-js-token="items-46-11">items</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-46-16">.</span><span class="token property-access" data-197-js-token="length-46-17">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="===-46-24">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="0-46-28">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-46-29">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="return-46-31">return</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-46-37">;</span><span class="token plain" data-197-js-token="-46-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-47-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-47-2">const</span><span class="token plain"> gap </span><span class="token operator" style="color:#393A34" data-197-js-token="=-47-12">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-47-14">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-47-18">.</span><span class="token property-access" data-197-js-token="gap-47-19">gap</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-47-22">;</span><span class="token plain" data-197-js-token="-47-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-48-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-48-2">const</span><span class="token plain"> pageWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="=-48-18">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-48-20">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-48-24">.</span><span class="token property-access" data-197-js-token="container-48-25">container</span><span class="token operator" style="color:#393A34" data-197-js-token="?.-48-34">?.</span><span class="token plain">offsetWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="||-48-48">||</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="1000-48-51">1000</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-48-55">;</span><span class="token plain" data-197-js-token="-48-56"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-49-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-49-2">const</span><span class="token plain"> itemWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="=-49-18">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-49-20">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-49-21">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-49-25">.</span><span class="token property-access" data-197-js-token="items-49-26">items</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-49-31">[</span><span class="token number" style="color:#36acaa" data-197-js-token="0-49-32">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-49-33">]</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-197-js-token="as-49-35">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLDivElement-49-38">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-49-52">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-49-53">.</span><span class="token property-access" data-197-js-token="offsetWidth-49-54">offsetWidth</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-49-65">;</span><span class="token plain" data-197-js-token="-49-66"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-50-0">		</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-50-2">const</span><span class="token plain"> columns </span><span class="token operator" style="color:#393A34" data-197-js-token="=-50-16">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-197-js-token="Math-50-18">Math</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-50-22">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="ceil-50-23">ceil</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-50-27">(</span><span class="token plain">pageWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="/-50-38">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-50-40">(</span><span class="token plain">itemWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="+-50-51">+</span><span class="token plain"> gap</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-50-56">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-50-57">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="??-50-59">??</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="5-50-62">5</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-50-63">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 总共有多少列</span><span class="token plain" data-197-js-token="-50-74"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-51-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-52-0">		</span><span class="token comment" style="color:#999988;font-style:italic">// 增量加载</span><span class="token plain" data-197-js-token="-52-9"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-53-0">		</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="while-53-2">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-53-8">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-53-9">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-53-13">.</span><span class="token property-access" data-197-js-token="renderIndex-53-14">renderIndex</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="&lt;-53-26">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-53-28">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-53-32">.</span><span class="token property-access" data-197-js-token="items-53-33">items</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-53-38">.</span><span class="token property-access" data-197-js-token="length-53-39">length</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-53-45">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-53-47">{</span><span class="token plain" data-197-js-token="-53-48"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-54-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="let-54-3">let</span><span class="token plain"> top</span><span class="token punctuation" style="color:#393A34" data-197-js-token=",-54-10">,</span><span class="token plain"> left</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-54-16">;</span><span class="token plain" data-197-js-token="-54-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-55-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-55-3">const</span><span class="token plain"> curItem </span><span class="token operator" style="color:#393A34" data-197-js-token="=-55-17">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-55-19">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-55-23">.</span><span class="token property-access" data-197-js-token="items-55-24">items</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-55-29">[</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-55-30">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-55-34">.</span><span class="token property-access" data-197-js-token="renderIndex-55-35">renderIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-55-46">]</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-197-js-token="as-55-48">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLDivElement-55-51">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-55-65">;</span><span class="token plain" data-197-js-token="-55-66"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-56-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-56-3">const</span><span class="token plain"> curImgItem </span><span class="token operator" style="color:#393A34" data-197-js-token="=-56-20">=</span><span class="token plain"> curItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-56-29">.</span><span class="token property-access" data-197-js-token="children-56-30">children</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-56-38">[</span><span class="token number" style="color:#36acaa" data-197-js-token="0-56-39">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-56-40">]</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-197-js-token="as-56-42">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLImageElement-56-45">HTMLImageElement</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-56-61">;</span><span class="token plain" data-197-js-token="-56-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-57-0">			</span><span class="token comment" style="color:#999988;font-style:italic">// 之前插入的时候我们给item设置了默认值，这我们需要将图片高度设置给item</span><span class="token plain" data-197-js-token="-57-44"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="curItem-58-0">			curItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-58-10">.</span><span class="token property-access" data-197-js-token="style-58-11">style</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-58-16">.</span><span class="token property-access" data-197-js-token="height-58-17">height</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-58-24">=</span><span class="token plain"> curImgItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-58-36">.</span><span class="token property-access" data-197-js-token="offsetHeight-58-37">offsetHeight</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="+-58-50">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;px&#x27;-58-52">&#x27;px&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-58-56">;</span><span class="token plain" data-197-js-token="-58-57"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="curItem-59-0">			curItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-59-10">.</span><span class="token property-access" data-197-js-token="style-59-11">style</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-59-16">.</span><span class="token property-access" data-197-js-token="width-59-17">width</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-59-23">=</span><span class="token plain"> curImgItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-59-35">.</span><span class="token property-access" data-197-js-token="offsetWidth-59-36">offsetWidth</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="+-59-48">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;px&#x27;-59-50">&#x27;px&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-59-54">;</span><span class="token plain" data-197-js-token="-59-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-60-0">			</span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="if-60-3">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-60-6">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-60-7">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-60-11">.</span><span class="token property-access" data-197-js-token="renderIndex-60-12">renderIndex</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="&lt;-60-24">&lt;</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-60-33">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-60-35">{</span><span class="token plain" data-197-js-token="-60-36"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-61-0">				</span><span class="token comment" style="color:#999988;font-style:italic">// 第一列</span><span class="token plain" data-197-js-token="-61-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				top </span><span class="token operator" style="color:#393A34" data-197-js-token="=-62-8">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-197-js-token="0-62-10">0</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-62-11">;</span><span class="token plain" data-197-js-token="-62-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				left </span><span class="token operator" style="color:#393A34" data-197-js-token="=-63-9">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-63-11">(</span><span class="token plain">itemWidth </span><span class="token operator" style="color:#393A34" data-197-js-token="+-63-22">+</span><span class="token plain"> gap</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-63-27">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="*-63-29">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-63-31">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-63-35">.</span><span class="token property-access" data-197-js-token="renderIndex-63-36">renderIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-63-47">;</span><span class="token plain" data-197-js-token="-63-48"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-64-0">				</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-64-4">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-64-8">.</span><span class="token property-access" data-197-js-token="heightArr-64-9">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-64-18">[</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-64-19">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-64-23">.</span><span class="token property-access" data-197-js-token="renderIndex-64-24">renderIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-64-35">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-64-37">=</span><span class="token plain"> curImgItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-64-49">.</span><span class="token property-access" data-197-js-token="offsetHeight-64-50">offsetHeight</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-64-62">;</span><span class="token plain" data-197-js-token="-64-63"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-65-0">			</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-65-3">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f" data-197-js-token="else-65-5">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-197-js-token="{-65-10">{</span><span class="token plain" data-197-js-token="-65-11"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-66-0">				</span><span class="token comment" style="color:#999988;font-style:italic">// 找到高度最小的一列</span><span class="token plain" data-197-js-token="-66-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-67-0">				</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-67-4">const</span><span class="token plain"> minIndex </span><span class="token operator" style="color:#393A34" data-197-js-token="=-67-19">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-67-21">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-67-25">.</span><span class="token method function property-access" style="color:#d73a49" data-197-js-token="getMinIndex-67-26">getMinIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="(-67-37">(</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-67-38">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-67-42">.</span><span class="token property-access" data-197-js-token="heightArr-67-43">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token=")-67-52">)</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-67-53">;</span><span class="token plain" data-197-js-token="-67-54"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-68-0">				</span><span class="token comment" style="color:#999988;font-style:italic">// 属于那一列，获取第一个元素，要获取left</span><span class="token plain" data-197-js-token="-68-28"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-69-0">				</span><span class="token keyword" style="color:#00009f" data-197-js-token="const-69-4">const</span><span class="token plain"> whichColumnFirstItem </span><span class="token operator" style="color:#393A34" data-197-js-token="=-69-31">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-69-33">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-69-37">.</span><span class="token property-access" data-197-js-token="items-69-38">items</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-69-43">[</span><span class="token plain" data-197-js-token="minIndex-69-44">minIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-69-52">]</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f" data-197-js-token="as-69-54">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-197-js-token="HTMLDivElement-69-57">HTMLDivElement</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-69-71">;</span><span class="token plain" data-197-js-token="-69-72"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-70-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">				top </span><span class="token operator" style="color:#393A34" data-197-js-token="=-71-8">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-197-js-token="this-71-10">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-71-14">.</span><span class="token property-access" data-197-js-token="heightArr-71-15">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-71-24">[</span><span class="token plain" data-197-js-token="minIndex-71-25">minIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-71-33">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="+-71-35">+</span><span class="token plain"> gap</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-71-40">;</span><span class="token plain" data-197-js-token="-71-41"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">				left </span><span class="token operator" style="color:#393A34" data-197-js-token="=-72-9">=</span><span class="token plain"> whichColumnFirstItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-72-31">.</span><span class="token property-access" data-197-js-token="offsetLeft-72-32">offsetLeft</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-72-42">;</span><span class="token plain" data-197-js-token="-72-43"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-73-0">				</span><span class="token comment" style="color:#999988;font-style:italic">// 重新计算当前插入列的高度</span><span class="token plain" data-197-js-token="-73-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-74-0">				</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-74-4">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-74-8">.</span><span class="token property-access" data-197-js-token="heightArr-74-9">heightArr</span><span class="token punctuation" style="color:#393A34" data-197-js-token="[-74-18">[</span><span class="token plain" data-197-js-token="minIndex-74-19">minIndex</span><span class="token punctuation" style="color:#393A34" data-197-js-token="]-74-27">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="+=-74-29">+=</span><span class="token plain"> curImgItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-74-42">.</span><span class="token property-access" data-197-js-token="offsetHeight-74-43">offsetHeight</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="+-74-56">+</span><span class="token plain"> gap</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-74-61">;</span><span class="token plain" data-197-js-token="-74-62"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-75-0">			</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-75-3">}</span><span class="token plain" data-197-js-token="-75-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-197-js-token="-76-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="curItem-77-0">			curItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-77-10">.</span><span class="token property-access" data-197-js-token="style-77-11">style</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-77-16">.</span><span class="token property-access" data-197-js-token="top-77-17">top</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-77-21">=</span><span class="token plain"> top </span><span class="token operator" style="color:#393A34" data-197-js-token="+-77-27">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;px&#x27;-77-29">&#x27;px&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-77-33">;</span><span class="token plain" data-197-js-token="-77-34"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="curItem-78-0">			curItem</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-78-10">.</span><span class="token property-access" data-197-js-token="style-78-11">style</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-78-16">.</span><span class="token property-access" data-197-js-token="left-78-17">left</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-197-js-token="=-78-22">=</span><span class="token plain"> left </span><span class="token operator" style="color:#393A34" data-197-js-token="+-78-29">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-197-js-token="&#x27;px&#x27;-78-31">&#x27;px&#x27;</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-78-35">;</span><span class="token plain" data-197-js-token="-78-36"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-79-0">			</span><span class="token keyword" style="color:#00009f" data-197-js-token="this-79-3">this</span><span class="token punctuation" style="color:#393A34" data-197-js-token=".-79-7">.</span><span class="token property-access" data-197-js-token="renderIndex-79-8">renderIndex</span><span class="token operator" style="color:#393A34" data-197-js-token="++-79-19">++</span><span class="token punctuation" style="color:#393A34" data-197-js-token=";-79-21">;</span><span class="token plain" data-197-js-token="-79-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-80-0">		</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-80-2">}</span><span class="token plain" data-197-js-token="-80-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-81-0">	</span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-81-1">}</span><span class="token plain" data-197-js-token="-81-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-197-js-token="-82-0"></span><span class="token punctuation" style="color:#393A34" data-197-js-token="}-82-0">}</span></div></pre></div><h4 id="indextsx-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indextsx-2"><span class="icon icon-link"></span></a>index.tsx</h4><div class="__dumi-default-code-block"><pre class="prism-code language-tsx" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-0-0">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="jsTypeRender-0-6">jsTypeRender</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-0-19">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-0-21">(</span><span class="token parameter" data-198-tsx-token="options-0-22">options</span><span class="token parameter operator" style="color:#393A34" data-198-tsx-token=":-0-29">:</span><span class="token parameter"> WaterfallProps</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-0-45">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-0-47">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-0-50">{</span><span class="token plain" data-198-tsx-token="-0-51"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-1-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="let-1-1">let</span><span class="token plain"> loading </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-1-13">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa" data-198-tsx-token="false-1-15">false</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-1-20">;</span><span class="token plain" data-198-tsx-token="-1-21"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-2-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-2-1">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-2-7">{</span><span class="token plain">items </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-2-14">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-2-16">[</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-2-17">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-2-18">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-2-20">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-2-29">;</span><span class="token plain" data-198-tsx-token="-2-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-3-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-3-1">const</span><span class="token plain"> jsContainer </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-3-19">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49" data-198-tsx-token="useRef-3-21">useRef</span><span class="token generic-function generic class-name operator" style="color:#393A34" data-198-tsx-token="&lt;-3-27">&lt;</span><span class="token generic-function generic class-name maybe-class-name" data-198-tsx-token="HTMLDivElement-3-28">HTMLDivElement</span><span class="token generic-function generic class-name operator" style="color:#393A34" data-198-tsx-token="&gt;-3-42">&gt;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-3-43">(</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="null-3-44">null</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-3-48">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-3-49">;</span><span class="token plain" data-198-tsx-token="-3-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-4-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-5-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 获取1-400之间的任意高度</span><span class="token plain" data-198-tsx-token="-5-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-6-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-6-1">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="getRandomHeight-6-7">getRandomHeight</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-6-23">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-6-25">(</span><span class="token parameter">min </span><span class="token parameter operator" style="color:#393A34" data-198-tsx-token="=-6-30">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-198-tsx-token="1-6-32">1</span><span class="token parameter punctuation" style="color:#393A34" data-198-tsx-token=",-6-33">,</span><span class="token parameter"> max </span><span class="token parameter operator" style="color:#393A34" data-198-tsx-token="=-6-39">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-198-tsx-token="4-6-41">4</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-6-42">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-6-44">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-6-47">{</span><span class="token plain" data-198-tsx-token="-6-48"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-7-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-7-2">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-7-9">(</span><span class="token known-class-name class-name" data-198-tsx-token="Math-7-10">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-7-14">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="floor-7-15">floor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-7-20">(</span><span class="token known-class-name class-name" data-198-tsx-token="Math-7-21">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-7-25">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="random-7-26">random</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-7-32">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-7-33">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="*-7-35">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-7-37">(</span><span class="token plain">max </span><span class="token operator" style="color:#393A34" data-198-tsx-token="--7-42">-</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-7-48">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="1-7-50">1</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-7-51">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-7-52">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-7-54">+</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-7-59">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="*-7-61">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="100-7-63">100</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-7-66">;</span><span class="token plain" data-198-tsx-token="-7-67"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-8-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-8-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-8-2">;</span><span class="token plain" data-198-tsx-token="-8-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-9-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-10-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 生成随机的柔和颜色</span><span class="token plain" data-198-tsx-token="-10-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-11-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-11-1">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="getRandomColor-11-7">getRandomColor</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-11-22">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-11-24">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-11-25">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-11-27">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-11-30">{</span><span class="token plain" data-198-tsx-token="-11-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-12-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-12-2">const</span><span class="token plain"> hue </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-12-12">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-198-tsx-token="Math-12-14">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-12-18">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="floor-12-19">floor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-12-24">(</span><span class="token known-class-name class-name" data-198-tsx-token="Math-12-25">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-12-29">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="random-12-30">random</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-12-36">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-12-37">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="*-12-39">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="360-12-41">360</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-12-44">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-12-45">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 0到360度</span><span class="token plain" data-198-tsx-token="-12-56"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-13-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-13-2">const</span><span class="token plain"> saturation </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-13-19">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-198-tsx-token="Math-13-21">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-13-25">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="floor-13-26">floor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-13-31">(</span><span class="token known-class-name class-name" data-198-tsx-token="Math-13-32">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-13-36">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="random-13-37">random</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-13-43">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-13-44">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="*-13-46">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="20-13-48">20</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-13-50">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-13-52">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="70-13-54">70</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-13-56">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 70%到90%的饱和度</span><span class="token plain" data-198-tsx-token="-13-72"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-14-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-14-2">const</span><span class="token plain"> lightness </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-14-18">=</span><span class="token plain"> </span><span class="token known-class-name class-name" data-198-tsx-token="Math-14-20">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-14-24">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="floor-14-25">floor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-14-30">(</span><span class="token known-class-name class-name" data-198-tsx-token="Math-14-31">Math</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-14-35">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="random-14-36">random</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-14-42">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-14-43">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="*-14-45">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="20-14-47">20</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-14-49">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-14-51">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="70-14-53">70</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-14-55">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 70%到90%的亮度</span><span class="token plain" data-198-tsx-token="-14-70"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-15-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-15-2">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-15-9">`</span><span class="token template-string string" style="color:#e3116c" data-198-tsx-token="hsl(-15-10">hsl(</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-15-14">${</span><span class="token template-string interpolation" data-198-tsx-token="hue-15-16">hue</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-15-19">}</span><span class="token template-string string" style="color:#e3116c">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-15-22">${</span><span class="token template-string interpolation" data-198-tsx-token="saturation-15-24">saturation</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-15-34">}</span><span class="token template-string string" style="color:#e3116c">%, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-15-38">${</span><span class="token template-string interpolation" data-198-tsx-token="lightness-15-40">lightness</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-15-49">}</span><span class="token template-string string" style="color:#e3116c" data-198-tsx-token="%)-15-50">%)</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-15-52">`</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-15-53">;</span><span class="token plain" data-198-tsx-token="-15-54"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-16-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-16-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-16-2">;</span><span class="token plain" data-198-tsx-token="-16-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-17-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-18-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 模拟异步请求数据</span><span class="token plain" data-198-tsx-token="-18-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-19-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="async-19-1">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="function-19-7">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="getData-19-16">getData</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-19-23">(</span><span class="token parameter">num </span><span class="token parameter operator" style="color:#393A34" data-198-tsx-token="=-19-28">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa" data-198-tsx-token="5-19-30">5</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-19-31">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-19-33">{</span><span class="token plain" data-198-tsx-token="-19-34"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-20-0">		</span><span class="token builtin" data-198-tsx-token="console-20-2">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-20-9">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="log-20-10">log</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-20-13">(</span><span class="token string" style="color:#e3116c">&#x27;✅ ~ 请求数据num:&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-20-28">,</span><span class="token plain"> num</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-20-33">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-20-34">;</span><span class="token plain" data-198-tsx-token="-20-35"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-21-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-21-2">const</span><span class="token plain"> jsContainerNode </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-21-24">=</span><span class="token plain"> jsContainer</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-21-37">.</span><span class="token plain" data-198-tsx-token="current-21-38">current</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-21-45">;</span><span class="token plain" data-198-tsx-token="-21-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-22-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="if-22-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-22-5">(</span><span class="token plain">jsContainerNode </span><span class="token operator" style="color:#393A34" data-198-tsx-token="===-22-22">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="null-22-26">null</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-22-30">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-22-32">return</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-22-38">;</span><span class="token plain" data-198-tsx-token="-22-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-23-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-23-2">const</span><span class="token plain"> images </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-23-15">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-23-17">(</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="await-23-18">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="fetchRandomImage-23-24">fetchRandomImage</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-23-40">(</span><span class="token plain" data-198-tsx-token="num-23-41">num</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-23-44">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-23-45">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="as-23-47">as</span><span class="token plain"> </span><span class="token maybe-class-name" data-198-tsx-token="UnsplashImage-23-50">UnsplashImage</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-23-63">[</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-23-64">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-23-65">;</span><span class="token plain" data-198-tsx-token="-23-66"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-24-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="for-24-2">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-24-6">(</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="let-24-7">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-24-13">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="0-24-15">0</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-24-16">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34" data-198-tsx-token="&lt;-24-20">&lt;</span><span class="token plain"> images</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-24-28">.</span><span class="token plain" data-198-tsx-token="length-24-29">length</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-24-35">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34" data-198-tsx-token="++-24-38">++</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-24-40">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-24-42">{</span><span class="token plain" data-198-tsx-token="-24-43"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-25-0">			</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-25-3">const</span><span class="token plain"> div </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-25-13">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="document-25-15">document</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-25-23">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="createElement-25-24">createElement</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-25-37">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;div&#x27;-25-38">&#x27;div&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-25-43">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-25-44">;</span><span class="token plain" data-198-tsx-token="-25-45"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-26-0">			div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-26-6">.</span><span class="token plain">className </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-26-17">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-26-19">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-26-20">${</span><span class="token template-string interpolation" data-198-tsx-token="style-26-22">style</span><span class="token template-string interpolation punctuation" style="color:#393A34" data-198-tsx-token=".-26-27">.</span><span class="token template-string interpolation" data-198-tsx-token="jsItem-26-28">jsItem</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-26-34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-26-35">`</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-26-36">;</span><span class="token plain" data-198-tsx-token="-26-37"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-27-0">			</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-27-3">const</span><span class="token plain"> img </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-27-13">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="new-27-15">new</span><span class="token plain"> </span><span class="token class-name maybe-class-name" data-198-tsx-token="Image-27-19">Image</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-27-24">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-27-25">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-27-26">;</span><span class="token plain" data-198-tsx-token="-27-27"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="img-28-0">			img</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-28-6">.</span><span class="token plain">src </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-28-11">=</span><span class="token plain"> images</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-28-19">[</span><span class="token plain" data-198-tsx-token="i-28-20">i</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-28-21">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-28-22">.</span><span class="token plain" data-198-tsx-token="urls-28-23">urls</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-28-27">.</span><span class="token plain" data-198-tsx-token="full-28-28">full</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-28-32">;</span><span class="token plain" data-198-tsx-token="-28-33"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-29-0">			</span><span class="token comment" style="color:#999988;font-style:italic">// 等待图片加载完成，将图片依次插入到容器中</span><span class="token plain" data-198-tsx-token="-29-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="img-30-0">			img</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-30-6">.</span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="onload-30-7">onload</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-30-14">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-30-16">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-30-17">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-30-19">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-30-22">{</span><span class="token plain" data-198-tsx-token="-30-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-31-0">				</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-31-4">const</span><span class="token plain"> fragment </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-31-19">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="document-31-21">document</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-31-29">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="createDocumentFragment-31-30">createDocumentFragment</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-31-52">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-31-53">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-31-54">;</span><span class="token plain" data-198-tsx-token="-31-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-32-0">				div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-32-7">.</span><span class="token plain">className </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-32-18">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-32-20">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-32-21">${</span><span class="token template-string interpolation" data-198-tsx-token="style-32-23">style</span><span class="token template-string interpolation punctuation" style="color:#393A34" data-198-tsx-token=".-32-28">.</span><span class="token template-string interpolation" data-198-tsx-token="jsItem-32-29">jsItem</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-32-35">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-32-36">`</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-32-37">;</span><span class="token plain" data-198-tsx-token="-32-38"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-33-0">				div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-33-7">.</span><span class="token plain" data-198-tsx-token="style-33-8">style</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-33-13">.</span><span class="token plain">height </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-33-21">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="getRandomHeight-33-23">getRandomHeight</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-33-38">(</span><span class="token number" style="color:#36acaa" data-198-tsx-token="4-33-39">4</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-33-40">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="1-33-42">1</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-33-43">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-33-45">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;px&#x27;-33-47">&#x27;px&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-33-51">;</span><span class="token plain" data-198-tsx-token="-33-52"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-34-0">				div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-34-7">.</span><span class="token plain" data-198-tsx-token="style-34-8">style</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-34-13">.</span><span class="token plain">backgroundColor </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-34-30">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="getRandomColor-34-32">getRandomColor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-34-46">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-34-47">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-34-48">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 设置随机颜色</span><span class="token plain" data-198-tsx-token="-34-59"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-35-0">				div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-35-7">.</span><span class="token plain" data-198-tsx-token="style-35-8">style</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-35-13">.</span><span class="token plain">backgroundColor </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-35-30">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="getRandomColor-35-32">getRandomColor</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-35-46">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-35-47">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-35-48">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 设置随机颜色</span><span class="token plain" data-198-tsx-token="-35-59"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="div-36-0">				div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-36-7">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="appendChild-36-8">appendChild</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-36-19">(</span><span class="token plain" data-198-tsx-token="img-36-20">img</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-36-23">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-36-24">;</span><span class="token plain" data-198-tsx-token="-36-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="fragment-37-0">				fragment</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-37-12">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="appendChild-37-13">appendChild</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-37-24">(</span><span class="token plain" data-198-tsx-token="div-37-25">div</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-37-28">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-37-29">;</span><span class="token plain" data-198-tsx-token="-37-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="jsContainerNode-38-0">				jsContainerNode</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-38-19">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="appendChild-38-20">appendChild</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-38-31">(</span><span class="token plain" data-198-tsx-token="fragment-38-32">fragment</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-38-40">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-38-41">;</span><span class="token plain" data-198-tsx-token="-38-42"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-39-0">			</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-39-3">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-39-4">;</span><span class="token plain" data-198-tsx-token="-39-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="img-40-0">			img</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-40-6">.</span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="onerror-40-7">onerror</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-40-15">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-40-17">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-40-18">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-40-20">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-40-23">{</span><span class="token plain" data-198-tsx-token="-40-24"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-41-0">				</span><span class="token builtin" data-198-tsx-token="console-41-4">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-41-11">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="error-41-12">error</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-41-17">(</span><span class="token string" style="color:#e3116c">&#x27;Image failed to load&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-41-40">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-41-41">;</span><span class="token plain" data-198-tsx-token="-41-42"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-42-0">			</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-42-3">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-42-4">;</span><span class="token plain" data-198-tsx-token="-42-5"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-43-0">		</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-43-2">}</span><span class="token plain" data-198-tsx-token="-43-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-44-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-44-1">}</span><span class="token plain" data-198-tsx-token="-44-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-45-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-46-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 触底增加数据</span><span class="token plain" data-198-tsx-token="-46-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-47-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-47-1">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="handScorllAddData-47-7">handScorllAddData</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-47-25">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="async-47-27">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-47-33">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-47-34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-47-36">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-47-39">{</span><span class="token plain" data-198-tsx-token="-47-40"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-48-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-48-2">const</span><span class="token plain"> scrollTop </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-48-18">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="document-48-20">document</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-48-28">.</span><span class="token plain" data-198-tsx-token="documentElement-48-29">documentElement</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-48-44">.</span><span class="token plain" data-198-tsx-token="scrollTop-48-45">scrollTop</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-48-54">;</span><span class="token plain" data-198-tsx-token="-48-55"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-49-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-49-2">const</span><span class="token plain"> clientHeight </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-49-21">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="document-49-23">document</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-49-31">.</span><span class="token plain" data-198-tsx-token="documentElement-49-32">documentElement</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-49-47">.</span><span class="token plain" data-198-tsx-token="clientHeight-49-48">clientHeight</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-49-60">;</span><span class="token plain" data-198-tsx-token="-49-61"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-50-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-50-2">const</span><span class="token plain"> scrollHeight </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-50-21">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="document-50-23">document</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-50-31">.</span><span class="token plain" data-198-tsx-token="body-50-32">body</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-50-36">.</span><span class="token plain" data-198-tsx-token="scrollHeight-50-37">scrollHeight</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-50-49">;</span><span class="token plain" data-198-tsx-token="-50-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-51-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-51-2">const</span><span class="token plain"> buffer </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-51-15">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="50-51-17">50</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-51-19">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 缓冲区距离</span><span class="token plain" data-198-tsx-token="-51-29"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-52-0">		</span><span class="token builtin" data-198-tsx-token="console-52-2">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-52-9">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="log-52-10">log</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-52-13">(</span><span class="token plain" data-198-tsx-token="-52-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-53-0">			</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-53-3">`</span><span class="token template-string string" style="color:#e3116c">Scroll Top: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-53-16">${</span><span class="token template-string interpolation" data-198-tsx-token="scrollTop-53-18">scrollTop</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-53-27">}</span><span class="token template-string string" style="color:#e3116c">, Client Height: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-53-45">${</span><span class="token template-string interpolation" data-198-tsx-token="clientHeight-53-47">clientHeight</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-53-59">}</span><span class="token template-string string" style="color:#e3116c">, Scroll Height: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="${-53-77">${</span><span class="token template-string interpolation" data-198-tsx-token="scrollHeight-53-79">scrollHeight</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34" data-198-tsx-token="}-53-91">}</span><span class="token template-string template-punctuation string" style="color:#e3116c" data-198-tsx-token="`-53-92">`</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-53-93">,</span><span class="token plain" data-198-tsx-token="-53-94"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-54-0">		</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-54-2">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-54-3">;</span><span class="token plain" data-198-tsx-token="-54-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-55-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-56-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="if-56-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-56-5">(</span><span class="token plain">scrollTop </span><span class="token operator" style="color:#393A34" data-198-tsx-token="+-56-16">+</span><span class="token plain"> clientHeight </span><span class="token operator" style="color:#393A34" data-198-tsx-token="&gt;=-56-31">&gt;=</span><span class="token plain"> scrollHeight </span><span class="token operator" style="color:#393A34" data-198-tsx-token="--56-47">-</span><span class="token plain"> buffer </span><span class="token operator" style="color:#393A34" data-198-tsx-token="&amp;&amp;-56-56">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="!-56-59">!</span><span class="token plain" data-198-tsx-token="loading-56-60">loading</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-56-67">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-56-69">{</span><span class="token plain" data-198-tsx-token="-56-70"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">			loading </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-57-11">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa" data-198-tsx-token="true-57-13">true</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-57-17">;</span><span class="token plain" data-198-tsx-token="-57-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-58-0">			</span><span class="token builtin" data-198-tsx-token="console-58-3">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-58-10">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="log-58-11">log</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-58-14">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;触底，开始加载数据...&#x27;-58-15">&#x27;触底，开始加载数据...&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-58-29">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-58-30">;</span><span class="token plain" data-198-tsx-token="-58-31"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-59-0">			</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="await-59-3">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-198-tsx-token="getData-59-9">getData</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-59-16">(</span><span class="token number" style="color:#36acaa" data-198-tsx-token="5-59-17">5</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-59-18">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-59-19">;</span><span class="token plain" data-198-tsx-token="-59-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">			loading </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-60-11">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa" data-198-tsx-token="false-60-13">false</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-60-18">;</span><span class="token plain" data-198-tsx-token="-60-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-61-0">			</span><span class="token builtin" data-198-tsx-token="console-61-3">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-61-10">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="log-61-11">log</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-61-14">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;数据加载完成&#x27;-61-15">&#x27;数据加载完成&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-61-23">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-61-24">;</span><span class="token plain" data-198-tsx-token="-61-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-62-0">		</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-62-2">}</span><span class="token plain" data-198-tsx-token="-62-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-63-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-63-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-63-2">;</span><span class="token plain" data-198-tsx-token="-63-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-64-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-65-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 先获取20条数据</span><span class="token plain" data-198-tsx-token="-65-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-66-0">	</span><span class="token function" style="color:#d73a49" data-198-tsx-token="useEffect-66-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-66-10">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-66-11">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-66-12">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-66-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-66-17">{</span><span class="token plain" data-198-tsx-token="-66-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-67-0">		</span><span class="token function" style="color:#d73a49" data-198-tsx-token="getData-67-2">getData</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-67-9">(</span><span class="token number" style="color:#36acaa" data-198-tsx-token="20-67-10">20</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-67-12">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-67-13">;</span><span class="token plain" data-198-tsx-token="-67-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-68-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-68-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-68-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-68-4">[</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-68-5">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-68-6">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-68-7">;</span><span class="token plain" data-198-tsx-token="-68-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-69-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-70-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 渲染绘制</span><span class="token plain" data-198-tsx-token="-70-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-71-0">	</span><span class="token function" style="color:#d73a49" data-198-tsx-token="useEffect-71-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-71-10">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-71-11">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-71-12">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-71-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-71-17">{</span><span class="token plain" data-198-tsx-token="-71-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-72-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-72-2">const</span><span class="token plain"> jsContainerNode </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-72-24">=</span><span class="token plain"> jsContainer</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-72-37">.</span><span class="token plain" data-198-tsx-token="current-72-38">current</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-72-45">;</span><span class="token plain" data-198-tsx-token="-72-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-73-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="if-73-2">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-73-5">(</span><span class="token plain">jsContainerNode </span><span class="token operator" style="color:#393A34" data-198-tsx-token="===-73-22">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="null-73-26">null</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-73-30">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-73-32">return</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-73-38">;</span><span class="token plain" data-198-tsx-token="-73-39"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-74-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-74-2">const</span><span class="token plain"> water </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-74-14">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f" data-198-tsx-token="new-74-16">new</span><span class="token plain"> </span><span class="token class-name maybe-class-name" data-198-tsx-token="WaterFall-74-20">WaterFall</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-74-29">(</span><span class="token plain" data-198-tsx-token="jsContainerNode-74-30">jsContainerNode</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-74-45">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-74-47">{</span><span class="token plain" data-198-tsx-token="gap-74-48">gap</span><span class="token operator" style="color:#393A34" data-198-tsx-token=":-74-51">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-198-tsx-token="10-74-53">10</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-74-55">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-74-56">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-74-57">;</span><span class="token plain" data-198-tsx-token="-74-58"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="water-75-0">		water</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-75-7">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="layout-75-8">layout</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-75-14">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-75-15">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-75-16">;</span><span class="token plain" data-198-tsx-token="-75-17"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-76-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-76-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-76-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-76-4">[</span><span class="token plain" data-198-tsx-token="items-76-5">items</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-76-10">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-76-11">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-76-12">;</span><span class="token plain" data-198-tsx-token="-76-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-77-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-78-0">	</span><span class="token comment" style="color:#999988;font-style:italic">// 触底增加</span><span class="token plain" data-198-tsx-token="-78-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-79-0">	</span><span class="token function" style="color:#d73a49" data-198-tsx-token="useEffect-79-1">useEffect</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-79-10">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-79-11">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-79-12">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-79-14">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-79-17">{</span><span class="token plain" data-198-tsx-token="-79-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-80-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="const-80-2">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49" data-198-tsx-token="onScroll-80-8">onScroll</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=-80-17">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-80-19">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-80-20">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-80-22">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-80-25">{</span><span class="token plain" data-198-tsx-token="-80-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-81-0">			</span><span class="token builtin" data-198-tsx-token="console-81-3">console</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-81-10">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="log-81-11">log</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-81-14">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;滚动事件触发&#x27;-81-15">&#x27;滚动事件触发&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-81-23">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-81-24">;</span><span class="token plain" data-198-tsx-token="-81-25"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-82-0">			</span><span class="token function" style="color:#d73a49" data-198-tsx-token="handScorllAddData-82-3">handScorllAddData</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-82-20">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-82-21">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-82-22">;</span><span class="token plain" data-198-tsx-token="-82-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-83-0">		</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-83-2">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-83-3">;</span><span class="token plain" data-198-tsx-token="-83-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-84-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-85-0">		</span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="window-85-2">window</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-85-8">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="addEventListener-85-9">addEventListener</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-85-25">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;scroll&#x27;-85-26">&#x27;scroll&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-85-34">,</span><span class="token plain"> onScroll</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-85-44">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-85-45">;</span><span class="token plain" data-198-tsx-token="-85-46"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-86-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-87-0">		</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-87-2">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-87-9">(</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-87-10">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34" data-198-tsx-token="=&gt;-87-12">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="{-87-15">{</span><span class="token plain" data-198-tsx-token="-87-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-88-0">			</span><span class="token dom variable" style="color:#36acaa" data-198-tsx-token="window-88-3">window</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=".-88-9">.</span><span class="token function" style="color:#d73a49" data-198-tsx-token="removeEventListener-88-10">removeEventListener</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="(-88-29">(</span><span class="token string" style="color:#e3116c" data-198-tsx-token="&#x27;scroll&#x27;-88-30">&#x27;scroll&#x27;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-88-38">,</span><span class="token plain"> onScroll</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-88-48">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-88-49">;</span><span class="token plain" data-198-tsx-token="-88-50"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-89-0">		</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-89-2">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-89-3">;</span><span class="token plain" data-198-tsx-token="-89-4"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-90-0">	</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-90-1">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=",-90-2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="[-90-4">[</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="]-90-5">]</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=")-90-6">)</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-90-7">;</span><span class="token plain" data-198-tsx-token="-90-8"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-198-tsx-token="-91-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-92-0">	</span><span class="token keyword" style="color:#00009f" data-198-tsx-token="return-92-1">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34" data-198-tsx-token="&lt;-92-8">&lt;</span><span class="token tag" style="color:#00009f" data-198-tsx-token="div-92-9">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-198-tsx-token="className-92-13">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-198-tsx-token="=-92-22">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-198-tsx-token="{-92-23">{</span><span class="token tag script language-javascript" style="color:#00009f" data-198-tsx-token="style-92-24">style</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-198-tsx-token=".-92-29">.</span><span class="token tag script language-javascript" style="color:#00009f" data-198-tsx-token="jsContainer-92-30">jsContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-198-tsx-token="}-92-41">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db" data-198-tsx-token="ref-92-43">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34" data-198-tsx-token="=-92-46">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-198-tsx-token="{-92-47">{</span><span class="token tag script language-javascript" style="color:#00009f" data-198-tsx-token="jsContainer-92-48">jsContainer</span><span class="token tag script language-javascript punctuation" style="color:#393A34" data-198-tsx-token="}-92-59">}</span><span class="token tag punctuation" style="color:#393A34" data-198-tsx-token="&gt;-92-60">&gt;</span><span class="token tag punctuation" style="color:#393A34" data-198-tsx-token="&lt;/-92-61">&lt;/</span><span class="token tag" style="color:#00009f" data-198-tsx-token="div-92-63">div</span><span class="token tag punctuation" style="color:#393A34" data-198-tsx-token="&gt;-92-66">&gt;</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-92-67">;</span><span class="token plain" data-198-tsx-token="-92-68"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-198-tsx-token="-93-0"></span><span class="token punctuation" style="color:#393A34" data-198-tsx-token="}-93-0">}</span><span class="token punctuation" style="color:#393A34" data-198-tsx-token=";-93-1">;</span></div></pre></div><h4 id="indexless-2"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#indexless-2"><span class="icon icon-link"></span></a>index.less</h4><div class="__dumi-default-code-block"><pre class="prism-code language-less" style="color:#393A34;background-color:#f6f8fa"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f" data-199-less-token=".jsContainer-0-0">.jsContainer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-199-less-token="{-0-13">{</span><span class="token plain" data-199-less-token="-0-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-1-0">	</span><span class="token property" style="color:#36acaa" data-199-less-token="position-1-1">position</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-1-9">:</span><span class="token plain"> relative</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-1-19">;</span><span class="token plain" data-199-less-token="-1-20"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-2-0">	</span><span class="token property" style="color:#36acaa" data-199-less-token="width-2-1">width</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-2-6">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="900-2-8">900</span><span class="token unit" data-199-less-token="px-2-11">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-2-13">;</span><span class="token plain" data-199-less-token="-2-14"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-199-less-token="-3-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-4-0">	</span><span class="token selector" style="color:#00009f" data-199-less-token=".jsItem-4-1">.jsItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-199-less-token="{-4-9">{</span><span class="token plain" data-199-less-token="-4-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-5-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="position-5-2">position</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-5-10">:</span><span class="token plain"> absolute</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-5-20">;</span><span class="token plain" data-199-less-token="-5-21"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-6-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="display-6-2">display</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-6-9">:</span><span class="token plain"> flex</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-6-15">;</span><span class="token plain" data-199-less-token="-6-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-7-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="align-items-7-2">align-items</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-7-13">:</span><span class="token plain"> center</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-7-21">;</span><span class="token plain" data-199-less-token="-7-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-8-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="justify-content-8-2">justify-content</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-8-17">:</span><span class="token plain"> center</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-8-25">;</span><span class="token plain" data-199-less-token="-8-26"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-9-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="width-9-2">width</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-9-7">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="200-9-9">200</span><span class="token unit" data-199-less-token="px-9-12">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-9-14">;</span><span class="token plain" data-199-less-token="-9-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-10-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="margin-bottom-10-2">margin-bottom</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-10-15">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="10-10-17">10</span><span class="token unit" data-199-less-token="px-10-19">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-10-21">;</span><span class="token plain" data-199-less-token="-10-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-11-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="overflow-11-2">overflow</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-11-10">:</span><span class="token plain"> hidden</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-11-18">;</span><span class="token plain" data-199-less-token="-11-19"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-12-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="color-12-2">color</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-12-7">:</span><span class="token plain"> </span><span class="token color" data-199-less-token="white-12-9">white</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-12-14">;</span><span class="token plain" data-199-less-token="-12-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-13-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="font-size-13-2">font-size</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-13-11">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="18-13-13">18</span><span class="token unit" data-199-less-token="px-13-15">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-13-17">;</span><span class="token plain" data-199-less-token="-13-18"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-14-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="background-14-2">background</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-14-12">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49" data-199-less-token="rgb-14-14">rgb</span><span class="token punctuation" style="color:#393A34" data-199-less-token="(-14-17">(</span><span class="token number" style="color:#36acaa" data-199-less-token="236-14-18">236</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="146-14-22">146</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="10-14-26">10</span><span class="token punctuation" style="color:#393A34" data-199-less-token=")-14-28">)</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-14-29">;</span><span class="token plain" data-199-less-token="-14-30"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-15-0">		</span><span class="token property" style="color:#36acaa" data-199-less-token="transition-15-2">transition</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-15-12">:</span><span class="token plain"> all </span><span class="token number" style="color:#36acaa" data-199-less-token="0.1-15-18">0.1</span><span class="token unit" data-199-less-token="s-15-21">s</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-15-22">;</span><span class="token plain" data-199-less-token="-15-23"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-199-less-token="-16-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-17-0">		</span><span class="token selector" style="color:#00009f" data-199-less-token=".jsTag-17-2">.jsTag</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-199-less-token="{-17-9">{</span><span class="token plain" data-199-less-token="-17-10"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-18-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="position-18-3">position</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-18-11">:</span><span class="token plain"> absolute</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-18-21">;</span><span class="token plain" data-199-less-token="-18-22"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-19-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="top-19-3">top</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-19-6">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="2-19-8">2</span><span class="token unit" data-199-less-token="px-19-9">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-19-11">;</span><span class="token plain" data-199-less-token="-19-12"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-20-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="left-20-3">left</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-20-7">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="2-20-9">2</span><span class="token unit" data-199-less-token="px-20-10">px</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-20-12">;</span><span class="token plain" data-199-less-token="-20-13"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-21-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="color-21-3">color</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-21-8">:</span><span class="token plain"> </span><span class="token color" data-199-less-token="white-21-10">white</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-21-15">;</span><span class="token plain" data-199-less-token="-21-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-22-0">		</span><span class="token punctuation" style="color:#393A34" data-199-less-token="}-22-2">}</span><span class="token plain" data-199-less-token="-22-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block" data-199-less-token="-23-0">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-24-0">		</span><span class="token selector" style="color:#00009f" data-199-less-token="img-24-2">img</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34" data-199-less-token="{-24-6">{</span><span class="token plain" data-199-less-token="-24-7"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-25-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="width-25-3">width</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-25-8">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa" data-199-less-token="100-25-10">100</span><span class="token unit" data-199-less-token="%-25-13">%</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-25-14">;</span><span class="token plain" data-199-less-token="-25-15"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-26-0">			</span><span class="token property" style="color:#36acaa" data-199-less-token="height-26-3">height</span><span class="token punctuation" style="color:#393A34" data-199-less-token=":-26-9">:</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34" data-199-less-token=";-26-15">;</span><span class="token plain" data-199-less-token="-26-16"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-27-0">		</span><span class="token punctuation" style="color:#393A34" data-199-less-token="}-27-2">}</span><span class="token plain" data-199-less-token="-27-3"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-28-0">	</span><span class="token punctuation" style="color:#393A34" data-199-less-token="}-28-1">}</span><span class="token plain" data-199-less-token="-28-2"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" data-199-less-token="-29-0"></span><span class="token punctuation" style="color:#393A34" data-199-less-token="}-29-0">}</span></div></pre></div><h3 id="优缺点-3"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#优缺点-3"><span class="icon icon-link"></span></a>优缺点</h3><p><strong>优点</strong></p><ol><li><strong>均匀分布</strong>：每次插入图片时都能选择当前高度最低的列，从而使各列的高度更加均匀，避免出现某列高度明显高于其他列的情况。</li><li><strong>简单实现</strong>：这种方法逻辑简单，通过记录每列的高度，插入图片时只需比较并更新高度，容易实现和维护。</li><li><strong>性能较好</strong>：相比于其他复杂的瀑布流算法，这种方法对计算资源的消耗较少，适用于图片数量较多的场景。</li><li><strong>动态适应</strong>：能够适应不同高度的图片，灵活性较高，不需要对图片进行预处理。</li></ol><p><strong>缺点</strong></p><ol><li><strong>高度不精确</strong>：默认高度只是一个估算值，实际图片加载后可能与预期高度不一致，导致布局出现错位或不美观的情况。</li><li><strong>首次加载性能问题</strong>：在首次加载时，可能会出现由于所有图片同时设置默认高度而导致的布局抖动问题，需要等待图片实际加载完成后重新调整高度。</li><li><strong>重新渲染开销</strong>：当图片实际加载高度与默认高度不符时，需要重新计算并调整布局，可能会引起页面重新渲染，增加开销。</li><li><strong>维护列高度数据</strong>：需要持续维护每列的高度数据，若图片数量较多或频繁更新，数据维护工作量较大。</li></ol><h1 id="-五、第三方库实现"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-五、第三方库实现"><span class="icon icon-link"></span></a>🍒 五、第三方库实现</h1><h2 id="react-photo-gallery"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#react-photo-gallery"><span class="icon icon-link"></span></a>react-photo-gallery</h2><ul><li>GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/neptunian/react-photo-gallery">https://github.com/neptunian/react-photo-gallery<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这个组件提供了一个灵活的图片展示方式，支持瀑布流布局。</li></ul><p><img src="/front_end_engineer_book/static/image-20240615142927000.c42b00be.png" alt="image-20240615142927000"/></p><h2 id="react-masonry-css"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#react-masonry-css"><span class="icon icon-link"></span></a>react-masonry-css</h2><ul><li>GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/paulcollett/react-masonry-css">https://github.com/paulcollett/react-masonry-css<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这是一个基于CSS的瀑布流布局组件，不依赖额外的JavaScript库。</li></ul><p><img src="/front_end_engineer_book/static/image-20240615142931546.00466f2d.png" alt="image-20240615142931546"/></p><h2 id="react-stack-grid"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#react-stack-grid"><span class="icon icon-link"></span></a>react-stack-grid</h2><ul><li>GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/tsuyoshiwada/react-stack-grid">https://github.com/tsuyoshiwada/react-stack-grid<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>这是一个提供了Pinterest风格的瀑布流布局的组件。</p><p><img src="/front_end_engineer_book/static/image-20240615142937674.a7a92296.png" alt="image-20240615142937674"/></p><h2 id="react-stonecutter"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#react-stonecutter"><span class="icon icon-link"></span></a>react-stonecutter</h2><ul><li>GitHub: <a target="_blank" rel="noopener noreferrer" href="https://github.com/dantrain/react-stonecutter">https://github.com/dantrain/react-stonecutter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>这是一个用于创建动态网格布局的组件库，包括瀑布流布局。</p><p><img src="/front_end_engineer_book/static/image-20240615142947982.fdbc9544.png" alt="image-20240615142947982"/></p><h1 id="-推荐阅读"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-推荐阅读"><span class="icon icon-link"></span></a>🍎 推荐阅读</h1><h2 id="工程化"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#工程化"><span class="icon icon-link"></span></a>工程化</h2><p>本系列是一个从0到1的实现过程，如果您有耐心跟着实现，您可以实现一个完整的<code>react18 + ts5 + webpack5 + 代码质量&amp;代码风格检测&amp;自动修复 + storybook8 + rollup + git action</code>实现的一个完整的组件库模板项目。如果您不打算自己配置，也可以直接clone<a target="_blank" rel="noopener noreferrer" href="https://objectx-9.github.io/react_demo/?path=/docs/%E9%80%9A%E7%94%A8-button--docs">组件库仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>切换到<code>rollup_comp</code>分支即是完整的项目，当前实现已经足够个人使用，后续我们会新增webpack5优化、按需加载组件、实现一些常见的组件封装：包括但不限于拖拽排序、瀑布流、穿梭框、弹窗等</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7353504333999505408">【前端工程化】项目搭建篇-项目初始化&amp;prettier、eslint、stylelint、lint-staged、husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7353561676091097103">【前端工程化】项目搭建篇-配置changelog、webpack5打包<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7353963878541246504">【前端工程化】项目搭建篇-引入react、ts、babel解析es6+、配置css module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7355026320088989733">【前端工程化】组件库搭建篇-引入storybook、rollup打包组件、本地测试组件库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7356175306937466916">【前端工程化】包管理器篇-三大包管理器、npm工程管理、npm发布流程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7356815857078157331">【前端工程化】自动化篇-Github Action基本使用、自动部署组件库文档、github3D指标统计<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7366601730426159144">【前端工程化】自动化篇-手写脚本一键自动tag、发包、引导登录npm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="常见组件实现"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#常见组件实现"><span class="icon icon-link"></span></a>常见组件实现</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7370513151052021787">【组件实现篇】&quot;从零使用react打造瀑布流的四种方式：完美展示动态图片流&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="面试手写系列"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#面试手写系列"><span class="icon icon-link"></span></a>面试手写系列</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7353504333999505408">前端面试手写必备【实现常见八大数据结构一】<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7359877430340157503">手写哈希表【银四末尾，你上岸了吗？】哈希表，快速计算、均匀分布、扩容实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7370513151052038171">【前端面试手写必备】树🌲&amp;实现树结构<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="react实现原理系列"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#react实现原理系列"><span class="icon icon-link"></span></a>react实现原理系列</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/spost/7360512664316117026">【react原理实践】使用babel手搓探索下jsx的原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/spost/7361284455535345699">【喂饭式调试react源码】上手调试源码探究jsx原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/spost/7363220284503097354#heading-0">【上手调试源码系列】图解react几个核心包之间的关联<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7363193808521199655#heading-1">【上手调试源码系列】react启动流程，其实就是创建三大全局对象<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="其他"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#其他"><span class="icon icon-link"></span></a>其他</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7358709354424860707">工作流【效率小技巧】让alfred帮我启动所有项目，nice<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7352045198854406183">GPT4前端食用指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h1 id="-写在最后"><a aria-hidden="true" tabindex="-1" href="/front_end_engineer_book//02comp/00waterfall#-写在最后"><span class="icon icon-link"></span></a>🍋 写在最后</h1><p>如果您看到这里了，并且觉得这篇文章对您有所帮助，希望您能够点赞👍和收藏⭐支持一下作者🙇🙇🙇，感谢🍺🍺！如果文中有任何不准确之处，也欢迎您指正，共同进步。感谢您的阅读，期待您的点赞👍和收藏⭐！</p><p>感兴趣的同学可以关注下我的公众号ObjectX前端实验室</p><p>🌟 少走弯路 | ObjectX前端实验室 🛠️「精选资源｜实战经验｜技术洞见」</p></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last update: ">6/15/2024 07:19:04</span></div></article></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/front_end_engineer_book/umi.9ab99bfd.js"></script>
  </body>
</html>
