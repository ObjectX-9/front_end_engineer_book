---
group:
  title: 00å®æˆ˜æ­å»º&éƒ¨ç½²ç¯‡
  order: 0
title: 4.react+tsç¯å¢ƒæ­å»º
order: 4
# è¿™ä¸ªå¯ä»¥å°†å†™çš„ç»„ä»¶è®¾ç½®ä¸ºdemoåœ¨å³ä¾§å±•ç¤º
# demo: /
---
# æ”¯æŒreact

å®‰è£… react å’Œ react-dom ï¼š

    yarn add react@18.2.0 react-dom@18.2.0 -S

\-S ç›¸å½“äº --save ï¼Œ -D ç›¸å½“äº --save-dev ã€‚

å…¶å®å®‰è£…äº†è¿™ä¸¤ä¸ªåŒ…å°±å·²ç»èƒ½ä½¿ç”¨ jsx è¯­æ³•äº†ï¼Œæˆ‘ä»¬åœ¨ src/index.js ä¸­è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```js
import React from 'react';
import ReactDOM from 'react-dom';
import App from './app';

ReactDOM.render(<App />, document.querySelector('#root'));
```

åœ¨src/app.jsä¸­è¾“å…¥

    import React from 'react';
    
    function App() {
    	return <div className='App'>React18 + Ts5 + webpack5 å¼€å‘æ¨¡æ¿æ­å»º</div>;
    }
    
    export default App;

ä¿®æ”¹å…¥å£æ–‡ä»¶

    entry: {
    		app: resolve(PROJECT_PATH, './src/index.js'),
    	},

è¿™æ—¶å€™è¿è¡Œ`yarn run start`ä¼šå‘ç”ŸæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºreactä¸èƒ½è¯†åˆ«jsxè¯­æ³•ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦babeläº†ï¼Œæˆ‘ä»¬åé¢ä¼šæœ‰ä¸€ç¯‡æ–‡ç« ä¸“é—¨ä»‹ç»babelï¼Œè¿™é‡ŒçŸ¥é“å¦‚ä½•é…ç½®å³å¯

![image-20240615120446101](./assets/image-20240615120446101.png)

# å®‰è£…babelæ”¯æŒtsx

## æ”¯æŒjsæ–‡ä»¶ä¸­ä½¿ç”¨jsxè¯­æ³•

    yarn add babel-loader@9.1.3 @babel/core@7.24.0 @babel/preset-react@7.23.3 -D

babel-loader ä½¿ç”¨ babel è§£ææ–‡ä»¶ï¼›@babel/core æ˜¯ babel çš„æ ¸å¿ƒæ¨¡å—ï¼›@babel/preset-react è½¬è¯‘ jsx è¯­æ³•ã€‚

åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º .babelrc æ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

    {
      "presets": ["@babel/preset-react"]
    }

presets æ˜¯ä¸€äº›åˆ—æ’ä»¶é›†åˆã€‚æ¯”å¦‚ @babel/preset-react ä¸€èˆ¬æƒ…å†µä¸‹ä¼šåŒ…å« @babel/plugin-syntax-jsx ã€ @babel/plugin-transform-react-jsx ã€ @babel/plugin-transform-react-display-name è¿™å‡ ä¸ª babel æ’ä»¶ã€‚

æ¥ä¸‹æ¥æ‰“å¼€æˆ‘ä»¬çš„ webpack.common.js æ–‡ä»¶ï¼Œå¢åŠ ä»¥ä¸‹ä»£ç ï¼š

```js
module: {
		rules: [
			{
				test: /\.(tsx?|js)$/,
				loader: 'babel-loader',
				options: {cacheDirectory: true},
				exclude: /node_modules/,
			},
		],
	},
```

è¿™é‡Œå› ä¸ºæˆ‘ä»¬åœ¨é…ç½®eslintçš„æ—¶å€™å°±å·²ç»é…ç½®è¿‡tsäº†ï¼Œæ‰€ä»¥ç›´æ¥å°±æ£€æµ‹tsxå°±è¡Œäº†ï¼Œä¸ç”¨jsxäº†ã€‚

ç°åœ¨ç›´æ¥`yarn run start`çœ‹æ•ˆæœï¼Œè·Ÿä¹‹å‰æ˜¯ä¸€æ ·çš„

![image-20240615120458874](./assets/image-20240615120458874.png)
ç°åœ¨æˆ‘ä»¬æŠŠ`src/index.js`æ”¹ä¸º`index.tsx`, `src/app.js`æ”¹ä¸º`app.tsx`ï¼Œç„¶åæ›´æ”¹webpackæ‰“åŒ…å…¥å£ä¸º`index.tsx`ï¼Œè¿™æ—¶å€™vscodeä¼šæŠ¥é”™ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬åªæ˜¯æ”¯æŒäº†reactï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é…ç½®tsè¯†åˆ«reactç­‰

![image-20240615120505497](./assets/image-20240615120505497.png)

## æ”¯æŒtsxæ–‡ä»¶çš„è§£æ

[@babel/preset-typescript](https://babeljs.io/docs/babel-preset-typescript) æ˜¯ babel çš„ä¸€ä¸ª presetï¼Œå®ƒç¼–è¯‘ ts çš„è¿‡ç¨‹å¾ˆç²—æš´ï¼Œå®ƒç›´æ¥å»æ‰ ts çš„ç±»å‹å£°æ˜ï¼Œç„¶åå†ç”¨å…¶ä»– babel æ’ä»¶è¿›è¡Œç¼–è¯‘ï¼Œæ‰€ä»¥å®ƒå¾ˆå¿«ã€‚

    yarn add @babel/preset-typescript@7.23.3 -D

ç„¶åä¿®æ”¹ .babelrc ï¼š

```json
{
  "presets": ["@babel/preset-react", "@babel/preset-typescript"]
}
```

presets çš„æ‰§è¡Œé¡ºåºæ˜¯ä»ååˆ°å‰çš„ã€‚æ ¹æ®ä»¥ä¸Šä»£ç çš„ babel é…ç½®ï¼Œä¼šå…ˆæ‰§è¡Œ @babel/preset-typescript ï¼Œç„¶åå†æ‰§è¡Œ @babel/preset-react ã€‚

## tsx è¯­æ³•æµ‹è¯•

è¿™æ—¶å€™æˆ‘ä»¬è¿è¡Œ`yarn run start`ç¼–è¯‘ä»£ç æ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› ä¸ºæˆ‘ä»¬åªæ”¹äº†å…¥å£ä¸ºtsxï¼Œä½†æ˜¯å¼•å…¥app.tsxçš„æ—¶å€™æˆ‘ä»¬çœç•¥äº†.tsxçš„åç¼€ã€‚è¿™é‡Œå¦‚æœä½ æŠŠåç¼€åŠ ä¸Šï¼Œå®ƒä¹Ÿèƒ½æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬ä¸è¿™ä¹ˆåšï¼Œæˆ‘ä»¬æ›´æ”¹ä¸€ä¸‹webpackçš„é…ç½®ï¼Œå¢åŠ 

![image-20240615120520358](./assets/image-20240615120520358.png)

    module.exports = {
      entry: {
        app: resolve(PROJECT_PATH, './src/index.tsx'),
      },
      resolve: {
        extensions: ['.tsx', '.ts', '.js', '.json'],
      },
    }

å°±å¯ä»¥ä¸åŠ æ–‡ä»¶åç¼€åäº†ã€‚webpack ä¼šæŒ‰ç…§å®šä¹‰çš„åç¼€åçš„é¡ºåºä¾æ¬¡å¤„ç†æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šæ–‡é…ç½® \['.tsx', '.ts', '.js', '.json'] ï¼Œwebpack ä¼šå…ˆå°è¯•åŠ ä¸Š .tsx åç¼€ï¼Œçœ‹æ‰¾å¾—åˆ°æ–‡ä»¶ä¸ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¾æ¬¡å°è¯•è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é…ç½®æ—¶å°½é‡æŠŠæœ€å¸¸ç”¨åˆ°çš„åç¼€æ”¾åˆ°æœ€å‰é¢ï¼Œå¯ä»¥ç¼©çŸ­æŸ¥æ‰¾æ—¶é—´ã€‚

è¿™ä¸ªæ—¶å€™å†è¿›è¡Œ `yarn run start` ï¼Œé¡µé¢å°±èƒ½æ­£ç¡®è¾“å‡ºäº†ã€‚

![image-20240615120530769](./assets/image-20240615120530769.png)

# å¢åŠ ç±»å‹å£°æ˜

è™½ç„¶ç°åœ¨å·²ç»å¯ä»¥æ­£å¸¸è¾“å‡ºäº†ï¼Œä½†æ˜¯vscodeè¿˜æ˜¯ç»™æˆ‘ä»¬æŠ¥äº†å‡ ä¸ªé”™ï¼Œæ— æ³•æ‰¾åˆ°ç±»å‹å£°æ˜æ–‡ä»¶

![image-20240615120539845](./assets/image-20240615120539845.png)

æˆ‘ä»¬å®‰è£…

    yarn add @types/react@18.2.66 @types/react-dom@18.2.22 -D

å®‰è£…å®Œæˆä¹‹åreactå°±ä¸å†æŠ¥é”™äº†

![image-20240615120546173](./assets/image-20240615120546173.png)

è¿™æ—¶å€™index.tsxä¸­ä»ç„¶æœ‰ä¸€ä¸ªæŠ¥é”™ï¼ŒåŸå› æ˜¯react18ä¹‹åï¼Œ`ReactDom.render`å·²ç»è¢«å¼ƒç”¨äº†éœ€è¦ç”¨createRootæ¥æ›¿ä»£ã€‚

![image-20240615120554628](./assets/image-20240615120554628.png)

æˆ‘ä»¬æ›´æ”¹`index.tsx`çš„ä»£ç 

```js
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './app';

// è·å–ä½ çš„ HTML æ–‡ä»¶ä¸­çš„æ ¹ DOM å…ƒç´ 
const container = document.getElementById('root');

// éç©ºæ–­è¨€ï¼Œç¡®ä¿ container ä¸æ˜¯ null
if (container !== null) {
	const root = ReactDOM.createRoot(container);
	root.render(<App />);
} else {
	console.error('Failed to find the root element');
}

```

è¿™é‡Œè§£é‡Šä¸‹ä¸ºä»€ä¹ˆreact18è¦ä½¿ç”¨createRootæ›¿æ¢ReactDOM.renderï¼Œ

createRoot æ˜¯ React 18 å¼•å…¥çš„ä¸€ä¸ª APIï¼Œå®ƒæ˜¯ Concurrent Mode çš„å…¥å£ç‚¹ä¹‹ä¸€ã€‚Concurrent Mode æ˜¯ä¸€ç»„æ–°çš„åŠŸèƒ½ï¼Œä½¿ React èƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªä¼˜å…ˆçº§çš„å·¥ä½œï¼Œä»è€Œä¼˜åŒ–æ¸²æŸ“æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚ä»¥ä¸‹æ˜¯ createRoot çš„ä¸€äº›ç‰¹ç‚¹ï¼š

*   å¯ç”¨å¹¶å‘ç‰¹æ€§ï¼šcreateRoot å…è®¸ä½ å¯ç”¨ React çš„å¹¶å‘æ¸²æŸ“èƒ½åŠ›ã€‚åœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼ŒReact å¯ä»¥æ‰“æ–­å’Œæ¢å¤æ¸²æŸ“å·¥ä½œï¼Œè¿™å…è®¸é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰èƒ½å¤Ÿæ‰“æ–­ä½ä¼˜å…ˆçº§çš„æ¸²æŸ“ï¼ˆå¦‚æ•°æ®çš„é¢„åŠ è½½ï¼‰ã€‚å› æ­¤ï¼Œå¯¹äºç”¨æˆ·äº’åŠ¨å’Œåº”ç”¨çš„å“åº”æ€§æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„æå‡ã€‚

*   æ›´å¥½çš„é”™è¯¯å’Œä¸­æ–­å¤„ç†ï¼šConcurrent Mode è¿˜æ”¹è¿›äº†é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä½¿å¾— React åœ¨é¢ä¸´é”™è¯¯æ—¶æ›´ä¸ºç¨³å¥ã€‚æ­¤å¤–ï¼Œç”±äº React èƒ½å¤Ÿåˆ†å—å¤„ç†æ›´æ–°ï¼Œå½“æ‰§è¡Œé•¿æ—¶é—´çš„æ›´æ–°æ—¶ï¼Œåº”ç”¨ä¸ä¼šå†»ç»“ï¼Œè€Œæ˜¯èƒ½å¤Ÿä¿æŒäº¤äº’æ€§ã€‚

*   è‡ªåŠ¨æ‰¹å¤„ç†ï¼šåœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼ŒReact ä¼šæ›´æ™ºèƒ½åœ°æ‰¹å¤„ç†æ›´æ–°ï¼Œä»è€Œå‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œä»¥åŠä¸æ¸²æŸ“ç›¸å…³çš„æµè§ˆå™¨å·¥ä½œé‡ï¼Œè¿™å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚

*   Transition æå‡ä½“éªŒï¼šReact 18 å¼•å…¥çš„æ–°ç‰¹æ€§ä¸­ï¼ŒåŒ…æ‹¬äº† startTransition APIï¼Œè¿™æ˜¯ Concurrent Mode çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚startTransition å…è®¸ä½ æ ‡è®°æŸäº›æ›´æ–°ä¸ºâ€œè¿‡æ¸¡â€ï¼Œä¸ç«‹å³é‡è¦çš„æ›´æ–°åˆ†å¼€ï¼Œè¿™æ ·å³ä½¿è¿™äº›æ›´æ–°å¯èƒ½å¯¼è‡´è¾ƒé•¿çš„åŠ è½½æ—¶é—´ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šæ„Ÿè§‰åˆ°åº”ç”¨å˜å¾—å¡é¡¿ä¸å“åº”ï¼Œå› ä¸ºä¸»è¦çš„ç•Œé¢æ“ä½œï¼ˆä¾‹å¦‚è¾“å…¥ã€ç‚¹å‡»ç­‰ï¼‰ä»ç„¶èƒ½å¤Ÿå¿«é€Ÿå“åº”ã€‚

*   æ›´ä¸€è‡´çš„çŠ¶æ€æ›´æ–°ï¼šåœ¨ä¹‹å‰çš„ React ç‰ˆæœ¬ï¼ˆæ— å¹¶å‘æ¨¡å¼ï¼‰ä¸­ï¼ŒçŠ¶æ€æ›´æ–°å¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œè¿™å–å†³äºäº‹ä»¶å¤„ç†å™¨ï¼ˆä¾‹å¦‚ç‚¹å‡»äº‹ä»¶ï¼‰æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ã€‚ç°åœ¨ï¼Œé€šè¿‡ createRoot ä¸å¹¶å‘æ¨¡å¼ï¼ŒReact ç»Ÿä¸€äº†æ›´æ–°çš„è¡Œä¸ºï¼Œè®©çŠ¶æ€æ›´æ–°é¢„æµ‹å˜å¾—æ›´å®¹æ˜“ã€‚

è€ŒReactDOM.render æ–¹æ³•æ˜¯ React è€ç‰ˆæœ¬ä¸­ç”¨æ¥å°† React ç»„ä»¶æŒ‚è½½åˆ° DOM èŠ‚ç‚¹çš„ä¼ ç»Ÿæ–¹æ³•ã€‚è¯¥æ–¹æ³•åœ¨ React 18 ä¹‹å‰ä¸€ç›´æ˜¯æŒ‚è½½ React åº”ç”¨çš„æ ‡å‡†æ–¹å¼ã€‚ç„¶è€Œï¼Œéšç€ React 18 çš„å‘å¸ƒå’Œæ–°çš„å¹¶å‘åŠŸèƒ½çš„å¼•å…¥ï¼ŒReactDOM.render æ–¹æ³•åœ¨æŸäº›æ–¹é¢æ˜¾å¾—ä¸å¤Ÿç”¨ï¼Œå¹¶ä¸”å…·æœ‰äº›è®¸å±€é™æ€§ã€‚ä»¥ä¸‹æ˜¯ ReactDOM.render çš„ä¸€äº›ç¼ºç‚¹ï¼š

*   ä¸æ”¯æŒå¹¶å‘ç‰¹æ€§ï¼šReactDOM.render æ–¹æ³•ä¸æ”¯æŒ React 18 å¼•å…¥çš„å¹¶å‘ç‰¹æ€§ã€‚å®ƒæ— æ³•åˆ©ç”¨å¹¶å‘æ¨¡å¼ï¼ˆConcurrent Modeï¼‰æä¾›çš„æ–°ç‰¹æ€§ï¼Œå¦‚å¹¶å‘æ¸²æŸ“ã€ä»»åŠ¡çš„ä¸­æ–­å’Œæ¢å¤ã€è‡ªåŠ¨æ‰¹å¤„ç†ã€ä¼˜å…ˆçº§ç®¡ç†ç­‰ã€‚

*   åŒæ­¥æ›´æ–°ï¼šReactDOM.render æ–¹æ³•ä¼šå¯¼è‡´ç»„ä»¶çŠ¶æ€çš„æ›´æ–°å’Œ DOM çš„æ›´æ–°ä»¥åŒæ­¥çš„æ–¹å¼å‘ç”Ÿã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå½±å“æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨æ‰§è¡Œå¤§é‡è®¡ç®—æˆ–å¤„ç†å¤æ‚æ›´æ–°çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·ç•Œé¢å˜å¾—å¡é¡¿ã€‚

*   æ‰¹å¤„ç†å±€é™æ€§è™½ç„¶ React åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå°è¯•è‡ªåŠ¨æ‰¹å¤„ç†çŠ¶æ€æ›´æ–°ï¼Œä½†åœ¨ ReactDOM.render ä½¿ç”¨çš„ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼ŒReact çš„è‡ªåŠ¨æ‰¹å¤„ç†èƒ½åŠ›å—é™äºäº‹ä»¶å¤„ç†å‡½æ•°çš„ä¸Šä¸‹æ–‡ã€‚è¿™ä½¿å¾—åœ¨éäº‹ä»¶å¤„ç†ä»£ç ä¸­æ‰§è¡Œçš„æ›´æ–°ä¸ä¸€å®šä¼šè‡ªåŠ¨æ‰¹å¤„ç†ï¼Œä»è€Œå¯èƒ½å¯¼è‡´é¢å¤–çš„æ¸²æŸ“å’Œæ€§èƒ½ä¸è¶³ã€‚

*   çŠ¶æ€æ›´æ–°ä¸ä¸€è‡´ï¼šåœ¨ä¼ ç»Ÿæ¸²æŸ“æ¨¡å¼ä¸‹ï¼Œæ ¹æ®æ›´æ–°å‘ç”Ÿçš„ä¸Šä¸‹æ–‡ï¼ŒReact çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯å¼‚æ­¥çš„ã€‚è¿™é€ æˆäº†ä¸€å®šçš„é¢„æµ‹å›°éš¾ï¼Œä½¿å¾—å¼€å‘è€…å¯èƒ½éœ€è¦è¿›è¡Œé¢å¤–çš„å·¥ä½œæ¥ç¡®ä¿ç»„ä»¶çš„è¡Œä¸ºå¦‚æœŸæœ›çš„é‚£æ ·ã€‚

*   æ¸²æŸ“ä¼˜åŒ–å—é™ï¼šä¼ ç»Ÿçš„ ReactDOM.render æ–¹æ³•åœ¨å¤„ç†æ›´æ–°å’Œä¼˜åŒ–æ¸²æŸ“æ€§èƒ½æ–¹é¢çš„èƒ½åŠ›æœ‰é™ã€‚åœ¨ä¸€äº›å¤æ‚çš„æ›´æ–°åœºæ™¯ä¸­ï¼Œå¼€å‘è€…å¯èƒ½éœ€è¦æ‰‹åŠ¨è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚é˜²æ­¢ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œè¿™è¦æ±‚æ›´å¤šçš„ç¼–ç å’Œæ€§èƒ½è°ƒä¼˜å·¥ä½œã€‚

*   è¿‡æ¸¡APIä¸å¯ç”¨ï¼šä½¿ç”¨ ReactDOM.render çš„ä»£ç ä¸èƒ½åˆ©ç”¨ startTransition è¿™æ ·çš„è¿‡æ¸¡ API æ¥åŒºåˆ†ä¸ç´§æ€¥çš„æ›´æ–°ï¼Œä»è€Œæ”¹å–„ç”¨æˆ·åœ¨åŠ è½½æ–°å†…å®¹æˆ–æ‰§è¡Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡æ—¶çš„ä½“éªŒã€‚

*   é”™è¯¯å’Œä¸­æ–­å¤„ç†è¾ƒå¼±ï¼šåœ¨å¹¶å‘æ¨¡å¼ä¹‹å¤–ï¼ŒReact ç»„ä»¶çš„é”™è¯¯è¾¹ç•Œå’Œä¸­æ–­å¤„ç†èƒ½åŠ›è¾ƒå¼±ï¼Œè¿™å¯èƒ½ä½¿å¾—åº”ç”¨å¯¹é”™è¯¯æ¡ä»¶å’Œé•¿æ—¶é—´æ‰§è¡Œä»»åŠ¡çš„å“åº”ä¸å¤Ÿé²æ£’ã€‚

# å¢åŠ å›¾ç‰‡ã€æ–‡ä»¶ç­‰æ¨¡å—çš„ç±»å‹å£°æ˜

ç°åœ¨å¤§éƒ¨åˆ†çš„ç¯å¢ƒæ­å»ºæˆ‘ä»¬å·²ç»æå®šäº†ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨
app.tsxä¸­å¼•å…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œä½ ä¼šå‘ç°å®ƒæœ‰æŠ¥é”™ï¼Œæ²¡æœ‰ç±»å‹å£°æ˜ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦é…ç½®ä¸€ä¸‹æ–‡ä»¶çš„ç±»å‹å£°æ˜ã€‚ä»¥åå¦‚æœä½ å®‰è£…çš„ç¬¬ä¸‰æ–¹æ¨¡å—æ²¡æœ‰@type/xxxçš„åŒ…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹å¼è§£å†³

```js
import React from 'react';
import img from '../javascript.png';
function App() {
	return (
		<>
			<div className='App'>React18 + Ts5 + webpack5 å¼€å‘æ¨¡æ¿æ­å»º</div>;
			<img src={img}></img>
		</>
	);
}

export default App;

```

![image-20240615120607359](./assets/image-20240615120607359.png)

åªæ˜¯ä¼šæœ‰tsæŠ¥é”™ä½†æ˜¯ä¸å½±å“æ‰“åŒ…ï¼Œæˆ‘ä»¬é…ç½®ä¸‹æ–‡ä»¶çš„ç±»å‹å£°æ˜ï¼Œåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºtypings/file.d.tsæ–‡ä»¶è¾“å…¥

    declare module '*.svg' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.bmp' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.gif' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.jpg' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.jpeg' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.png' {
    	const path: string;
    	export default path;
    }
    
    declare module '*.css' {
    	const classes: Record<string, string>;
    	export default classes;
    }
    
    declare module '*.scss' {
    	const classes: Record<string, string>;
    	export default classes;
    }
    
    declare module '*.sass' {
    	const classes: Record<string, string>;
    	export default classes;
    }
    
    declare module '*.styl' {
    	const classes: Record<string, string>;
    	export default classes;
    }
    
    // ç»§ç»­ä¿æŒä½ å·²æœ‰çš„ .less å£°æ˜
    declare module '*.less' {
    	const content: Record<string, string>;
    	export default content;
    }

ä¿®æ”¹tsconfig.jsonæ–‡ä»¶å¢åŠ å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æŠ¥é”™å°±æ¶ˆå¤±äº†ã€‚

    "include": [
    		"src/**/*", // è¿™å°†åŒ…æ‹¬ src ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
    		"typings/**/*"
    	]

![image-20240615120621561](./assets/image-20240615120621561.png)

# baseUrl\&paths&é…ç½®åˆ«å

ç›®çš„æ˜¯ä¸ä½¿ç”¨`../../../`å»å¯¼å…¥ç»„ä»¶ï¼Œé…ç½®å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯¼å…¥ç»„ä»¶ï¼Œè¿™æ ·å°±æ–¹ä¾¿å¤šäº†

    import Header from '@components/Header'

é¦–å…ˆéœ€è¦é˜²æ­¢eslintæŠ¥é”™ï¼Œ

![image-20240615120630210](./assets/image-20240615120630210.png)

è¿™ä¸ªæ—¶å€™éœ€è¦æ”¹ .eslintrc.js æ–‡ä»¶çš„é…ç½®äº†ï¼Œé¦–å…ˆå¾—å®‰è£… eslint-import-resolver-typescript ï¼š

    yarn add eslint-import-resolver-typescript@3.6.1 -D

ç„¶ååœ¨ .eslintrc.js æ–‡ä»¶çš„ setting å­—æ®µä¿®æ”¹ä¸ºä»¥ä¸‹ä»£ç ï¼š

    settings: {
      'import/resolver': {
        node: {
          extensions: ['.tsx', '.ts', '.js', '.json'],
        },
        typescript: {},
      },
    },

æ˜¯çš„ï¼Œåªéœ€è¦æ·»åŠ  typescript: {} å³å¯ï¼Œè¿™æ—¶å€™å†å»çœ‹å·²ç»æ²¡æœ‰æŠ¥é”™äº†ã€‚å¹¶ä¸”æ˜¯indexçš„æ–‡ä»¶å¯ä»¥ç›´æ¥ä¸ç”¨å†™ï¼Œåªéœ€è¦åˆ°headerå±‚å°±è¡Œäº†ã€‚ ä½†æ˜¯ä¸Šé¢æˆ‘ä»¬å®Œæˆçš„å·¥ä½œä»…ä»…æ˜¯å¯¹äºç¼–è¾‘å™¨æ¥è¯´å¯è¯†åˆ«è¿™ä¸ªè·¯å¾„æ˜ å°„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ webpack.common.js ä¸­çš„ resolve.alias æ·»åŠ ç›¸åŒçš„æ˜ å°„è§„åˆ™é…ç½®ï¼š

webpack.common.jsï¼Œé…ç½®webpackå¯ä»¥è®©æˆ‘ä»¬æ­£ç¡®æ‰“åŒ…

    resolve: {
        extensions: [".tsx", ".ts", ".js", ".json"],
        alias: {
          "@src": resolve(PROJECT_PATH, "./src"),
          "@components": resolve(PROJECT_PATH, "./src/components"),
          "@utils": resolve(PROJECT_PATH, "./src/utils"),
        },
      },

tsconfig.jsonï¼Œé…ç½®tså¯ä»¥ç»™æˆ‘ä»¬å¼€å‘æç¤ºã€‚

    "paths": {
    			// è·¯å¾„æ˜ å°„ï¼Œä¸ baseUrl å…³è”
    			"@src/*": ["src/*"],
    			"@components/*": ["src/components/*"],
    			"@utils/*": ["src/utils/*"]
    		},

# é…ç½®css module

æˆ‘æƒ³è¦ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼å¯¼å…¥lessæ–‡ä»¶å¹¶ä½¿ç”¨

![image-20240615120642612](./assets/image-20240615120642612.png)

æˆ‘ä»¬éœ€è¦å¼€å¯cssæ¨¡å—åŒ–ï¼Œè¯·æ³¨æ„ï¼Œå¯¹äºæ¨¡å—åŒ–çš„æ–¹å¼ï¼Œé€šå¸¸ä¼šä½¿ç”¨ .module.less ä½œä¸ºæ–‡ä»¶åç¼€ï¼Œä»¥åŒºåˆ†æ¨¡å—åŒ–çš„æ ·å¼æ–‡ä»¶å’Œå…¨å±€çš„æ ·å¼æ–‡ä»¶ã€‚æ‰€ä»¥lessæ–‡ä»¶åéœ€è¦æ”¹ä¸º`xxxx.module.less`

æ›´æ”¹webpacké…ç½®ï¼Œä¹‹å‰è®¾ç½®çš„æ˜¯false

![image-20240615120649960](./assets/image-20240615120649960.png)

è¿™æ ·é…ç½®å°±OKäº†ï¼Œæ¨¡å—åŒ–ä¹Ÿç”Ÿæ•ˆäº†ã€‚

![image-20240615120702538](./assets/image-20240615120702538.png)

ä½†æ˜¯è¿™ä¸ªåå­—è®©æˆ‘ä»¬çœ‹ä¸å‡ºæœ‰ä»»ä½•è§„å¾‹ï¼Œè¿™é‡Œæ˜¯å¯ä»¥æ›´æ”¹é…ç½®çš„ï¼Œé…ç½®è§„åˆ™å¦‚ä¸‹
åœ¨ modules å¯¹è±¡ä¸­ï¼ŒlocalIdentName æ˜¯ç”Ÿæˆç±»åçš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥åŒ…å«ä»¥ä¸‹å ä½ç¬¦ï¼š

*   \[local]ï¼šåŸå§‹çš„ç±»åã€‚
*   \[path]ï¼šæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚
*   \[name]ï¼šæ–‡ä»¶åã€‚
*   \[hash:base64]ï¼šå†…å®¹çš„ base64 å“ˆå¸Œã€‚
*   \[hash:base64:length]ï¼šé•¿åº¦é™åˆ¶çš„å†…å®¹å“ˆå¸Œã€‚
*   \[folder]ï¼šæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹åã€‚
    ä¾‹å¦‚ï¼ŒlocalIdentName: '\[path]\[name]\_\_\[local]--\[hash:base64:5]' å¯èƒ½äº§ç”Ÿä¸‹é¢è¿™æ ·çš„ç±»åï¼šsrc-components-MyComponent\_\_header--1a2b3c.

æˆ‘ä»¬çš„é…ç½®å¦‚ä¸‹ï¼š

    const getCssLoaders = (importLoaders) => [
    	'style-loader',
    	{
    		loader: 'css-loader',
    		options: {
    			modules: {
    				localIdentName: '[local]__[hash:base64:5]',
    			},
    			sourceMap: isDev,
    			importLoaders,
    		},
    	},
    	'postcss-loader',
    ];

![image-20240615120715598](./assets/image-20240615120715598.png)

# é…ç½®es6+è½¬es5

ä¹‹å‰æˆ‘ä»¬å·²ç»ä½¿ç”¨ babel å»è§£æ react è¯­æ³•å’Œ typescript è¯­æ³•äº†ï¼Œä½†æ˜¯ç›®å‰æˆ‘ä»¬æ‰€åšçš„ä¹Ÿä»…ä»…å¦‚æ­¤ï¼Œä½ åœ¨ä»£ç ä¸­ç”¨åˆ°çš„ ES6+ è¯­æ³•ç¼–è¯‘ä¹‹åä¾ç„¶å…¨éƒ¨ä¿ç•™ï¼Œç„¶è€Œä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½èƒ½æ”¯æŒ ES6+ è¯­æ³•çš„ï¼Œè¿™æ—¶å€™å°±éœ€è¦`@babel/preset-env`ï¼Œå®ƒä¼šæ ¹æ®è®¾ç½®çš„ç›®æ ‡æµè§ˆå™¨ç¯å¢ƒï¼ˆbrowserslistï¼‰æ‰¾å‡ºæ‰€éœ€çš„æ’ä»¶å»è½¬è¯‘ ES6+ è¯­æ³•ã€‚æ¯”å¦‚ const æˆ– let è½¬è¯‘ä¸º var ã€‚

ä½†æ˜¯é‡åˆ° Promise æˆ– .includes è¿™ç§æ–°çš„ es ç‰¹æ€§ï¼Œæ˜¯æ²¡åŠæ³•è½¬è¯‘åˆ° es5 çš„ï¼Œé™¤éæˆ‘ä»¬æŠŠè¿™ä¸­æ–°çš„è¯­è¨€ç‰¹æ€§çš„å®ç°æ³¨å…¥åˆ°æ‰“åŒ…åçš„æ–‡ä»¶ä¸­ï¼Œä¸å°±è¡Œäº†å—ï¼Ÿæˆ‘ä»¬å€ŸåŠ© `@babel/plugin-transform-runtime` è¿™ä¸ªæ’ä»¶ï¼Œå®ƒå’Œ @babel/preset-env ä¸€æ ·éƒ½èƒ½æä¾› ES æ–°API çš„å«ç‰‡ï¼Œéƒ½å¯å®ç°æŒ‰éœ€åŠ è½½ï¼Œä½†å‰è€…ä¸ä¼šæ±¡æŸ“åŸå‹é“¾ã€‚

æ¯”å¦‚æˆ‘ä»¬å…ˆå°†webpackçš„æ¨¡å¼æ›´æ”¹ä¸º`development`ï¼Œåœ¨Headerç»„ä»¶ä¸­å¢åŠ ä¸€ç‚¹es6çš„é€»è¾‘ï¼Œæ¯”å¦‚ç®­å¤´å‡½æ•°

![image-20240615120722829](./assets/image-20240615120722829.png)

è¿™æ—¶å€™æˆ‘ä»¬æ‰“åŒ…çœ‹çœ‹ï¼Œæ‰“åŒ…ç»“æœä¸­ï¼Œç®­å¤´å‡½æ•°å¹¶æ²¡æœ‰è½¬æ¢

![image-20240615120729476](./assets/image-20240615120729476.png)

ç°åœ¨æˆ‘ä»¬é…ç½®ä¸‹es6+è½¬æ¢æˆes5

å¦å¤–ï¼Œbabel åœ¨ç¼–è¯‘æ¯ä¸€ä¸ªæ¨¡å—çš„æ—¶å€™åœ¨éœ€è¦çš„æ—¶å€™ä¼šæ’å…¥ä¸€äº›è¾…åŠ©å‡½æ•°ä¾‹å¦‚ \_extend ï¼Œæ¯ä¸€ä¸ªéœ€è¦çš„æ¨¡å—éƒ½ä¼šç”Ÿæˆè¿™ä¸ªè¾…åŠ©å‡½æ•°ï¼Œæ˜¾è€Œæ˜“è§è¿™ä¼šå¢åŠ ä»£ç çš„å†—ä½™ï¼Œ`@babel/plugin-transform-runtime` è¿™ä¸ªæ’ä»¶ä¼šå°†æ‰€æœ‰çš„è¾…åŠ©å‡½æ•°éƒ½ä» `@babel/runtime-corejs3` å¯¼å…¥ï¼ˆæˆ‘ä»¬ä¸‹é¢ä½¿ç”¨ corejs3ï¼‰ï¼Œä»è€Œå‡å°‘å†—ä½™æ€§ã€‚

    yarn add  @babel/preset-env@7.24.0 @babel/plugin-transform-runtime@7.24.0 -D
    
    yarn add @babel/runtime-corejs3@7.24.0 -S

> æ³¨æ„ï¼š @babel/runtime-corejs3 çš„å®‰è£…ä¸ºç”Ÿäº§ä¾èµ–ã€‚
> ä¿®æ”¹ .babelre å¦‚ä¸‹ï¼š

    {
      "presets": [
        [
          "@babel/preset-env",
          {
            // é˜²æ­¢babelå°†ä»»ä½•æ¨¡å—ç±»å‹éƒ½è½¬è¯‘æˆCommonJSç±»å‹ï¼Œå¯¼è‡´tree-shakingå¤±æ•ˆé—®é¢˜
            "modules": false
          }
        ],
        "@babel/preset-react",
        "@babel/preset-typescript"
      ],
      "plugins": [
        [
          "@babel/plugin-transform-runtime",
          {
            "corejs": {
              "version": 3,
              "proposals": true
            },
            "useESModules": true
          }
        ]
      ]
    }

å¯ä»¥çœ‹åˆ°ï¼Œç®­å¤´å‡½æ•°å·²ç»è¢«è½¬æ¢äº†ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å¦‚ä½•é…ç½®å³å¯ï¼Œååºæˆ‘ä»¬ä¼šä¸“é—¨å¯¹babelå†™ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»ä¸€ä¸‹ä½¿ç”¨ã€åŸç†ç­‰

![image-20240615120736915](./assets/image-20240615120736915.png)

# ğŸ‹ å†™åœ¨æœ€å

å¦‚æœä½ çœ‹åˆ°è¿™é‡Œäº†ï¼Œå¹¶ä¸”è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿç‚¹èµğŸ‘å’Œæ”¶è—â­æ”¯æŒä¸€ä¸‹ä½œè€…ğŸ™‡ğŸ™‡ğŸ™‡ï¼Œæ„Ÿè°¢ğŸºğŸºï¼å¦‚æœæ–‡ä¸­æœ‰ä»»ä½•ä¸å‡†ç¡®ä¹‹å¤„ï¼Œä¹Ÿæ¬¢è¿æ‚¨æŒ‡æ­£ï¼Œå…±åŒè¿›æ­¥ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼ŒæœŸå¾…æ‚¨çš„ç‚¹èµğŸ‘å’Œæ”¶è—â­ï¼

æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å…³æ³¨ä¸‹æˆ‘çš„å…¬ä¼—å·ObjectXå‰ç«¯å®éªŒå®¤

ğŸŒŸ å°‘èµ°å¼¯è·¯ | ObjectXå‰ç«¯å®éªŒå®¤ ğŸ› ï¸ã€Œç²¾é€‰èµ„æºï½œå®æˆ˜ç»éªŒï½œæŠ€æœ¯æ´è§ã€
